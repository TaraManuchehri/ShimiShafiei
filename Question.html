<!-- Ø§ÛŒÙ† Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø±Ø§ Ø¨Ù‡ Ø§Ù†ØªÙ‡Ø§ÛŒ ÙØ§ÛŒÙ„ HTML Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯ -->
<script>
// Ø¨Ø®Ø´ Ù…Ø¯ÛŒØ±ÛŒØª Ø³ÙˆØ§Ù„Ø§Øª Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù†
let studentQuestions = JSON.parse(localStorage.getItem('chemistryQuestions')) || [];

// ÙØ±Ù… Ø±ÙØ¹ Ø§Ø´Ú©Ø§Ù„
const questionForm = document.getElementById('question-form');
questionForm.addEventListener('submit', function(e) {
    e.preventDefault();
    
    const name = document.getElementById('name').value;
    const phone = document.getElementById('phone').value;
    const subject = document.getElementById('subject').value;
    const question = document.getElementById('question').value;
    
    if (!name || !phone || !subject || !question) {
        alert('Ù„Ø·ÙØ§ ØªÙ…Ø§Ù… ÙÛŒÙ„Ø¯Ù‡Ø§ Ø±Ø§ Ù¾Ø± Ú©Ù†ÛŒØ¯.');
        return;
    }
    
    // Ø°Ø®ÛŒØ±Ù‡ Ø³ÙˆØ§Ù„
    const newQuestion = {
        id: Date.now(),
        name: name,
        phone: phone,
        subject: subject,
        question: question,
        date: new Date().toLocaleString('fa-IR'),
        status: 'Ø¬Ø¯ÛŒØ¯',
        answer: ''
    };
    
    studentQuestions.push(newQuestion);
    localStorage.setItem('chemistryQuestions', JSON.stringify(studentQuestions));
    
    // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù… Ù…ÙˆÙÙ‚ÛŒØª
    alert(`Ø³ÙˆØ§Ù„ Ø´Ù…Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯!\n\nÚ©Ø¯ Ù¾ÛŒÚ¯ÛŒØ±ÛŒ: ${newQuestion.id}\n\nØ³ÙˆØ§Ù„ Ø´Ù…Ø§ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯ Ùˆ Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ Ù¾Ø§Ø³Ø® Ø¯Ø§Ø¯Ù‡ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯.`);
    
    // Ø±ÛŒØ³Øª ÙØ±Ù…
    questionForm.reset();
});

// Ø§ÛŒØ¬Ø§Ø¯ ØµÙØ­Ù‡ Ù…Ø¯ÛŒØ±ÛŒØª Ø³ÙˆØ§Ù„Ø§Øª (ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Ø´Ù…Ø§ Ù‚Ø§Ø¨Ù„ Ù…Ø´Ø§Ù‡Ø¯Ù‡)
function createAdminPanel() {
    // Ø§ÛŒØ¬Ø§Ø¯ Ø¯Ú©Ù…Û€ Ù…Ø®ÙÛŒ Ù…Ø¯ÛŒØ±ÛŒØª
    const adminBtn = document.createElement('button');
    adminBtn.innerHTML = 'ğŸ“‹ Ù…Ø¯ÛŒØ±ÛŒØª Ø³ÙˆØ§Ù„Ø§Øª';
    adminBtn.style.cssText = `
        position: fixed;
        bottom: 20px;
        left: 20px;
        background: var(--accent-purple);
        color: white;
        border: none;
        padding: 10px 15px;
        border-radius: 5px;
        cursor: pointer;
        z-index: 1000;
        font-family: 'Vazirmatn';
    `;
    adminBtn.onclick = showQuestionsPanel;
    document.body.appendChild(adminBtn);
}

// Ù†Ù…Ø§ÛŒØ´ Ù¾Ù†Ù„ Ø³ÙˆØ§Ù„Ø§Øª
function showQuestionsPanel() {
    const password = prompt('Ø¨Ø±Ø§ÛŒ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø³ÙˆØ§Ù„Ø§ØªØŒ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯:');
    // Ø±Ù…Ø² Ø³Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡ (Ø¯Ø± Ù†Ø³Ø®Ù‡ ÙˆØ§Ù‚Ø¹ÛŒ Ø¨Ø§ÛŒØ¯ Ù¾ÛŒÚ†ÛŒØ¯Ù‡â€ŒØªØ± Ø¨Ø§Ø´Ø¯)
    if (password !== 'chem123') {
        alert('Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª!');
        return;
    }
    
    studentQuestions = JSON.parse(localStorage.getItem('chemistryQuestions')) || [];
    
    if (studentQuestions.length === 0) {
        alert('Ù‡Ù†ÙˆØ² Ø³ÙˆØ§Ù„ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.');
        return;
    }
    
    let questionsHTML = '<h2>ğŸ“‹ Ù„ÛŒØ³Øª Ø³ÙˆØ§Ù„Ø§Øª Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù†</h2>';
    questionsHTML += `<p>ØªØ¹Ø¯Ø§Ø¯ Ø³ÙˆØ§Ù„Ø§Øª: ${studentQuestions.length}</p>`;
    questionsHTML += '<table style="width:100%; border-collapse:collapse; margin-top:20px;">';
    questionsHTML += `
        <tr style="background:var(--deep-blue);">
            <th style="padding:10px; border:1px solid var(--light-blue);">Ú©Ø¯</th>
            <th style="padding:10px; border:1px solid var(--light-blue);">Ù†Ø§Ù…</th>
            <th style="padding:10px; border:1px solid var(--light-blue);">Ø´Ù…Ø§Ø±Ù‡</th>
            <th style="padding:10px; border:1px solid var(--light-blue);">Ù…ÙˆØ¶ÙˆØ¹</th>
            <th style="padding:10px; border:1px solid var(--light-blue);">ØªØ§Ø±ÛŒØ®</th>
            <th style="padding:10px; border:1px solid var(--light-blue);">ÙˆØ¶Ø¹ÛŒØª</th>
            <th style="padding:10px; border:1px solid var(--light-blue);">Ø¹Ù…Ù„ÛŒØ§Øª</th>
        </tr>
    `;
    
    studentQuestions.forEach((q, index) => {
        questionsHTML += `
            <tr style="background:${index % 2 === 0 ? 'var(--light-blue)' : 'var(--deep-blue)'};">
                <td style="padding:10px; border:1px solid var(--light-blue);">${q.id}</td>
                <td style="padding:10px; border:1px solid var(--light-blue);">${q.name}</td>
                <td style="padding:10px; border:1px solid var(--light-blue);">${q.phone}</td>
                <td style="padding:10px; border:1px solid var(--light-blue);">${q.subject}</td>
                <td style="padding:10px; border:1px solid var(--light-blue);">${q.date}</td>
                <td style="padding:10px; border:1px solid var(--light-blue); color:${q.status === 'Ù¾Ø§Ø³Ø® Ø¯Ø§Ø¯Ù‡' ? 'var(--accent-green)' : 'var(--accent-orange)'};">${q.status}</td>
                <td style="padding:10px; border:1px solid var(--light-blue);">
                    <button onclick="viewQuestion(${q.id})" style="background:var(--accent-blue); color:white; border:none; padding:5px 10px; border-radius:3px; cursor:pointer; margin:2px;">Ù…Ø´Ø§Ù‡Ø¯Ù‡</button>
                    <button onclick="deleteQuestion(${q.id})" style="background:var(--accent-red); color:white; border:none; padding:5px 10px; border-radius:3px; cursor:pointer; margin:2px;">Ø­Ø°Ù</button>
                </td>
            </tr>
        `;
    });
    
    questionsHTML += '</table>';
    
    // Ù†Ù…Ø§ÛŒØ´ Ø¯Ø± Ù…Ø¯Ø§Ù„
    const modal = document.createElement('div');
    modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.9);
        z-index: 2000;
        display: flex;
        justify-content: center;
        align-items: center;
    `;
    
    const modalContent = document.createElement('div');
    modalContent.style.cssText = `
        background: var(--deep-blue);
        padding: 30px;
        border-radius: 10px;
        max-width: 90%;
        max-height: 90vh;
        overflow-y: auto;
        width: 1200px;
        color: var(--text-primary);
    `;
    modalContent.innerHTML = questionsHTML + `
        <div style="margin-top:20px; text-align:center;">
            <button onclick="exportQuestions()" style="background:var(--accent-green); color:white; border:none; padding:10px 20px; border-radius:5px; cursor:pointer; margin:5px;">ğŸ“¥ Ø®Ø±ÙˆØ¬ÛŒ Excel</button>
            <button onclick="closeModal()" style="background:var(--accent-red); color:white; border:none; padding:10px 20px; border-radius:5px; cursor:pointer; margin:5px;">Ø¨Ø³ØªÙ†</button>
        </div>
    `;
    
    modal.appendChild(modalContent);
    document.body.appendChild(modal);
    
    // Ø°Ø®ÛŒØ±Ù‡ Ø±ÙØ±Ù†Ø³ Ù…Ø¯Ø§Ù„ Ø¨Ø±Ø§ÛŒ Ø¨Ø³ØªÙ†
    window.currentModal = modal;
}

// Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø¬Ø²Ø¦ÛŒØ§Øª Ø³ÙˆØ§Ù„
function viewQuestion(id) {
    studentQuestions = JSON.parse(localStorage.getItem('chemistryQuestions')) || [];
    const question = studentQuestions.find(q => q.id === id);
    
    if (!question) return;
    
    let detailsHTML = `
        <h3>ğŸ“ Ø¬Ø²Ø¦ÛŒØ§Øª Ø³ÙˆØ§Ù„</h3>
        <div style="background:var(--light-blue); padding:20px; border-radius:10px; margin:15px 0;">
            <p><strong>Ú©Ø¯ Ø³ÙˆØ§Ù„:</strong> ${question.id}</p>
            <p><strong>Ù†Ø§Ù… Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²:</strong> ${question.name}</p>
            <p><strong>Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³:</strong> ${question.phone}</p>
            <p><strong>Ù…ÙˆØ¶ÙˆØ¹:</strong> ${question.subject}</p>
            <p><strong>ØªØ§Ø±ÛŒØ® Ø«Ø¨Øª:</strong> ${question.date}</p>
            <p><strong>ÙˆØ¶Ø¹ÛŒØª:</strong> ${question.status}</p>
        </div>
        <div style="background:var(--light-blue); padding:20px; border-radius:10px; margin:15px 0;">
            <h4>ğŸ“„ Ù…ØªÙ† Ø³ÙˆØ§Ù„:</h4>
            <p>${question.question}</p>
        </div>
    `;
    
    if (question.answer) {
        detailsHTML += `
            <div style="background:rgba(100, 255, 218, 0.1); padding:20px; border-radius:10px; margin:15px 0;">
                <h4>âœ… Ù¾Ø§Ø³Ø® Ø´Ù…Ø§:</h4>
                <p>${question.answer}</p>
            </div>
        `;
    } else {
        detailsHTML += `
            <div style="margin:15px 0;">
                <h4>ğŸ“ Ø«Ø¨Øª Ù¾Ø§Ø³Ø®:</h4>
                <textarea id="answerText" style="width:100%; height:150px; padding:10px; background:var(--light-blue); color:var(--text-primary); border:none; border-radius:5px; margin:10px 0;"></textarea>
                <button onclick="saveAnswer(${question.id})" style="background:var(--accent-green); color:white; border:none; padding:10px 20px; border-radius:5px; cursor:pointer;">ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡ Ù¾Ø§Ø³Ø®</button>
            </div>
        `;
    }
    
    const modal = document.createElement('div');
    modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.9);
        z-index: 3000;
        display: flex;
        justify-content: center;
        align-items: center;
    `;
    
    const modalContent = document.createElement('div');
    modalContent.style.cssText = `
        background: var(--deep-blue);
        padding: 30px;
        border-radius: 10px;
        max-width: 90%;
        max-height: 90vh;
        overflow-y: auto;
        width: 800px;
        color: var(--text-primary);
    `;
    modalContent.innerHTML = detailsHTML + `
        <div style="margin-top:20px; text-align:center;">
            <button onclick="closeModal()" style="background:var(--accent-red); color:white; border:none; padding:10px 20px; border-radius:5px; cursor:pointer;">Ø¨Ø³ØªÙ†</button>
        </div>
    `;
    
    modal.appendChild(modalContent);
    document.body.appendChild(modal);
    
    window.currentModal = modal;
}

// Ø°Ø®ÛŒØ±Ù‡ Ù¾Ø§Ø³Ø®
function saveAnswer(id) {
    const answerText = document.getElementById('answerText');
    if (!answerText || !answerText.value.trim()) {
        alert('Ù„Ø·ÙØ§ Ù…ØªÙ† Ù¾Ø§Ø³Ø® Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.');
        return;
    }
    
    studentQuestions = JSON.parse(localStorage.getItem('chemistryQuestions')) || [];
    const questionIndex = studentQuestions.findIndex(q => q.id === id);
    
    if (questionIndex !== -1) {
        studentQuestions[questionIndex].answer = answerText.value;
        studentQuestions[questionIndex].status = 'Ù¾Ø§Ø³Ø® Ø¯Ø§Ø¯Ù‡';
        studentQuestions[questionIndex].answerDate = new Date().toLocaleString('fa-IR');
        localStorage.setItem('chemistryQuestions', JSON.stringify(studentQuestions));
        
        alert('âœ… Ù¾Ø§Ø³Ø® Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯!');
        closeModal();
        showQuestionsPanel();
    }
}

// Ø­Ø°Ù Ø³ÙˆØ§Ù„
function deleteQuestion(id) {
    if (confirm('Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø§ÛŒÙ† Ø³ÙˆØ§Ù„ Ø±Ø§ Ø­Ø°Ù Ú©Ù†ÛŒØ¯ØŸ')) {
        studentQuestions = studentQuestions.filter(q => q.id !== id);
        localStorage.setItem('chemistryQuestions', JSON.stringify(studentQuestions));
        alert('Ø³ÙˆØ§Ù„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø­Ø°Ù Ø´Ø¯.');
        showQuestionsPanel();
    }
}

// Ø®Ø±ÙˆØ¬ÛŒ Excel
function exportQuestions() {
    studentQuestions = JSON.parse(localStorage.getItem('chemistryQuestions')) || [];
    
    if (studentQuestions.length === 0) {
        alert('Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ Ø®Ø±ÙˆØ¬ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯.');
        return;
    }
    
    // Ø³Ø§Ø®Øª CSV
    let csv = 'Ú©Ø¯,Ù†Ø§Ù…,Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³,Ù…ÙˆØ¶ÙˆØ¹,Ø³ÙˆØ§Ù„,ØªØ§Ø±ÛŒØ®,ÙˆØ¶Ø¹ÛŒØª\n';
    studentQuestions.forEach(q => {
        const safeQuestion = q.question.replace(/,/g, ';').replace(/\n/g, ' ');
        csv += `${q.id},${q.name},${q.phone},${q.subject},"${safeQuestion}",${q.date},${q.status}\n`;
    });
    
    // Ø§ÛŒØ¬Ø§Ø¯ ÙØ§ÛŒÙ„ Ùˆ Ø¯Ø§Ù†Ù„ÙˆØ¯
    const blob = new Blob(['\ufeff' + csv], { type: 'text/csv;charset=utf-8' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `chemistry_questions_${new Date().toISOString().split('T')[0]}.csv`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
    
    alert('ÙØ§ÛŒÙ„ Excel Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø´Ø¯.');
}

// Ø¨Ø³ØªÙ† Ù…Ø¯Ø§Ù„
function closeModal() {
    if (window.currentModal) {
        document.body.removeChild(window.currentModal);
        window.currentModal = null;
    }
}

// Ø§ÛŒØ¬Ø§Ø¯ Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ù‡Ù†Ú¯Ø§Ù… Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØµÙØ­Ù‡
document.addEventListener('DOMContentLoaded', createAdminPanel);
</script>
