<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مدرس شیمی کنکور | سیستم کامل آموزشی</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700&display=swap">
    <style>
        :root {
            --midnight-blue: #0a192f;
            --deep-blue: #112240;
            --light-blue: #233554;
            --accent-blue: #64ffda;
            --accent-purple: #9d4edd;
            --accent-red: #ff6b6b;
            --accent-green: #51cf66;
            --accent-yellow: #ffd43b;
            --accent-orange: #ff922b;
            --text-primary: #e6f1ff;
            --text-secondary: #a8b2d1;
            --text-muted: #8892b0;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Vazirmatn', sans-serif;
            background-color: var(--midnight-blue);
            color: var(--text-primary);
            line-height: 1.6;
        }

        .container {
            width: 90%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 15px;
        }

        /* نوار ناوبری */
        header {
            background-color: var(--deep-blue);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--accent-blue);
            display: flex;
            align-items: center;
        }

        .logo i {
            margin-left: 10px;
            font-size: 2rem;
        }

        .logo span {
            color: var(--accent-purple);
        }

        .nav-links {
            display: flex;
            list-style: none;
        }

        .nav-links li {
            margin-right: 15px;
        }

        .nav-links a {
            color: var(--text-primary);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            position: relative;
            padding: 5px 0;
            font-size: 0.85rem;
        }

        .nav-links a:hover {
            color: var(--accent-blue);
        }

        .mobile-menu-btn {
            display: none;
            font-size: 1.5rem;
            background: none;
            border: none;
            color: var(--text-primary);
            cursor: pointer;
        }

        /* صفحات */
        .page {
            display: none;
            padding-top: 100px;
            min-height: 100vh;
        }

        .page.active {
            display: block;
        }

        /* صفحه اصلی */
        .hero {
            padding: 150px 0 80px;
            background: linear-gradient(135deg, var(--midnight-blue) 0%, var(--deep-blue) 100%);
            text-align: center;
        }

        .teacher-profile {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 40px;
            margin-top: 40px;
            flex-wrap: wrap;
        }

        .teacher-photo {
            width: 250px;
            height: 250px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-purple) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 5rem;
            color: white;
            box-shadow: 0 10px 30px rgba(100, 255, 218, 0.3);
        }

        /* بخش‌های اصلی */
        .section-title {
            font-size: 2rem;
            color: var(--accent-blue);
            margin-bottom: 40px;
            text-align: center;
            position: relative;
        }

        .section-title::after {
            content: '';
            display: block;
            width: 70px;
            height: 3px;
            background-color: var(--accent-blue);
            margin: 10px auto;
        }

        /* سیستم ثبت نام/ورود */
        .auth-section {
            max-width: 500px;
            margin: 50px auto;
            background-color: var(--deep-blue);
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--light-blue);
        }

        .auth-tab {
            flex: 1;
            text-align: center;
            padding: 15px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            color: var(--text-secondary);
            border-bottom: 3px solid transparent;
        }

        .auth-tab.active {
            color: var(--accent-blue);
            border-bottom: 3px solid var(--accent-blue);
        }

        .auth-form {
            display: none;
        }

        .auth-form.active {
            display: block;
        }

        /* پنل کاربری */
        .user-panel {
            background-color: var(--deep-blue);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--light-blue);
        }

        .user-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-purple) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            color: white;
        }

        /* پخش‌کننده ویدیو */
        .video-player-container {
            background-color: var(--deep-blue);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .video-player {
            width: 100%;
            aspect-ratio: 16/9;
            background-color: #000;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .video-player video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .video-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
        }

        .video-playlist {
            margin-top: 30px;
        }

        .playlist-item {
            display: flex;
            align-items: center;
            padding: 15px;
            background-color: var(--light-blue);
            margin-bottom: 10px;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
        }

        .playlist-item:hover {
            background-color: rgba(100, 255, 218, 0.1);
        }

        .playlist-item.active {
            background-color: rgba(100, 255, 218, 0.2);
            border-right: 3px solid var(--accent-blue);
        }

        /* بخش آپلود ویدیو */
        .upload-section {
            background-color: var(--deep-blue);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .upload-area {
            border: 3px dashed var(--accent-blue);
            border-radius: 10px;
            padding: 60px 20px;
            text-align: center;
            margin: 20px 0;
            cursor: pointer;
            transition: var(--transition);
        }

        .upload-area:hover {
            background-color: rgba(100, 255, 218, 0.05);
        }

        /* کارت‌ها */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 50px;
        }

        .card {
            background-color: var(--deep-blue);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            transition: var(--transition);
        }

        .card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }

        .card-header {
            height: 180px;
            background-color: var(--light-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            color: var(--accent-blue);
        }

        .card-content {
            padding: 25px;
        }

        .card-content h3 {
            color: var(--accent-blue);
            margin-bottom: 15px;
            font-size: 1.4rem;
        }

        .card-content p {
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .btn {
            display: inline-block;
            background-color: var(--accent-purple);
            color: white;
            padding: 12px 25px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            border: none;
            cursor: pointer;
        }

        .btn:hover {
            background-color: var(--accent-blue);
            color: var(--deep-blue);
        }

        /* محاسبه جرم مولی تمام عناصر */
        .all-elements-calculator {
            background-color: var(--deep-blue);
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 40px;
        }

        .elements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
            margin-top: 30px;
            max-height: 400px;
            overflow-y: auto;
            padding: 15px;
        }

        .element-item {
            background-color: var(--light-blue);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: var(--transition);
            cursor: pointer;
        }

        .element-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(100, 255, 218, 0.2);
        }

        .element-symbol {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent-blue);
            margin-bottom: 5px;
        }

        /* جدول تناوبی */
        .full-periodic-table {
            background-color: var(--deep-blue);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            overflow-x: auto;
        }

        .table-container {
            display: grid;
            grid-template-columns: repeat(18, 1fr);
            gap: 4px;
            margin-bottom: 20px;
            min-width: 1200px;
        }

        .periodic-element {
            border-radius: 5px;
            padding: 12px 5px;
            text-align: center;
            font-size: 0.8rem;
            transition: var(--transition);
            cursor: pointer;
            min-height: 80px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .periodic-element:hover {
            transform: scale(1.08);
            box-shadow: 0 0 15px rgba(100, 255, 218, 0.7);
            z-index: 10;
        }

        .element-image {
            width: 30px;
            height: 30px;
            margin: 0 auto 5px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            color: var(--text-primary);
        }

        /* رنگ‌بندی گروه‌های جدول تناوبی */
        .alkali-metal { background-color: #ff6b6b; }
        .alkaline-earth { background-color: #ffa726; }
        .transition-metal { background-color: #42a5f5; }
        .basic-metal { background-color: #66bb6a; }
        .metalloid { background-color: #ab47bc; }
        .nonmetal { background-color: #5c6bc0; }
        .halogen { background-color: #ffca28; color: #000; }
        .noble-gas { background-color: #26c6da; }
        .lanthanide { background-color: #ff8a65; }
        .actinide { background-color: #ba68c8; }

        /* واکنش‌های مهم */
        .important-reactions {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
        }

        .reaction-card {
            background-color: var(--deep-blue);
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: var(--transition);
            border-top: 4px solid var(--accent-green);
        }

        .reaction-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        .reaction-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .reaction-equation {
            font-family: monospace;
            font-size: 1.8rem;
            color: var(--accent-yellow);
            background-color: rgba(255, 212, 59, 0.1);
            padding: 10px 15px;
            border-radius: 8px;
            text-align: center;
            margin: 15px 0;
        }

        /* رفع اشکال */
        .help-section {
            background-color: var(--deep-blue);
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 40px;
        }

        .help-form {
            max-width: 600px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            color: var(--accent-blue);
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 15px;
            background-color: var(--light-blue);
            border: none;
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-control:focus {
            outline: none;
            box-shadow: 0 0 0 2px var(--accent-blue);
        }

        textarea.form-control {
            min-height: 150px;
            resize: vertical;
        }

        .submit-btn {
            background-color: var(--accent-purple);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: var(--transition);
            display: block;
            width: 100%;
        }

        .submit-btn:hover {
            background-color: var(--accent-blue);
            color: var(--deep-blue);
        }

        .help-info {
            background-color: rgba(100, 255, 218, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
            border-right: 3px solid var(--accent-blue);
        }

        /* صفحه جزوات */
        .handouts-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 30px;
        }

        .handout-card {
            background-color: var(--deep-blue);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            transition: var(--transition);
        }

        .handout-header {
            height: 200px;
            background-color: var(--light-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 5rem;
            color: var(--accent-blue);
        }

        .handout-meta {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        /* صفحه نمونه سوالات */
        .questions-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 30px;
        }

        .question-card {
            background-color: var(--deep-blue);
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            transition: var(--transition);
            border-top: 4px solid var(--accent-green);
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        /* صفحه آزمون آنلاین */
        .quiz-container {
            background-color: var(--deep-blue);
            border-radius: 15px;
            padding: 40px;
            margin-bottom: 50px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .quiz-progress {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--light-blue);
        }

        .question-box {
            background-color: var(--light-blue);
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .options-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .option {
            background-color: var(--deep-blue);
            padding: 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid transparent;
        }

        .option:hover {
            background-color: rgba(100, 255, 218, 0.1);
            border-color: var(--accent-blue);
        }

        .option.selected {
            background-color: rgba(100, 255, 218, 0.2);
            border-color: var(--accent-blue);
        }

        .quiz-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        .result-box {
            display: none;
            background: linear-gradient(135deg, var(--deep-blue) 0%, var(--midnight-blue) 100%);
            padding: 40px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 50px;
            border: 2px solid var(--accent-blue);
        }

        /* صفحه ویدیوهای آموزشی */
        .videos-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 30px;
        }

        .video-card {
            background-color: var(--deep-blue);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            transition: var(--transition);
        }

        .video-placeholder {
            height: 220px;
            background-color: var(--light-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            color: var(--accent-red);
        }

        .video-meta {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        /* صفحه عکس کلاس‌ها */
        .gallery-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
        }

        .gallery-item {
            background-color: var(--deep-blue);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            transition: var(--transition);
        }

        .gallery-image {
            height: 250px;
            background-color: var(--light-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: var(--accent-yellow);
        }

        /* فوتر */
        footer {
            background-color: var(--deep-blue);
            padding: 50px 0 20px;
            border-top: 1px solid var(--light-blue);
            margin-top: 50px;
        }

        .social-links {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
        }

        .social-link {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--light-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 10px;
            color: var(--accent-blue);
            font-size: 1.3rem;
            transition: var(--transition);
            text-decoration: none;
        }

        .social-link:hover {
            background-color: var(--accent-blue);
            color: var(--deep-blue);
            transform: translateY(-5px);
        }

        .copyright {
            text-align: center;
            color: var(--text-muted);
            font-size: 0.9rem;
            padding-top: 20px;
            border-top: 1px solid rgba(136, 146, 176, 0.2);
        }

        /* مدال عنصر */
        .element-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: var(--deep-blue);
            width: 90%;
            max-width: 800px;
            border-radius: 15px;
            padding: 30px;
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }

        .close-modal {
            position: absolute;
            top: 15px;
            left: 15px;
            font-size: 2rem;
            color: var(--accent-red);
            cursor: pointer;
            background: none;
            border: none;
        }

        /* رسپانسیو */
        @media (max-width: 1200px) {
            .table-container {
                grid-template-columns: repeat(9, 1fr);
            }
        }

        @media (max-width: 992px) {
            .teacher-profile {
                flex-direction: column;
                text-align: center;
            }
            
            .card-grid,
            .handouts-container,
            .questions-container,
            .videos-container,
            .gallery-container {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .nav-links {
                position: fixed;
                top: 70px;
                right: -100%;
                flex-direction: column;
                background-color: var(--deep-blue);
                width: 100%;
                text-align: center;
                transition: 0.5s;
                box-shadow: 0 10px 27px rgba(0, 0, 0, 0.2);
                padding: 20px 0;
                border-top: 1px solid var(--light-blue);
            }

            .nav-links.active {
                right: 0;
            }

            .nav-links li {
                margin: 15px 0;
            }

            .mobile-menu-btn {
                display: block;
            }
            
            .table-container {
                grid-template-columns: repeat(6, 1fr);
            }
            
            .quiz-container,
            .result-box {
                padding: 20px;
            }
            
            .quiz-controls {
                flex-direction: column;
                gap: 15px;
            }
            
            .auth-section {
                padding: 20px;
            }
        }

        /* استایل‌های جدید برای امکانات اضافه شده */
        .admin-panel-btn {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: var(--accent-purple);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            z-index: 1000;
            font-family: 'Vazirmatn';
            font-size: 0.9rem;
            box-shadow: 0 4px 15px rgba(157, 78, 221, 0.3);
        }

        .admin-panel-btn:hover {
            background: var(--accent-blue);
            color: var(--midnight-blue);
        }

        .quick-action-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin: 5px;
            padding: 8px 15px;
            border-radius: 6px;
            font-size: 0.8rem;
        }

        .whatsapp-btn {
            background: #25D366;
            color: white;
        }

        .sms-btn {
            background: #2196F3;
            color: white;
        }

        .reaction-category {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            margin: 5px;
        }

        .oxidation { background: #FF5252; color: white; }
        .acid-base { background: #4CAF50; color: white; }
        .substitution { background: #FF9800; color: white; }
        .decomposition { background: #9C27B0; color: white; }
        .combination { background: #2196F3; color: white; }

        .precipitation-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .precipitation-table th,
        .precipitation-table td {
            border: 1px solid var(--light-blue);
            padding: 12px;
            text-align: center;
        }

        .precipitation-table th {
            background: var(--light-blue);
            color: var(--accent-blue);
        }

        .precipitation-table tr:nth-child(even) {
            background: rgba(255,255,255,0.05);
        }

        .color-badge {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 4px;
            vertical-align: middle;
            margin-left: 8px;
            border: 1px solid rgba(255,255,255,0.3);
        }

        .formula-box {
            background: var(--light-blue);
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border-right: 4px solid var(--accent-yellow);
        }

        .compound-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .compound-item {
            background: var(--light-blue);
            padding: 15px;
            border-radius: 8px;
            transition: var(--transition);
        }

        .compound-item:hover {
            transform: translateY(-3px);
            background: rgba(100, 255, 218, 0.1);
        }

        .test-questions {
            background: var(--light-blue);
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .question-item {
            margin: 15px 0;
            padding: 15px;
            background: var(--deep-blue);
            border-radius: 8px;
        }

        .solution {
            background: rgba(100, 255, 218, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            border-right: 3px solid var(--accent-blue);
        }

        .chapter-filter {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }

        .chapter-btn {
            background: var(--light-blue);
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            color: var(--text-primary);
            cursor: pointer;
            transition: var(--transition);
        }

        .chapter-btn.active {
            background: var(--accent-blue);
            color: var(--midnight-blue);
        }

        .chapter-btn:hover {
            background: var(--accent-purple);
            color: white;
        }

        .periodic-table-note {
            background: rgba(255, 193, 7, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-right: 3px solid var(--accent-yellow);
        }

        /* استایل‌های جدید برای امکانات اضافه شده */
        .user-dashboard {
            background: linear-gradient(135deg, var(--deep-blue) 0%, var(--midnight-blue) 100%);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--light-blue);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-card i {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: var(--accent-blue);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: var(--accent-green);
        }

        .stat-label {
            color: var(--text-secondary);
            margin-top: 5px;
        }

        .dashboard-features {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .feature-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--light-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin: 0 auto 10px;
            color: var(--accent-blue);
        }

        .mobile-optimized {
            width: 100%;
            max-width: 100%;
            overflow-x: hidden;
        }

        .site-features-list {
            background: var(--deep-blue);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: var(--light-blue);
            border-radius: 10px;
            transition: var(--transition);
        }

        .feature-item:hover {
            transform: translateY(-5px);
            background: rgba(100, 255, 218, 0.1);
        }

        .feature-item i {
            font-size: 1.8rem;
            color: var(--accent-blue);
            min-width: 40px;
        }

        .home-features {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }

        .home-feature {
            text-align: center;
            padding: 20px 10px;
            background: var(--deep-blue);
            border-radius: 10px;
            transition: var(--transition);
        }

        .home-feature:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(100, 255, 218, 0.1);
        }

        .home-feature i {
            font-size: 2.5rem;
            color: var(--accent-blue);
            margin-bottom: 10px;
        }

        .video-analysis-section {
            background: var(--deep-blue);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .analysis-card {
            background: var(--light-blue);
            padding: 20px;
            border-radius: 10px;
        }

        .analysis-card h4 {
            color: var(--accent-blue);
            margin-bottom: 15px;
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background: var(--accent-green);
            border-radius: 4px;
        }

        /* استایل‌های جدید برای صفحات اضافه شده */
        .science-tool {
            background: var(--deep-blue);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .tool-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .tool-input-group {
            margin: 20px 0;
        }

        .tool-result {
            background: rgba(100, 255, 218, 0.1);
            padding: 25px;
            border-radius: 10px;
            margin-top: 30px;
            border-right: 4px solid var(--accent-blue);
        }

        .element-selector {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }

        .element-btn {
            padding: 12px;
            background: var(--light-blue);
            border: none;
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
        }

        .element-btn:hover {
            background: var(--accent-blue);
            color: var(--midnight-blue);
            transform: translateY(-3px);
        }

        .element-btn.selected {
            background: var(--accent-purple);
            color: white;
        }

        .reaction-display {
            font-family: monospace;
            font-size: 2rem;
            text-align: center;
            padding: 30px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid var(--accent-yellow);
        }

        .electrode-info {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .electrode-card {
            background: var(--light-blue);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .anode { border-right: 4px solid var(--accent-red); }
        .cathode { border-right: 4px solid var(--accent-green); }

        .precipitation-color {
            width: 30px;
            height: 30px;
            border-radius: 5px;
            display: inline-block;
            margin-left: 10px;
            vertical-align: middle;
            border: 1px solid rgba(255,255,255,0.3);
        }

        .lewis-diagram {
            font-family: monospace;
            font-size: 1.5rem;
            text-align: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            margin: 15px 0;
            line-height: 2;
        }

        .naming-example {
            background: var(--light-blue);
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border-right: 3px solid var(--accent-purple);
        }

        .compound-result {
            background: rgba(255, 212, 59, 0.1);
            padding: 25px;
            border-radius: 10px;
            margin: 25px 0;
            border-right: 4px solid var(--accent-yellow);
            text-align: center;
        }

        .equation-input {
            width: 100%;
            padding: 15px;
            font-family: monospace;
            font-size: 1.2rem;
            background: var(--light-blue);
            border: none;
            border-radius: 8px;
            color: var(--text-primary);
            text-align: center;
        }

        .balanced-equation {
            font-family: monospace;
            font-size: 2rem;
            color: var(--accent-green);
            text-align: center;
            padding: 20px;
            margin: 20px 0;
        }

        .stoichiometry-inputs {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .calculation-steps {
            background: rgba(100, 255, 218, 0.05);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-right: 3px solid var(--accent-blue);
        }

        .step {
            margin: 10px 0;
            padding: 10px;
            background: rgba(255,255,255,0.05);
            border-radius: 5px;
        }

        .smart-quiz-levels {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .level-card {
            background: var(--light-blue);
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            transition: var(--transition);
            position: relative;
        }

        .level-card.locked {
            opacity: 0.6;
            filter: grayscale(0.5);
        }

        .level-badge {
            position: absolute;
            top: -10px;
            left: -10px;
            background: var(--accent-red);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .level-card.unlocked {
            border: 2px solid var(--accent-green);
        }

        .level-card.current {
            border: 2px solid var(--accent-blue);
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(100, 255, 218, 0.2);
        }
    </style>
</head>
<body>
    <!-- نوار ناوبری -->
    <header>
        <div class="container">
            <nav>
                <div class="logo">
                    <i class="fas fa-atom"></i>
                    شیمی‌<span>پژوه</span>
                </div>
                <ul class="nav-links">
                    <li><a href="#" onclick="showPage('home')">خانه</a></li>
                    <li><a href="#" onclick="showPage('auth')">ثبت نام / ورود</a></li>
                    <li><a href="#" onclick="showPage('dashboard')">پنل کاربری</a></li>
                    <li><a href="#" onclick="showPage('elements')">جدول تناوبی</a></li>
                    <li><a href="#" onclick="showPage('molar-mass')">جرم مولی</a></li>
                    <li><a href="#" onclick="showPage('reactions')">واکنش‌ها</a></li>
                    <li><a href="#" onclick="showPage('electrochemistry')">الکتروشیمی</a></li>
                    <li><a href="#" onclick="showPage('precipitations')">رسوبات</a></li>
                    <li><a href="#" onclick="showPage('lewis-structures')">ساختار لوویس</a></li>
                    <li><a href="#" onclick="showPage('naming-compounds')">نامگذاری</a></li>
                    <li><a href="#" onclick="showPage('compound-builder')">ترکیب‌ساز</a></li>
                    <li><a href="#" onclick="showPage('balance-equation')">موازنه</a></li>
                    <li><a href="#" onclick="showPage('stoichiometry-solver')">استوکیومتری</a></li>
                    <li><a href="#" onclick="showPage('smart-quiz')">آزمون هوشمند</a></li>
                    <li><a href="#" onclick="showPage('handouts')">جزوات</a></li>
                    <li><a href="#" onclick="showPage('questions')">نمونه سوالات</a></li>
                    <li><a href="#" onclick="showPage('videos')">ویدیوها</a></li>
                    <li><a href="#" onclick="showPage('experiment-videos')">آزمایش‌ها</a></li>
                    <li><a href="#" onclick="showPage('gallery')">عکس کلاس‌ها</a></li>
                    <li><a href="#" onclick="showPage('help')">رفع اشکال</a></li>
                    <li><a href="#" onclick="showPage('video-analysis')">تحلیل آزمون</a></li>
                </ul>
                <button class="mobile-menu-btn">
                    <i class="fas fa-bars"></i>
                </button>
            </nav>
        </div>
    </header>

    <!-- صفحه اصلی -->
    <section id="home" class="page active">
        <div class="hero">
            <div class="container">
                <h1 style="font-size: 3rem; color: var(--accent-blue); margin-bottom: 20px;">مدرس تخصصی شیمی کنکور</h1>
                <p style="font-size: 1.3rem; color: var(--text-secondary); max-width: 800px; margin: 0 auto 40px;">
                    با بیش از ۱۲ سال تجربه تدریس و موفقیت صدها دانش‌آموز در کنکور سراسری
                </p>
                
                <div class="teacher-profile">
                    <div class="teacher-photo">
                        <i class="fas fa-user-graduate"></i>
                    </div>
                    <div class="teacher-info" style="max-width: 600px; text-align: right;">
                        <h2 style="color: var(--accent-blue); margin-bottom: 20px; font-size: 2.2rem;">دکتر علی احمدی</h2>
                        <p style="color: var(--text-secondary); font-size: 1.1rem; margin-bottom: 15px;">دکترای شیمی آلی از دانشگاه تهران با رتبه برتر کنکور ۱۳۸۸</p>
                        <p style="color: var(--text-secondary); font-size: 1.1rem; margin-bottom: 15px;">مؤلف ۵ جلد کتاب کمک‌آموزشی شیمی کنکور</p>
                        <p style="color: var(--text-secondary); font-size: 1.1rem; margin-bottom: 15px;">مدرس دوره‌های آنلاین با بیش از ۳,۰۰۰ دانش‌آموز</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="container">
            <!-- آیکون تمام ویژگی‌های سایت در صفحه اصلی -->
            <h2 class="section-title">تمام امکانات سایت</h2>
            <div class="home-features">
                <div class="home-feature" onclick="showPage('dashboard')">
                    <i class="fas fa-user-circle"></i>
                    <p>پنل کاربری</p>
                </div>
                <div class="home-feature" onclick="showPage('elements')">
                    <i class="fas fa-table"></i>
                    <p>جدول تناوبی</p>
                </div>
                <div class="home-feature" onclick="showPage('molar-mass')">
                    <i class="fas fa-calculator"></i>
                    <p>محاسبه جرم مولی</p>
                </div>
                <div class="home-feature" onclick="showPage('reactions')">
                    <i class="fas fa-vial"></i>
                    <p>واکنش‌های مهم</p>
                </div>
                <div class="home-feature" onclick="showPage('electrochemistry')">
                    <i class="fas fa-bolt"></i>
                    <p>الکتروشیمی</p>
                </div>
                <div class="home-feature" onclick="showPage('precipitations')">
                    <i class="fas fa-filter"></i>
                    <p>رسوبات</p>
                </div>
                <div class="home-feature" onclick="showPage('lewis-structures')">
                    <i class="fas fa-project-diagram"></i>
                    <p>ساختار لوویس</p>
                </div>
                <div class="home-feature" onclick="showPage('naming-compounds')">
                    <i class="fas fa-signature"></i>
                    <p>نامگذاری</p>
                </div>
                <div class="home-feature" onclick="showPage('compound-builder')">
                    <i class="fas fa-atom"></i>
                    <p>ترکیب‌ساز</p>
                </div>
                <div class="home-feature" onclick="showPage('balance-equation')">
                    <i class="fas fa-balance-scale"></i>
                    <p>موازنه</p>
                </div>
                <div class="home-feature" onclick="showPage('stoichiometry-solver')">
                    <i class="fas fa-calculator"></i>
                    <p>استوکیومتری</p>
                </div>
                <div class="home-feature" onclick="showPage('smart-quiz')">
                    <i class="fas fa-graduation-cap"></i>
                    <p>آزمون هوشمند</p>
                </div>
                <div class="home-feature" onclick="showPage('handouts')">
                    <i class="fas fa-book"></i>
                    <p>جزوات</p>
                </div>
                <div class="home-feature" onclick="showPage('questions')">
                    <i class="fas fa-question-circle"></i>
                    <p>نمونه سوالات</p>
                </div>
                <div class="home-feature" onclick="showPage('videos')">
                    <i class="fas fa-video"></i>
                    <p>ویدیوهای آموزشی</p>
                </div>
                <div class="home-feature" onclick="showPage('experiment-videos')">
                    <i class="fas fa-flask"></i>
                    <p>آزمایش‌ها</p>
                </div>
                <div class="home-feature" onclick="showPage('gallery')">
                    <i class="fas fa-images"></i>
                    <p>عکس کلاس‌ها</p>
                </div>
                <div class="home-feature" onclick="showPage('help')">
                    <i class="fas fa-question"></i>
                    <p>رفع اشکال</p>
                </div>
                <div class="home-feature" onclick="showPage('video-analysis')">
                    <i class="fas fa-chart-line"></i>
                    <p>تحلیل آزمون</p>
                </div>
                <div class="home-feature" onclick="showPage('auth')">
                    <i class="fas fa-sign-in-alt"></i>
                    <p>ثبت نام/ورود</p>
                </div>
            </div>

            <!-- کارت‌های اصلی سایت -->
            <h2 class="section-title">خدمات آموزشی</h2>
            <div class="card-grid">
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-user-plus"></i>
                    </div>
                    <div class="card-content">
                        <h3>ثبت نام در سایت</h3>
                        <p>با ثبت نام در سایت به تمام محتوای آموزشی دسترسی کامل داشته باشید</p>
                        <a href="#" onclick="showPage('auth')" class="btn">ثبت نام / ورود</a>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-bolt"></i>
                    </div>
                    <div class="card-content">
                        <h3>الکتروشیمی تعاملی</h3>
                        <p>انتخاب عناصر و مشاهده واکنش الکتروشیمیایی</p>
                        <a href="#" onclick="showPage('electrochemistry')" class="btn">مشاهده</a>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-table"></i>
                    </div>
                    <div class="card-content">
                        <h3>جدول تناوبی کامل</h3>
                        <p>جدول تناوبی عناصر ۱ تا ۱۱۸ با اطلاعات کامل هر عنصر</p>
                        <a href="#" onclick="showPage('elements')" class="btn">مشاهده جدول</a>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-balance-scale"></i>
                    </div>
                    <div class="card-content">
                        <h3>موازنه واکنش‌ها</h3>
                        <p>موازنه خودکار واکنش‌های شیمیایی</p>
                        <a href="#" onclick="showPage('balance-equation')" class="btn">موازنه واکنش</a>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-filter"></i>
                    </div>
                    <div class="card-content">
                        <h3>رسوبات شیمیایی</h3>
                        <p>لیست کامل رسوبات با رنگ‌های مختلف</p>
                        <a href="#" onclick="showPage('precipitations')" class="btn">مشاهده رسوبات</a>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <div class="card-content">
                        <h3>آزمون هوشمند</h3>
                        <p>آزمون‌های سطح‌بندی شده بر اساس امتیاز</p>
                        <a href="#" onclick="showPage('smart-quiz')" class="btn">شرکت در آزمون</a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- صفحه پنل کاربری -->
    <section id="dashboard" class="page">
        <div class="container">
            <h2 class="section-title">پنل کاربری دانش‌آموز</h2>
            <div class="user-dashboard">
                <div class="user-info">
                    <div class="user-avatar">
                        <i class="fas fa-user-graduate"></i>
                    </div>
                    <div>
                        <h2 id="dashboard-name" style="color: var(--accent-blue);">دانش‌آموز عزیز</h2>
                        <p id="dashboard-grade" style="color: var(--text-secondary);">لطفاً وارد حساب کاربری خود شوید</p>
                        <p id="dashboard-date" style="color: var(--text-muted); font-size: 0.9rem;">
                            <i class="fas fa-calendar"></i> آخرین بازدید: -
                        </p>
                    </div>
                </div>
                
                <div class="dashboard-stats">
                    <div class="stat-card">
                        <i class="fas fa-play-circle"></i>
                        <div class="stat-number" id="stat-videos">0</div>
                        <div class="stat-label">ویدیوهای مشاهده شده</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-graduation-cap"></i>
                        <div class="stat-number" id="stat-quizzes">0</div>
                        <div class="stat-label">آزمون‌های انجام شده</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-chart-line"></i>
                        <div class="stat-number" id="stat-score">0</div>
                        <div class="stat-label">امتیاز کل</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-percentage"></i>
                        <div class="stat-number" id="stat-percentage">0%</div>
                        <div class="stat-label">میانگین نمرات</div>
                    </div>
                </div>
                
                <h3 style="color: var(--accent-blue); margin: 30px 0 20px;">دسترسی سریع</h3>
                <div class="dashboard-features">
                    <div onclick="showPage('electrochemistry')">
                        <div class="feature-icon">
                            <i class="fas fa-bolt"></i>
                        </div>
                        <p style="text-align: center; margin-top: 5px;">الکتروشیمی</p>
                    </div>
                    <div onclick="showPage('smart-quiz')">
                        <div class="feature-icon">
                            <i class="fas fa-graduation-cap"></i>
                        </div>
                        <p style="text-align: center; margin-top: 5px;">آزمون هوشمند</p>
                    </div>
                    <div onclick="showPage('balance-equation')">
                        <div class="feature-icon">
                            <i class="fas fa-balance-scale"></i>
                        </div>
                        <p style="text-align: center; margin-top: 5px;">موازنه</p>
                    </div>
                    <div onclick="showPage('stoichiometry-solver')">
                        <div class="feature-icon">
                            <i class="fas fa-calculator"></i>
                        </div>
                        <p style="text-align: center; margin-top: 5px;">استوکیومتری</p>
                    </div>
                    <div onclick="showPage('compound-builder')">
                        <div class="feature-icon">
                            <i class="fas fa-atom"></i>
                        </div>
                        <p style="text-align: center; margin-top: 5px;">ترکیب‌ساز</p>
                    </div>
                    <div onclick="showPage('help')">
                        <div class="feature-icon">
                            <i class="fas fa-question"></i>
                        </div>
                        <p style="text-align: center; margin-top: 5px;">رفع اشکال</p>
                    </div>
                </div>
                
                <div style="margin-top: 30px; text-align: center;">
                    <button class="btn" onclick="showPage('auth')" id="dashboard-login-btn">
                        <i class="fas fa-sign-in-alt"></i> ورود به حساب کاربری
                    </button>
                    <button class="btn" onclick="logout()" id="dashboard-logout-btn" style="display: none; margin-right: 15px;">
                        <i class="fas fa-sign-out-alt"></i> خروج از حساب
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- صفحه ثبت نام/ورود -->
    <section id="auth" class="page">
        <div class="container">
            <h2 class="section-title">ورود به حساب کاربری</h2>
            
            <div class="auth-section">
                <div class="auth-tabs">
                    <div class="auth-tab active" onclick="showAuthForm('login')">ورود</div>
                    <div class="auth-tab" onclick="showAuthForm('register')">ثبت نام</div>
                </div>
                
                <!-- فرم ورود -->
                <div id="login-form" class="auth-form active">
                    <form id="loginForm">
                        <div class="form-group">
                            <label for="login-username">نام کاربری:</label>
                            <input type="text" id="login-username" class="form-control" placeholder="نام کاربری خود را وارد کنید" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="login-password">رمز عبور:</label>
                            <input type="password" id="login-password" class="form-control" placeholder="رمز عبور" required>
                        </div>
                        
                        <button type="submit" class="submit-btn">
                            <i class="fas fa-sign-in-alt"></i> ورود به حساب
                        </button>
                    </form>
                </div>
                
                <!-- فرم ثبت نام -->
                <div id="register-form" class="auth-form">
                    <form id="registerForm">
                        <div class="form-group">
                            <label for="register-username">نام کاربری:</label>
                            <input type="text" id="register-username" class="form-control" placeholder="نام کاربری دلخواه" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="register-phone">شماره موبایل:</label>
                            <input type="tel" id="register-phone" class="form-control" placeholder="۰۹۱۲XXXXXXX" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="register-password">رمز عبور:</label>
                            <input type="password" id="register-password" class="form-control" placeholder="حداقل ۸ کاراکتر" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="register-grade">پایه تحصیلی:</label>
                            <select id="register-grade" class="form-control" required>
                                <option value="">انتخاب کنید</option>
                                <option value="10">دهم</option>
                                <option value="11">یازدهم</option>
                                <option value="12">دوازدهم</option>
                                <option value="13">فارغ‌التحصیل</option>
                            </select>
                        </div>
                        
                        <button type="submit" class="submit-btn">
                            <i class="fas fa-user-plus"></i> ایجاد حساب کاربری
                        </button>
                    </form>
                </div>
                
                <div id="auth-message" style="margin-top: 20px; text-align: center;"></div>
            </div>
        </div>
    </section>

    <!-- صفحه الکتروشیمی -->
    <section id="electrochemistry" class="page">
        <div class="container">
            <h2 class="section-title">الکتروشیمی تعاملی</h2>
            
            <div class="science-tool">
                <h3 style="color: var(--accent-blue); text-align: center; margin-bottom: 30px;">
                    انتخاب دو عنصر برای مشاهده واکنش الکتروشیمیایی
                </h3>
                
                <div class="element-selector">
                    <div id="element-selection" style="grid-column: 1 / -1; text-align: center; margin-bottom: 20px;">
                        <p style="color: var(--text-secondary);">عنصر اول (آند) و عنصر دوم (کاتد) را انتخاب کنید:</p>
                    </div>
                </div>
                
                <div class="electrode-info">
                    <div class="electrode-card anode">
                        <h4 style="color: var(--accent-red); margin-bottom: 15px;">
                            <i class="fas fa-arrow-up"></i> آند (اکسایش)
                        </h4>
                        <div id="anode-element" style="font-size: 2rem; font-weight: bold; margin-bottom: 10px;">--</div>
                        <div id="anode-reaction" style="color: var(--text-secondary); font-size: 0.9rem;">نیم‌واکنش</div>
                    </div>
                    
                    <div class="electrode-card cathode">
                        <h4 style="color: var(--accent-green); margin-bottom: 15px;">
                            <i class="fas fa-arrow-down"></i> کاتد (کاهش)
                        </h4>
                        <div id="cathode-element" style="font-size: 2rem; font-weight: bold; margin-bottom: 10px;">--</div>
                        <div id="cathode-reaction" style="color: var(--text-secondary); font-size: 0.9rem;">نیم‌واکنش</div>
                    </div>
                </div>
                
                <div class="reaction-display">
                    <div id="full-reaction" style="margin: 20px 0;">
                        <p style="color: var(--text-muted);">واکنش کامل:</p>
                        <div id="reaction-equation" style="font-size: 2.5rem; font-weight: bold; color: var(--accent-yellow);">
                            -- واکنشی انتخاب نشده --
                        </div>
                    </div>
                </div>
                
                <div class="tool-result" id="electrochemistry-result" style="display: none;">
                    <h4 style="color: var(--accent-blue); margin-bottom: 15px;">📊 اطلاعات واکنش</h4>
                    <div id="reaction-info"></div>
                    <div id="voltage-info" style="margin-top: 15px;"></div>
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn" onclick="loadElectrochemistryElements()">
                        <i class="fas fa-redo"></i> بارگذاری عناصر
                    </button>
                    <button class="btn" onclick="clearElectrochemistrySelection()" style="background-color: var(--accent-red); margin-right: 15px;">
                        <i class="fas fa-times"></i> پاک کردن انتخاب
                    </button>
                </div>
            </div>
            
            <div class="precipitation-table" style="margin-top: 50px;">
                <h3 style="color: var(--accent-blue); margin-bottom: 20px; text-align: center;">واکنش‌های الکتروشیمی مهم</h3>
                <table>
                    <thead>
                        <tr>
                            <th>ردیف</th>
                            <th>سیستم الکتروشیمی</th>
                            <th>واکنش کامل</th>
                            <th>ولتاژ استاندارد (V)</th>
                            <th>کاربرد</th>
                        </tr>
                    </thead>
                    <tbody id="electrochemistry-reactions-table">
                        <!-- با جاوااسکریپت پر می‌شود -->
                    </tbody>
                </table>
            </div>
        </div>
    </section>

    <!-- صفحه رسوبات -->
    <section id="precipitations" class="page">
        <div class="container">
            <h2 class="section-title">رسوبات شیمیایی</h2>
            
            <div class="science-tool">
                <h3 style="color: var(--accent-blue); text-align: center; margin-bottom: 30px;">
                    لیست کامل رسوبات شیمیایی با رنگ‌های مختلف
                </h3>
                
                <div class="precipitation-table">
                    <table>
                        <thead>
                            <tr>
                                <th>نام رسوب</th>
                                <th>فرمول شیمیایی</th>
                                <th>رنگ رسوب</th>
                                <th>حلالیت در آب</th>
                                <th>یون‌های تشکیل‌دهنده</th>
                                <th>شرایط تشکیل</th>
                            </tr>
                        </thead>
                        <tbody id="precipitations-table">
                            <!-- با جاوااسکریپت پر می‌شود -->
                        </tbody>
                    </table>
                </div>
                
                <div class="tool-result" style="margin-top: 40px;">
                    <h4 style="color: var(--accent-blue); margin-bottom: 15px;">🎨 راهنمای رنگ رسوبات</h4>
                    <div class="element-selector">
                        <div style="display: flex; align-items: center; padding: 10px; background: var(--light-blue); border-radius: 8px;">
                            <div class="precipitation-color" style="background-color: #ffffff;"></div>
                            <span style="margin-right: 15px;">سفید</span>
                        </div>
                        <div style="display: flex; align-items: center; padding: 10px; background: var(--light-blue); border-radius: 8px;">
                            <div class="precipitation-color" style="background-color: #ffeb3b;"></div>
                            <span style="margin-right: 15px;">زرد</span>
                        </div>
                        <div style="display: flex; align-items: center; padding: 10px; background: var(--light-blue); border-radius: 8px;">
                            <div class="precipitation-color" style="background-color: #ff9800;"></div>
                            <span style="margin-right: 15px;">نارنجی</span>
                        </div>
                        <div style="display: flex; align-items: center; padding: 10px; background: var(--light-blue); border-radius: 8px;">
                            <div class="precipitation-color" style="background-color: #f44336;"></div>
                            <span style="margin-right: 15px;">قرمز</span>
                        </div>
                        <div style="display: flex; align-items: center; padding: 10px; background: var(--light-blue); border-radius: 8px;">
                            <div class="precipitation-color" style="background-color: #2196f3;"></div>
                            <span style="margin-right: 15px;">آبی</span>
                        </div>
                        <div style="display: flex; align-items: center; padding: 10px; background: var(--light-blue); border-radius: 8px;">
                            <div class="precipitation-color" style="background-color: #4caf50;"></div>
                            <span style="margin-right: 15px;">سبز</span>
                        </div>
                        <div style="display: flex; align-items: center; padding: 10px; background: var(--light-blue); border-radius: 8px;">
                            <div class="precipitation-color" style="background-color: #9c27b0;"></div>
                            <span style="margin-right: 15px;">بنفش</span>
                        </div>
                        <div style="display: flex; align-items: center; padding: 10px; background: var(--light-blue); border-radius: 8px;">
                            <div class="precipitation-color" style="background-color: #795548;"></div>
                            <span style="margin-right: 15px;">قهوه‌ای</span>
                        </div>
                        <div style="display: flex; align-items: center; padding: 10px; background: var(--light-blue); border-radius: 8px;">
                            <div class="precipitation-color" style="background-color: #000000;"></div>
                            <span style="margin-right: 15px;">سیاه</span>
                        </div>
                    </div>
                </div>
                
                <div class="formula-box" style="margin-top: 30px;">
                    <h4 style="color: var(--accent-yellow); margin-bottom: 15px;">📌 نکات مهم کنکوری درباره رسوبات:</h4>
                    <ul style="color: var(--text-primary); padding-right: 20px;">
                        <li>همه ترکیبات سدیم، پتاسیم و آمونیوم در آب محلول هستند (رسوب نمی‌دهند)</li>
                        <li>نیترات‌ها، کلرات‌ها و استات‌ها در آب محلول هستند</li>
                        <li>کلریدها محلول هستند به جز کلریدهای نقره، جیوه(I) و سرب(II)</li>
                        <li>سولفات‌ها محلول هستند به جز سولفات‌های باریم، سرب و کلسیم</li>
                        <li>سولفیدها نامحلول هستند به جز سولفیدهای گروه ۱ و ۲ و آمونیوم</li>
                        <li>کربنات‌ها، فسفات‌ها و کرومات‌ها نامحلول هستند (به جز گروه ۱ و آمونیوم)</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>
</body>
</html>
    <!-- صفحه ساختار لوویس -->
    <section id="lewis-structures" class="page">
        <div class="container">
            <h2 class="section-title">ساختارهای لوویس</h2>
            
            <div class="science-tool">
                <h3 style="color: var(--accent-blue); text-align: center; margin-bottom: 30px;">
                    ساختار لوویس ترکیبات یونی و مولکولی
                </h3>
                
                <div class="chapter-filter" id="lewis-filters">
                    <button class="chapter-btn active" onclick="filterLewisStructures('all')">همه</button>
                    <button class="chapter-btn" onclick="filterLewisStructures('ionic')">ترکیبات یونی</button>
                    <button class="chapter-btn" onclick="filterLewisStructures('molecular')">ترکیبات مولکولی</button>
                    <button class="chapter-btn" onclick="filterLewisStructures('acid')">اسیدها</button>
                    <button class="chapter-btn" onclick="filterLewisStructures('organic')">ترکیبات آلی</button>
                </div>
                
                <div class="tool-grid" id="lewis-structures-grid">
                    <!-- با جاوااسکریپت پر می‌شود -->
                </div>
                
                <div class="formula-box" style="margin-top: 40px;">
                    <h4 style="color: var(--accent-yellow); margin-bottom: 15px;">📝 قواعد ترسیم ساختار لوویس:</h4>
                    <ol style="color: var(--text-primary); padding-right: 20px;">
                        <li>تعداد کل الکترون‌های والانس همه اتم‌ها را حساب کنید</li>
                        <li>اتم مرکزی را انتخاب کنید (کم‌ترین الکترونگاتیوی)</li>
                        <li>اتم‌ها را با پیوندهای یگانه به هم وصل کنید</li>
                        <li>الکترون‌های باقی‌مانده را به صورت جفت الکترون ناپیوندی توزیع کنید</li>
                        <li>آرایش اکتت (۸ الکترون) برای عناصر دوره دوم</li>
                        <li>محاسبه بار فرمال: بار فرمال = تعداد الکترون‌های والانس - تعداد الکترون‌های ناپیوندی - نصف تعداد الکترون‌های پیوندی</li>
                        <li>ساختاری انتخاب کنید که بار فرمال نزدیک‌تر به صفر داشته باشد</li>
                    </ol>
                </div>
            </div>
        </div>
    </section>

    <!-- صفحه نامگذاری ترکیبات -->
    <section id="naming-compounds" class="page">
        <div class="container">
            <h2 class="section-title">نامگذاری ترکیبات یونی و مولکولی</h2>
            
            <div class="science-tool">
                <div class="chapter-filter">
                    <button class="chapter-btn active" onclick="showNamingRules('ionic')">ترکیبات یونی</button>
                    <button class="chapter-btn" onclick="showNamingRules('molecular')">ترکیبات مولکولی</button>
                    <button class="chapter-btn" onclick="showNamingRules('acid')">اسیدها</button>
                    <button class="chapter-btn" onclick="showNamingRules('practice')">تمرین</button>
                </div>
                
                <div id="naming-content">
                    <div class="naming-rules" id="ionic-rules">
                        <h3 style="color: var(--accent-blue); margin-bottom: 25px;">قواعد نامگذاری ترکیبات یونی</h3>
                        
                        <div class="naming-example">
                            <h4 style="color: var(--accent-green); margin-bottom: 10px;">۱. ترکیبات یونی ساده</h4>
                            <p style="color: var(--text-primary);">نام کاتیون + نام آنیون + "ید"</p>
                            <p style="color: var(--text-secondary); font-family: monospace; margin-top: 10px;">
                                مثال: NaCl → سدیم کلرید<br>
                                مثال: CaO → کلسیم اکسید<br>
                                مثال: Al₂O₃ → آلومینیوم اکسید
                            </p>
                        </div>
                        
                        <div class="naming-example">
                            <h4 style="color: var(--accent-green); margin-bottom: 10px;">۲. کاتیون‌های با چند عدد اکسایش</h4>
                            <p style="color: var(--text-primary);">نام کاتیون + (عدد اکسایش به صورت رومی) + نام آنیون + "ید"</p>
                            <p style="color: var(--text-secondary); font-family: monospace; margin-top: 10px;">
                                مثال: FeCl₂ → آهن(II) کلرید<br>
                                مثال: FeCl₃ → آهن(III) کلرید<br>
                                مثال: CuO → مس(II) اکسید<br>
                                مثال: Cu₂O → مس(I) اکسید
                            </p>
                        </div>
                        
                        <div class="naming-example">
                            <h4 style="color: var(--accent-green); margin-bottom: 10px;">۳. آنیون‌های چنداتمی</h4>
                            <p style="color: var(--text-primary);">نام کاتیون + نام آنیون چنداتمی</p>
                            <p style="color: var(--text-secondary); font-family: monospace; margin-top: 10px;">
                                مثال: NaNO₃ → سدیم نیترات<br>
                                مثال: CaCO₃ → کلسیم کربنات<br>
                                مثال: KMnO₄ → پتاسیم پرمنگنات<br>
                                مثال: Na₂SO₄ → سدیم سولفات
                            </p>
                        </div>
                    </div>
                </div>
                
                <div id="practice-section" style="display: none; margin-top: 30px;">
                    <h3 style="color: var(--accent-blue); margin-bottom: 25px; text-align: center;">تمرین نامگذاری</h3>
                    <div id="practice-questions">
                        <!-- با جاوااسکریپت پر می‌شود -->
                    </div>
                    <div style="text-align: center; margin-top: 30px;">
                        <button class="btn" onclick="generatePracticeQuestions()">
                            <i class="fas fa-redo"></i> تولید سوالات جدید
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- صفحه ترکیب‌ساز -->
    <section id="compound-builder" class="page">
        <div class="container">
            <h2 class="section-title">ترکیب‌ساز تعاملی</h2>
            
            <div class="science-tool">
                <h3 style="color: var(--accent-blue); text-align: center; margin-bottom: 30px;">
                    انتخاب دو عنصر برای تشکیل ترکیب شیمیایی
                </h3>
                
                <div class="element-selector" id="compound-elements">
                    <!-- با جاوااسکریپت پر می‌شود -->
                </div>
                
                <div style="text-align: center; margin: 30px 0;">
                    <div style="display: inline-flex; align-items: center; gap: 20px; padding: 20px; background: var(--light-blue); border-radius: 10px;">
                        <div id="selected-element1" style="font-size: 2rem; font-weight: bold; color: var(--accent-red); min-width: 100px;">--</div>
                        <div style="font-size: 1.5rem; color: var(--accent-blue);">+</div>
                        <div id="selected-element2" style="font-size: 2rem; font-weight: bold; color: var(--accent-green); min-width: 100px;">--</div>
                        <div style="font-size: 1.5rem; color: var(--accent-blue);">→</div>
                        <div id="compound-result" style="font-size: 2rem; font-weight: bold; color: var(--accent-yellow); min-width: 150px;">--</div>
                    </div>
                </div>
                
                <div class="compound-result" id="compound-details" style="display: none;">
                    <h4 style="color: var(--accent-blue); margin-bottom: 15px;">📋 اطلاعات ترکیب</h4>
                    <div id="compound-info"></div>
                    <div id="compound-properties" style="margin-top: 15px;"></div>
                    <div id="compound-uses" style="margin-top: 15px;"></div>
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn" onclick="calculateCompound()" id="calculate-btn" disabled>
                        <i class="fas fa-calculator"></i> محاسبه ترکیب
                    </button>
                    <button class="btn" onclick="clearCompoundSelection()" style="background-color: var(--accent-red); margin-right: 15px;">
                        <i class="fas fa-times"></i> پاک کردن انتخاب
                    </button>
                </div>
                
                <div class="formula-box" style="margin-top: 40px;">
                    <h4 style="color: var(--accent-yellow); margin-bottom: 15px;">📚 ترکیب‌های مهم شیمیایی:</h4>
                    <div class="compound-grid" id="important-compounds">
                        <!-- با جاوااسکریپت پر می‌شود -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- صفحه موازنه واکنش -->
    <section id="balance-equation" class="page">
        <div class="container">
            <h2 class="section-title">موازنه واکنش‌های شیمیایی</h2>
            
            <div class="science-tool">
                <h3 style="color: var(--accent-blue); text-align: center; margin-bottom: 30px;">
                    وارد کردن واکنش شیمیایی برای موازنه خودکار
                </h3>
                
                <div class="tool-input-group">
                    <label style="color: var(--accent-blue); display: block; margin-bottom: 15px; font-size: 1.1rem;">
                        <i class="fas fa-pen"></i> واکنش شیمیایی را وارد کنید:
                    </label>
                    <input type="text" id="equation-input" class="equation-input" 
                           placeholder="مثال: H2 + O2 → H2O یا CH4 + O2 → CO2 + H2O"
                           onkeypress="if(event.key === 'Enter') balanceEquation()">
                    <p style="color: var(--text-muted); font-size: 0.9rem; margin-top: 10px;">
                        نکته: از علامت + بین مواد واکنش‌دهنده و محصولات استفاده کنید. از → برای جدا کردن واکنش‌دهنده‌ها و محصولات استفاده کنید.
                    </p>
                </div>
                
                <div style="text-align: center; margin: 30px 0;">
                    <button class="btn" onclick="balanceEquation()" style="padding: 15px 40px; font-size: 1.2rem;">
                        <i class="fas fa-balance-scale"></i> موازنه واکنش
                    </button>
                </div>
                
                <div class="balanced-equation" id="balanced-result" style="display: none;">
                    <div style="color: var(--text-secondary); margin-bottom: 10px;">واکنش موازنه شده:</div>
                    <div id="balanced-equation"></div>
                </div>
                
                <div class="calculation-steps" id="balance-steps" style="display: none;">
                    <h4 style="color: var(--accent-blue); margin-bottom: 15px;">📝 مراحل موازنه:</h4>
                    <div id="steps-content"></div>
                </div>
                
                <div class="formula-box" style="margin-top: 40px;">
                    <h4 style="color: var(--accent-yellow); margin-bottom: 15px;">🧪 واکنش‌های نمونه برای تمرین:</h4>
                    <div class="element-selector">
                        <button class="element-btn" onclick="loadExample(0)">N₂ + H₂ → NH₃</button>
                        <button class="element-btn" onclick="loadExample(1)">C₃H₈ + O₂ → CO₂ + H₂O</button>
                        <button class="element-btn" onclick="loadExample(2)">Fe + O₂ → Fe₂O₃</button>
                        <button class="element-btn" onclick="loadExample(3)">Al + HCl → AlCl₃ + H₂</button>
                        <button class="element-btn" onclick="loadExample(4)">Na + H₂O → NaOH + H₂</button>
                        <button class="element-btn" onclick="loadExample(5)">KClO₃ → KCl + O₂</button>
                        <button class="element-btn" onclick="loadExample(6)">H₂SO₄ + NaOH → Na₂SO₄ + H₂O</button>
                        <button class="element-btn" onclick="loadExample(7)">CaCO₃ + HCl → CaCl₂ + CO₂ + H₂O</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- صفحه حل استوکیومتری -->
    <section id="stoichiometry-solver" class="page">
        <div class="container">
            <h2 class="section-title">حل مسائل استوکیومتری</h2>
            
            <div class="science-tool">
                <h3 style="color: var(--accent-blue); text-align: center; margin-bottom: 30px;">
                    حل مسائل استوکیومتری با وارد کردن واکنش و مقادیر
                </h3>
                
                <div class="tool-input-group">
                    <label style="color: var(--accent-blue); display: block; margin-bottom: 10px; font-size: 1.1rem;">
                        <i class="fas fa-vial"></i> واکنش شیمیایی:
                    </label>
                    <input type="text" id="stoich-equation" class="equation-input" 
                           placeholder="مثال: 2H2 + O2 → 2H2O"
                           value="2H2 + O2 → 2H2O">
                </div>
                
                <div class="stoichiometry-inputs">
                    <div>
                        <label style="color: var(--accent-green); display: block; margin-bottom: 10px;">
                            مقدار ماده اول (گرم):
                        </label>
                        <input type="number" id="mass-input1" class="form-control" placeholder="مثال: 10" value="10">
                        <select id="compound1" class="form-control" style="margin-top: 10px;">
                            <option value="H2">هیدروژن (H₂)</option>
                            <option value="O2">اکسیژن (O₂)</option>
                            <option value="H2O" selected>آب (H₂O)</option>
                        </select>
                    </div>
                    
                    <div>
                        <label style="color: var(--accent-green); display: block; margin-bottom: 10px;">
                            ماده مورد محاسبه:
                        </label>
                        <select id="target-compound" class="form-control">
                            <option value="H2">هیدروژن (H₂)</option>
                            <option value="O2" selected>اکسیژن (O₂)</option>
                            <option value="H2O">آب (H₂O)</option>
                        </select>
                        <div style="margin-top: 10px;">
                            <label style="color: var(--text-secondary); display: block; margin-bottom: 5px;">
                                <input type="radio" name="output-type" value="mass" checked> جرم (گرم)
                            </label>
                            <label style="color: var(--text-secondary); display: block;">
                                <input type="radio" name="output-type" value="moles"> تعداد مول
                            </label>
                        </div>
                    </div>
                </div>
                
                <div style="text-align: center; margin: 30px 0;">
                    <button class="btn" onclick="solveStoichiometry()" style="padding: 15px 40px; font-size: 1.2rem;">
                        <i class="fas fa-calculator"></i> حل مسئله
                    </button>
                </div>
                
                <div class="tool-result" id="stoich-result" style="display: none;">
                    <h4 style="color: var(--accent-blue); margin-bottom: 15px;">📊 نتیجه محاسبات:</h4>
                    <div id="stoich-answer"></div>
                </div>
                
                <div class="calculation-steps" id="stoich-steps" style="display: none;">
                    <h4 style="color: var(--accent-blue); margin-bottom: 15px;">📝 مراحل حل:</h4>
                    <div id="stoich-steps-content"></div>
                </div>
                
                <div class="formula-box" style="margin-top: 40px;">
                    <h4 style="color: var(--accent-yellow); margin-bottom: 15px;">🔢 مثال‌های آماده:</h4>
                    <div class="element-selector">
                        <button class="element-btn" onclick="loadStoichExample(0)">سوزاندن متان</button>
                        <button class="element-btn" onclick="loadStoichExample(1)">تجزیه آب</button>
                        <button class="element-btn" onclick="loadStoichExample(2)">تشکیل آمونیاک</button>
                        <button class="element-btn" onclick="loadStoichExample(3)">خنثی‌سازی اسید</button>
                        <button class="element-btn" onclick="loadStoichExample(4)">تولید آهن</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- صفحه آزمون هوشمند -->
    <section id="smart-quiz" class="page">
        <div class="container">
            <h2 class="section-title">آزمون هوشمند شیمی</h2>
            
            <div class="science-tool">
                <h3 style="color: var(--accent-blue); text-align: center; margin-bottom: 30px;">
                    آزمون‌های سطح‌بندی شده بر اساس امتیاز شما
                </h3>
                
                <div class="user-panel" style="margin-bottom: 40px;">
                    <div class="user-info">
                        <div class="user-avatar">
                            <i class="fas fa-user-graduate"></i>
                        </div>
                        <div>
                            <h2 id="quiz-user-name" style="color: var(--accent-blue);">دانش‌آموز عزیز</h2>
                            <p id="quiz-user-level" style="color: var(--text-secondary);">سطح: مبتدی</p>
                            <p id="quiz-user-score" style="color: var(--text-muted); font-size: 0.9rem;">
                                <i class="fas fa-star"></i> امتیاز کل: <span id="total-score">0</span>
                            </p>
                        </div>
                    </div>
                </div>
                
                <div class="smart-quiz-levels" id="quiz-levels">
                    <!-- با جاوااسکریپت پر می‌شود -->
                </div>
                
                <div id="quiz-container" style="display: none;">
                    <!-- محتوای آزمون -->
                </div>
                
                <div class="result-box" id="smart-quiz-result" style="display: none;">
                    <!-- نتایج آزمون -->
                </div>
            </div>
        </div>
    </section>

    <!-- صفحه ویدیو آزمایش‌ها -->
    <section id="experiment-videos" class="page">
        <div class="container">
            <h2 class="section-title">ویدیوهای آزمایش‌های مهم شیمی</h2>
            
            <div class="video-player-container">
                <!-- پخش‌کننده ویدیو -->
            </div>
            
            <div class="upload-section">
                <h3 style="color: var(--accent-blue); margin-bottom: 20px;">آپلود ویدیوی آزمایش جدید</h3>
                
                <form id="experiment-upload-form">
                    <div class="form-group">
                        <label for="experiment-title">عنوان آزمایش:</label>
                        <input type="text" id="experiment-title" class="form-control" placeholder="مثال: آزمایش الکترولیز آب" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="experiment-description">توضیحات آزمایش:</label>
                        <textarea id="experiment-description" class="form-control" rows="3" placeholder="مواد مورد نیاز، مراحل آزمایش، نتایج..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="experiment-category">دسته‌بندی:</label>
                        <select id="experiment-category" class="form-control" required>
                            <option value="">انتخاب کنید</option>
                            <option value="electrochemistry">الکتروشیمی</option>
                            <option value="precipitation">تشکیل رسوب</option>
                            <option value="reaction">واکنش‌های شیمیایی</option>
                            <option value="titration">تیتراسیون</option>
                            <option value="gas">تولید گاز</option>
                            <option value="color">تغییر رنگ</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="experiment-video-file">فایل ویدیو:</label>
                        <div class="upload-area" onclick="document.getElementById('experiment-video-file').click()">
                            <i class="fas fa-cloud-upload-alt" style="font-size: 3rem; color: var(--accent-blue); margin-bottom: 15px;"></i>
                            <p style="color: var(--text-secondary);">برای آپلود کلیک کنید یا فایل را اینجا بکشید</p>
                            <p style="color: var(--text-muted); font-size: 0.9rem; margin-top: 10px;">
                                فرمت‌های مجاز: MP4, WebM, MOV
                            </p>
                            <input type="file" id="experiment-video-file" accept="video/*" style="display: none;">
                        </div>
                    </div>
                    
                    <button type="submit" class="submit-btn">
                        <i class="fas fa-upload"></i> آپلود ویدیوی آزمایش
                    </button>
                </form>
            </div>
        </div>
    </section>

    <!-- ادامه صفحات موجود... -->

    <!-- فوتر -->
    <footer>
        <div class="container">
            <div class="social-links">
                <a href="https://www.instagram.com" class="social-link" target="_blank">
                    <i class="fab fa-instagram"></i>
                </a>
                <a href="https://telegram.org" class="social-link" target="_blank">
                    <i class="fab fa-telegram"></i>
                </a>
                <a href="tel:+989121234567" class="social-link">
                    <i class="fas fa-phone"></i>
                </a>
                <a href="mailto:chemistry.teacher@example.com" class="social-link">
                    <i class="fas fa-envelope"></i>
                </a>
                <a href="https://wa.me/989121234567" class="social-link" target="_blank">
                    <i class="fab fa-whatsapp"></i>
                </a>
            </div>
            <div class="copyright">
                <p>© ۱۴۰۳ تمامی حقوق این سایت محفوظ است. مدرس تخصصی شیمی کنکور - دکتر علی احمدی</p>
                <p>ارائه بهترین خدمات آموزشی برای موفقیت در کنکور شیمی</p>
            </div>
        </div>
    </footer>

    <!-- مدال اطلاعات -->
    <div class="element-modal" id="element-modal">
        <div class="modal-content">
            <button class="close-modal" id="close-modal">&times;</button>
            <div id="modal-content">
                <!-- محتوای مدال با جاوااسکریپت پر می‌شود -->
            </div>
        </div>
    </div>

    <!-- دکمه مدیریت سوالات -->
    <button class="admin-panel-btn" id="admin-panel-btn">
        <i class="fas fa-cog"></i> مدیریت سوالات
    </button>

    <!-- JavaScript شروع -->
    <script>
        // =================== سیستم ثبت نام و ورود ===================
        const users = JSON.parse(localStorage.getItem('chemistryUsers')) || [];
        const currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;
        const videos = JSON.parse(localStorage.getItem('chemistryVideos')) || getDefaultVideos();
        let studentQuestions = JSON.parse(localStorage.getItem('chemistryQuestions')) || [];
        
        // داده‌های جدید
        const electrochemicalReactions = JSON.parse(localStorage.getItem('electrochemicalReactions')) || getDefaultElectrochemicalReactions();
        const precipitations = JSON.parse(localStorage.getItem('precipitations')) || getDefaultPrecipitations();
        const lewisStructures = JSON.parse(localStorage.getItem('lewisStructures')) || getDefaultLewisStructures();
        const smartQuizLevels = JSON.parse(localStorage.getItem('smartQuizLevels')) || getDefaultQuizLevels();

        // منوی موبایل
        const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
        const navLinks = document.querySelector('.nav-links');
        
        mobileMenuBtn.addEventListener('click', () => {
            navLinks.classList.toggle('active');
            mobileMenuBtn.innerHTML = navLinks.classList.contains('active') 
                ? '<i class="fas fa-times"></i>' 
                : '<i class="fas fa-bars"></i>';
        });
        
        // سیستم نمایش صفحات
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            window.scrollTo(0, 0);
            
            // بارگذاری محتوای صفحه
            const loaders = {
                'home': () => {},
                'dashboard': updateDashboard,
                'auth': checkAuthStatus,
                'electrochemistry': loadElectrochemistry,
                'precipitations': loadPrecipitations,
                'lewis-structures': loadLewisStructures,
                'naming-compounds': loadNamingCompounds,
                'compound-builder': loadCompoundBuilder,
                'balance-equation': loadBalanceEquation,
                'stoichiometry-solver': loadStoichiometrySolver,
                'smart-quiz': loadSmartQuiz,
                'experiment-videos': loadExperimentVideos,
                'elements': loadPeriodicTable,
                'molar-mass': loadMolarMassElements,
                'reactions': loadReactions,
                'handouts': loadHandouts,
                'questions': loadQuestions,
                'quiz': loadQuiz,
                'videos': loadVideos,
                'gallery': loadGallery,
                'help': loadHelpSection,
                'video-analysis': loadVideoAnalysis
            };
            
            if (loaders[pageId]) {
                loaders[pageId]();
            }
            
            return false;
        }

        // =================== الکتروشیمی تعاملی ===================
        function getDefaultElectrochemicalReactions() {
            return [
                {
                    anode: "Zn",
                    cathode: "Cu",
                    anodeReaction: "Zn → Zn²⁺ + 2e⁻",
                    cathodeReaction: "Cu²⁺ + 2e⁻ → Cu",
                    fullReaction: "Zn + Cu²⁺ → Zn²⁺ + Cu",
                    voltage: 1.10,
                    type: "جانشینی",
                    info: "پیل روی-مس (ولتاییک) - روی اکسید و مس کاهش می‌یابد."
                },
                {
                    anode: "Cu",
                    cathode: "Ag",
                    anodeReaction: "Cu → Cu²⁺ + 2e⁻",
                    cathodeReaction: "Ag⁺ + e⁻ → Ag",
                    fullReaction: "Cu + 2Ag⁺ → Cu²⁺ + 2Ag",
                    voltage: 0.46,
                    type: "جانشینی",
                    info: "پیل مس-نقره - در این پیل مس فعال‌تر است."
                },
                {
                    anode: "Mg",
                    cathode: "Fe",
                    anodeReaction: "Mg → Mg²⁺ + 2e⁻",
                    cathodeReaction: "Fe²⁺ + 2e⁻ → Fe",
                    fullReaction: "Mg + Fe²⁺ → Mg²⁺ + Fe",
                    voltage: 1.93,
                    type: "جانشینی",
                    info: "پیل منیزیم-آهن - منیزیم شدیداً فعال است."
                },
                {
                    anode: "Al",
                    cathode: "Cu",
                    anodeReaction: "Al → Al³⁺ + 3e⁻",
                    cathodeReaction: "Cu²⁺ + 2e⁻ → Cu",
                    fullReaction: "2Al + 3Cu²⁺ → 2Al³⁺ + 3Cu",
                    voltage: 2.00,
                    type: "جانشینی",
                    info: "پیل آلومینیوم-مس - آلومینیوم فعال‌تر است."
                },
                {
                    anode: "Fe",
                    cathode: "Ni",
                    anodeReaction: "Fe → Fe²⁺ + 2e⁻",
                    cathodeReaction: "Ni²⁺ + 2e⁻ → Ni",
                    fullReaction: "Fe + Ni²⁺ → Fe²⁺ + Ni",
                    voltage: 0.19,
                    type: "جانشینی",
                    info: "پیل آهن-نیکل - آهن اندکی فعال‌تر است."
                },
                {
                    anode: "H2",
                    cathode: "O2",
                    anodeReaction: "2H₂ → 4H⁺ + 4e⁻",
                    cathodeReaction: "O₂ + 4H⁺ + 4e⁻ → 2H₂O",
                    fullReaction: "2H₂ + O₂ → 2H₂O",
                    voltage: 1.23,
                    type: "سوختنی",
                    info: "پیل سوختی هیدروژنی - تولید آب از هیدروژن و اکسیژن."
                }
            ];
        }

        let selectedAnode = null;
        let selectedCathode = null;

        function loadElectrochemistry() {
            loadElectrochemistryElements();
            loadElectrochemistryTable();
        }

        function loadElectrochemistryElements() {
            const container = document.querySelector('#electrochemistry .element-selector');
            const elements = [
                'Zn', 'Cu', 'Ag', 'Mg', 'Fe', 'Al', 'Ni', 'Pb', 'Sn', 
                'H2', 'O2', 'Cl2', 'Na', 'K', 'Ca'
            ];
            
            container.innerHTML = `
                <div style="grid-column: 1 / -1; text-align: center; margin-bottom: 20px;">
                    <p style="color: var(--text-secondary);">ابتدا آند (اکسایش) سپس کاتد (کاهش) را انتخاب کنید:</p>
                </div>
                <div style="grid-column: 1 / -1;">
                    <h4 style="color: var(--accent-red); text-align: center; margin-bottom: 10px;">آند (اکسایش می‌شود):</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 10px;">
                        ${elements.map(el => `
                            <button class="element-btn ${selectedAnode === el ? 'selected' : ''}" 
                                    onclick="selectAnode('${el}')" 
                                    style="${selectedAnode === el ? 'background: var(--accent-red); color: white;' : ''}">
                                ${el}
                            </button>
                        `).join('')}
                    </div>
                </div>
                <div style="grid-column: 1 / -1; margin-top: 20px;">
                    <h4 style="color: var(--accent-green); text-align: center; margin-bottom: 10px;">کاتد (کاهش می‌یابد):</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 10px;">
                        ${elements.map(el => `
                            <button class="element-btn ${selectedCathode === el ? 'selected' : ''}" 
                                    onclick="selectCathode('${el}')"
                                    style="${selectedCathode === el ? 'background: var(--accent-green); color: white;' : ''}">
                                ${el}
                            </button>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function selectAnode(element) {
            selectedAnode = element;
            loadElectrochemistryElements();
            document.getElementById('anode-element').textContent = element;
            checkElectrochemistryReaction();
        }

        function selectCathode(element) {
            selectedCathode = element;
            loadElectrochemistryElements();
            document.getElementById('cathode-element').textContent = element;
            checkElectrochemistryReaction();
        }

        function checkElectrochemistryReaction() {
            if (selectedAnode && selectedCathode) {
                const reaction = electrochemicalReactions.find(r => 
                    (r.anode === selectedAnode && r.cathode === selectedCathode) ||
                    (r.anode === selectedCathode && r.cathode === selectedAnode)
                );
                
                if (reaction) {
                    // اگر عناصر معکوس انتخاب شده باشند
                    const isReversed = reaction.anode !== selectedAnode;
                    
                    document.getElementById('anode-reaction').textContent = 
                        isReversed ? reaction.cathodeReaction : reaction.anodeReaction;
                    document.getElementById('cathode-reaction').textContent = 
                        isReversed ? reaction.anodeReaction : reaction.cathodeReaction;
                    document.getElementById('reaction-equation').textContent = 
                        isReversed ? reaction.fullReaction.split('→').reverse().join('←') : reaction.fullReaction;
                    
                    document.getElementById('reaction-info').innerHTML = `
                        <p><strong>نوع واکنش:</strong> ${reaction.type}</p>
                        <p><strong>ولتاژ استاندارد:</strong> ${reaction.voltage} V</p>
                        <p><strong>توضیحات:</strong> ${reaction.info}</p>
                    `;
                    
                    document.getElementById('voltage-info').innerHTML = `
                        <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; margin-top: 10px;">
                            <p style="color: var(--accent-yellow); margin: 0;">
                                <i class="fas fa-bolt"></i> این واکنش خودبخودی است (ولتاژ مثبت)
                            </p>
                        </div>
                    `;
                    
                    document.getElementById('electrochemistry-result').style.display = 'block';
                } else {
                    // واکنش جدید
                    document.getElementById('anode-reaction').textContent = `${selectedAnode} → ${selectedAnode}⁺ + e⁻`;
                    document.getElementById('cathode-reaction').textContent = `${selectedCathode}⁺ + e⁻ → ${selectedCathode}`;
                    document.getElementById('reaction-equation').textContent = 
                        `${selectedAnode} + ${selectedCathode}⁺ → ${selectedAnode}⁺ + ${selectedCathode}`;
                    
                    document.getElementById('reaction-info').innerHTML = `
                        <p><strong>نوع واکنش:</strong> الکتروشیمیایی</p>
                        <p><strong>ولتاژ استاندارد:</strong> محاسبه نیاز دارد</p>
                        <p><strong>توضیحات:</strong> واکنش اکسایش-کاهش بین ${selectedAnode} و ${selectedCathode}</p>
                    `;
                    
                    document.getElementById('electrochemistry-result').style.display = 'block';
                }
            }
        }

        function clearElectrochemistrySelection() {
            selectedAnode = null;
            selectedCathode = null;
            loadElectrochemistryElements();
            document.getElementById('anode-element').textContent = '--';
            document.getElementById('cathode-element').textContent = '--';
            document.getElementById('anode-reaction').textContent = 'نیم‌واکنش';
            document.getElementById('cathode-reaction').textContent = 'نیم‌واکنش';
            document.getElementById('reaction-equation').textContent = '-- واکنشی انتخاب نشده --';
            document.getElementById('electrochemistry-result').style.display = 'none';
        }

        function loadElectrochemistryTable() {
            const container = document.getElementById('electrochemistry-reactions-table');
            container.innerHTML = electrochemicalReactions.map((reaction, index) => `
                <tr>
                    <td>${index + 1}</td>
                    <td><strong>${reaction.anode} | ${reaction.cathode}</strong></td>
                    <td style="font-family: monospace;">${reaction.fullReaction}</td>
                    <td style="color: var(--accent-green); font-weight: bold;">${reaction.voltage} V</td>
                    <td>${reaction.info}</td>
                </tr>
            `).join('');
        }

        // =================== رسوبات شیمیایی ===================
        function getDefaultPrecipitations() {
            return [
                {
                    name: "کلرید نقره",
                    formula: "AgCl",
                    color: "سفید",
                    solubility: "نامحلول",
                    ions: "Ag⁺ + Cl⁻",
                    conditions: "اضافه کردن کلرید به محلول نقره",
                    hexColor: "#ffffff"
                },
                {
                    name: "برمید نقره",
                    formula: "AgBr",
                    color: "زرد کمرنگ",
                    solubility: "نامحلول",
                    ions: "Ag⁺ + Br⁻",
                    conditions: "اضافه کردن برمید به محلول نقره",
                    hexColor: "#ffeb3b"
                },
                {
                    name: "یدید نقره",
                    formula: "AgI",
                    color: "زرد",
                    solubility: "نامحلول",
                    ions: "Ag⁺ + I⁻",
                    conditions: "اضافه کردن یدید به محلول نقره",
                    hexColor: "#ffc107"
                },
                {
                    name: "سولفات باریم",
                    formula: "BaSO₄",
                    color: "سفید",
                    solubility: "نامحلول",
                    ions: "Ba²⁺ + SO₄²⁻",
                    conditions: "اضافه کردن سولفات به محلول باریم",
                    hexColor: "#ffffff"
                },
                {
                    name: "کربنات کلسیم",
                    formula: "CaCO₃",
                    color: "سفید",
                    solubility: "نامحلول",
                    ions: "Ca²⁺ + CO₃²⁻",
                    conditions: "اضافه کردن کربنات به محلول کلسیم",
                    hexColor: "#ffffff"
                },
                {
                    name: "هیدروکسید آهن(II)",
                    formula: "Fe(OH)₂",
                    color: "سبز کمرنگ",
                    solubility: "نامحلول",
                    ions: "Fe²⁺ + 2OH⁻",
                    conditions: "اضافه کردن هیدروکسید به محلول آهن(II)",
                    hexColor: "#8bc34a"
                },
                {
                    name: "هیدروکسید آهن(III)",
                    formula: "Fe(OH)₃",
                    color: "قهوه‌ای مایل به قرمز",
                    solubility: "نامحلول",
                    ions: "Fe³⁺ + 3OH⁻",
                    conditions: "اضافه کردن هیدروکسید به محلول آهن(III)",
                    hexColor: "#795548"
                },
                {
                    name: "هیدروکسید مس(II)",
                    formula: "Cu(OH)₂",
                    color: "آبی",
                    solubility: "نامحلول",
                    ions: "Cu²⁺ + 2OH⁻",
                    conditions: "اضافه کردن هیدروکسید به محلول مس",
                    hexColor: "#2196f3"
                },
                {
                    name: "سولفید آهن(II)",
                    formula: "FeS",
                    color: "سیاه",
                    solubility: "نامحلول",
                    ions: "Fe²⁺ + S²⁻",
                    conditions: "اضافه کردن سولفید به محلول آهن(II)",
                    hexColor: "#000000"
                },
                {
                    name: "کرومات نقره",
                    formula: "Ag₂CrO₄",
                    color: "قرمز آجری",
                    solubility: "نامحلول",
                    ions: "2Ag⁺ + CrO₄²⁻",
                    conditions: "اضافه کردن کرومات به محلول نقره",
                    hexColor: "#d84315"
                },
                {
                    name: "پرمنگنات باریم",
                    formula: "Ba(MnO₄)₂",
                    color: "بنفش",
                    solubility: "محلول",
                    ions: "Ba²⁺ + 2MnO₄⁻",
                    conditions: "پرمنگنات باریم در آب محلول است",
                    hexColor: "#9c27b0"
                },
                {
                    name: "کلرات پتاسیم",
                    formula: "KClO₃",
                    color: "سفید",
                    solubility: "محلول",
                    ions: "K⁺ + ClO₃⁻",
                    conditions: "همه کلرات‌ها محلول هستند",
                    hexColor: "#ffffff"
                },
                {
                    name: "نیترات سدیم",
                    formula: "NaNO₃",
                    color: "سفید",
                    solubility: "محلول",
                    ions: "Na⁺ + NO₃⁻",
                    conditions: "همه نیترات‌ها محلول هستند",
                    hexColor: "#ffffff"
                }
            ];
        }

        function loadPrecipitations() {
            const container = document.getElementById('precipitations-table');
            container.innerHTML = precipitations.map(precip => `
                <tr>
                    <td><strong>${precip.name}</strong></td>
                    <td style="font-family: monospace; font-weight: bold;">${precip.formula}</td>
                    <td>
                        <span>${precip.color}</span>
                        <div class="precipitation-color" style="background-color: ${precip.hexColor};"></div>
                    </td>
                    <td style="color: ${precip.solubility === 'محلول' ? 'var(--accent-green)' : 'var(--accent-red)'};">
                        ${precip.solubility}
                    </td>
                    <td style="font-family: monospace;">${precip.ions}</td>
                    <td>${precip.conditions}</td>
                </tr>
            `).join('');
        }

        // =================== ساختارهای لوویس ===================
        function getDefaultLewisStructures() {
            return [
                {
                    name: "آب",
                    formula: "H₂O",
                    type: "molecular",
                    structure: "H:O:H",
                    electrons: "8 الکترون والانس",
                    geometry: "خمیده",
                    angle: "104.5°",
                    description: "اکسیژن مرکزی با دو پیوند با هیدروژن و دو جفت الکترون ناپیوندی"
                },
                {
                    name: "متان",
                    formula: "CH₄",
                    type: "organic",
                    structure: "H | H:C:H | H",
                    electrons: "8 الکترون والانس",
                    geometry: "چهاروجهی",
                    angle: "109.5°",
                    description: "کربن مرکزی با چهار پیوند با هیدروژن"
                },
                {
                    name: "آمونیاک",
                    formula: "NH₃",
                    type: "molecular",
                    structure: "H | H:N:H | ··",
                    electrons: "8 الکترون والانس",
                    geometry: "هرمی",
                    angle: "107°",
                    description: "نیتروژن مرکزی با سه پیوند با هیدروژن و یک جفت الکترون ناپیوندی"
                },
                {
                    name: "دی‌اکسید کربن",
                    formula: "CO₂",
                    type: "molecular",
                    structure: "O::C::O",
                    electrons: "16 الکترون والانس",
                    geometry: "خطی",
                    angle: "180°",
                    description: "کربن مرکزی با دو پیوند دوگانه با اکسیژن"
                },
                {
                    name: "اتانول",
                    formula: "C₂H₅OH",
                    type: "organic",
                    structure: "H H | | H:C:C:O:H | | H H",
                    electrons: "20 الکترون والانس",
                    geometry: "-",
                    angle: "-",
                    description: "اتیل الکل با گروه هیدروکسیل"
                },
                {
                    name: "سدیم کلرید",
                    formula: "NaCl",
                    type: "ionic",
                    structure: "Na⁺ [:Cl:]⁻",
                    electrons: "8 الکترون والانس (فقط کلر)",
                    geometry: "مکعبی",
                    angle: "90°",
                    description: "ترکیب یونی با انتقال الکترون"
                },
                {
                    name: "کلسیم اکسید",
                    formula: "CaO",
                    type: "ionic",
                    structure: "Ca²⁺ [:O:]²⁻",
                    electrons: "8 الکترون والانس (فقط اکسیژن)",
                    geometry: "مکعبی",
                    angle: "90°",
                    description: "ترکیب یونی با انتقال دو الکترون"
                },
                {
                    name: "اسید سولفوریک",
                    formula: "H₂SO₄",
                    type: "acid",
                    structure: "O || O:S:O || O | H H",
                    electrons: "32 الکترون والانس",
                    geometry: "-",
                    angle: "-",
                    description: "اسید قوی با دو گروه هیدروکسیل"
                },
                {
                    name: "اتیلن",
                    formula: "C₂H₄",
                    type: "organic",
                    structure: "H H \\ / C=C / \\ H H",
                    electrons: "12 الکترون والانس",
                    geometry: "مسطح",
                    angle: "120°",
                    description: "آلکن با پیوند دوگانه کربن-کربن"
                },
                {
                    name: "استیلن",
                    formula: "C₂H₂",
                    type: "organic",
                    structure: "H—C≡C—H",
                    electrons: "10 الکترون والانس",
                    geometry: "خطی",
                    angle: "180°",
                    description: "آلکین با پیوند سه‌گانه کربن-کربن"
                }
            ];
        }

        function loadLewisStructures() {
            filterLewisStructures('all');
        }

        function filterLewisStructures(type) {
            const container = document.getElementById('lewis-structures-grid');
            let filtered = lewisStructures;
            
            if (type !== 'all') {
                filtered = lewisStructures.filter(item => item.type === type);
            }
            
            // به‌روزرسانی دکمه‌های فیلتر
            document.querySelectorAll('#lewis-filters .chapter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            container.innerHTML = filtered.map(item => `
                <div class="compound-item">
                    <h4 style="color: var(--accent-blue); margin-bottom: 15px;">${item.name} (${item.formula})</h4>
                    <div class="lewis-diagram">
                        ${item.structure}
                    </div>
                    <div style="margin-top: 15px;">
                        <p style="color: var(--text-secondary); margin-bottom: 5px;">
                            <i class="fas fa-atom"></i> ${item.electrons}
                        </p>
                        <p style="color: var(--text-secondary); margin-bottom: 5px;">
                            <i class="fas fa-shapes"></i> هندسه: ${item.geometry}
                        </p>
                        ${item.angle !== '-' ? `
                            <p style="color: var(--text-secondary); margin-bottom: 5px;">
                                <i class="fas fa-angle-right"></i> زاویه: ${item.angle}
                            </p>
                        ` : ''}
                        <p style="color: var(--text-muted); font-size: 0.9rem; margin-top: 10px;">
                            ${item.description}
                        </p>
                    </div>
                </div>
            `).join('');
        }

        // =================== نامگذاری ترکیبات ===================
        function loadNamingCompounds() {
            showNamingRules('ionic');
        }

        function showNamingRules(type) {
            document.querySelectorAll('.chapter-filter .chapter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            const container = document.getElementById('naming-content');
            const practiceSection = document.getElementById('practice-section');
            
            if (type === 'practice') {
                container.style.display = 'none';
                practiceSection.style.display = 'block';
                generatePracticeQuestions();
            } else {
                container.style.display = 'block';
                practiceSection.style.display = 'none';
                
                let content = '';
                if (type === 'ionic') {
                    content = `
                        <div class="naming-rules">
                            <h3 style="color: var(--accent-blue); margin-bottom: 25px;">قواعد نامگذاری ترکیبات یونی</h3>
                            
                            <div class="naming-example">
                                <h4 style="color: var(--accent-green); margin-bottom: 10px;">۱. ترکیبات یونی ساده</h4>
                                <p style="color: var(--text-primary);">نام کاتیون + نام آنیون + "ید"</p>
                                <p style="color: var(--text-secondary); font-family: monospace; margin-top: 10px;">
                                    مثال: NaCl → سدیم کلرید<br>
                                    مثال: CaO → کلسیم اکسید<br>
                                    مثال: Al₂O₃ → آلومینیوم اکسید
                                </p>
                            </div>
                            
                            <div class="naming-example">
                                <h4 style="color: var(--accent-green); margin-bottom: 10px;">۲. کاتیون‌های با چند عدد اکسایش</h4>
                                <p style="color: var(--text-primary);">نام کاتیون + (عدد اکسایش به صورت رومی) + نام آنیون + "ید"</p>
                                <p style="color: var(--text-secondary); font-family: monospace; margin-top: 10px;">
                                    مثال: FeCl₂ → آهن(II) کلرید<br>
                                    مثال: FeCl₃ → آهن(III) کلرید<br>
                                    مثال: CuO → مس(II) اکسید<br>
                                    مثال: Cu₂O → مس(I) اکسید
                                </p>
                            </div>
                            
                            <div class="naming-example">
                                <h4 style="color: var(--accent-green); margin-bottom: 10px;">۳. آنیون‌های چنداتمی</h4>
                                <p style="color: var(--text-primary);">نام کاتیون + نام آنیون چنداتمی</p>
                                <p style="color: var(--text-secondary); font-family: monospace; margin-top: 10px;">
                                    مثال: NaNO₃ → سدیم نیترات<br>
                                    مثال: CaCO₃ → کلسیم کربنات<br>
                                    مثال: KMnO₄ → پتاسیم پرمنگنات<br>
                                    مثال: Na₂SO₄ → سدیم سولفات
                                </p>
                            </div>
                        </div>
                    `;
                } else if (type === 'molecular') {
                    content = `
                        <div class="naming-rules">
                            <h3 style="color: var(--accent-blue); margin-bottom: 25px;">قواعد نامگذاری ترکیبات مولکولی</h3>
                            
                            <div class="naming-example">
                                <h4 style="color: var(--accent-green); margin-bottom: 10px;">۱. ترکیبات دو عنصری</h4>
                                <p style="color: var(--text-primary);">پیشوند تعداد + نام عنصر اول + پیشوند تعداد + نام عنصر دوم + "ید"</p>
                                <p style="color: var(--text-secondary); margin-top: 10px;">
                                    پیشوندها:<br>
                                    ۱: مونو (معمولاً حذف می‌شود)<br>
                                    ۲: دی<br>
                                    ۳: تری<br>
                                    ۴: تترا<br>
                                    ۵: پنتا<br>
                                    ۶: هگزا<br>
                                    ۷: هپتا<br>
                                    ۸: اکتا
                                </p>
                                <p style="color: var(--text-secondary); font-family: monospace; margin-top: 10px;">
                                    مثال: CO → مونوکسید کربن<br>
                                    مثال: CO₂ → دی‌اکسید کربن<br>
                                    مثال: N₂O → دی‌نیتروژن مونوکسید<br>
                                    مثال: PCl₅ → پنتاکلرید فسفر
                                </p>
                            </div>
                            
                            <div class="naming-example">
                                <h4 style="color: var(--accent-green); margin-bottom: 10px;">۲. ترکیبات آلی ساده</h4>
                                <p style="color: var(--text-primary);">پیشوند تعداد کربن + "ان" (برای آلکان‌ها)</p>
                                <p style="color: var(--text-secondary); font-family: monospace; margin-top: 10px;">
                                    مثال: CH₄ → متان<br>
                                    مثال: C₂H₆ → اتان<br>
                                    مثال: C₃H₈ → پروپان<br>
                                    مثال: C₄H₁₀ → بوتان
                                </p>
                            </div>
                        </div>
                    `;
                } else if (type === 'acid') {
                    content = `
                        <div class="naming-rules">
                            <h3 style="color: var(--accent-blue); margin-bottom: 25px;">قواعد نامگذاری اسیدها</h3>
                            
                            <div class="naming-example">
                                <h4 style="color: var(--accent-green); margin-bottom: 10px;">۱. اسیدهای بدون اکسیژن</h4>
                                <p style="color: var(--text-primary);">هیدرو + نام آنیون + "یک" + اسید</p>
                                <p style="color: var(--text-secondary); font-family: monospace; margin-top: 10px;">
                                    مثال: HCl → هیدروکلریک اسید<br>
                                    مثال: HBr → هیدروبرمیک اسید<br>
                                    مثال: HI → هیدرویدیک اسید<br>
                                    مثال: H₂S → هیدروسولفوریک اسید
                                </p>
                            </div>
                            
                            <div class="naming-example">
                                <h4 style="color: var(--accent-green); margin-bottom: 10px;">۲. اسیدهای دارای اکسیژن</h4>
                                <p style="color: var(--text-primary);">نام آنیون (ات → یک / ایت → ار) + اسید</p>
                                <p style="color: var(--text-secondary); font-family: monospace; margin-top: 10px;">
                                    مثال: H₂SO₄ → سولفوریک اسید (از سولفات)<br>
                                    مثال: H₂SO₃ → سولفورو اسید (از سولفیت)<br>
                                    مثال: HNO₃ → نیتریک اسید (از نیترات)<br>
                                    مثال: HNO₂ → نیترو اسید (از نیتریت)<br>
                                    مثال: H₃PO₄ → فسفریک اسید (از فسفات)
                                </p>
                            </div>
                        </div>
                    `;
                }
                
                container.innerHTML = content;
            }
        }

        function generatePracticeQuestions() {
            const questions = [
                { formula: "NaCl", answer: "سدیم کلرید", type: "ionic" },
                { formula: "FeCl₂", answer: "آهن(II) کلرید", type: "ionic" },
                { formula: "CaCO₃", answer: "کلسیم کربنات", type: "ionic" },
                { formula: "CO₂", answer: "دی‌اکسید کربن", type: "molecular" },
                { formula: "N₂O", answer: "دی‌نیتروژن مونوکسید", type: "molecular" },
                { formula: "HCl", answer: "هیدروکلریک اسید", type: "acid" },
                { formula: "H₂SO₄", answer: "سولفوریک اسید", type: "acid" },
                { formula: "CH₄", answer: "متان", type: "molecular" },
                { formula: "CuO", answer: "مس(II) اکسید", type: "ionic" },
                { formula: "PCl₅", answer: "پنتاکلرید فسفر", type: "molecular" }
            ];
            
            const container = document.getElementById('practice-questions');
            container.innerHTML = questions.map((q, index) => `
                <div class="question-item">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <span style="color: var(--accent-blue); font-weight: bold;">سوال ${index + 1}:</span>
                            <span style="font-family: monospace; font-size: 1.2rem; margin-right: 15px;">${q.formula}</span>
                        </div>
                        <button class="btn quick-action-btn" onclick="showAnswer(${index})" 
                                style="background: var(--accent-purple);">
                            <i class="fas fa-eye"></i> مشاهده پاسخ
                        </button>
                    </div>
                    <div id="answer-${index}" class="solution" style="display: none;">
                        <strong>پاسخ:</strong> ${q.answer}<br>
                        <strong>نوع ترکیب:</strong> ${q.type === 'ionic' ? 'یونی' : q.type === 'molecular' ? 'مولکولی' : 'اسید'}
                    </div>
                </div>
            `).join('');
        }

        function showAnswer(index) {
            const answerDiv = document.getElementById(`answer-${index}`);
            answerDiv.style.display = answerDiv.style.display === 'none' ? 'block' : 'none';
        }

        // =================== ترکیب‌ساز ===================
        function loadCompoundBuilder() {
            loadCompoundElements();
            loadImportantCompounds();
        }

        function loadCompoundElements() {
            const elements = [
                'H', 'He', 'Li', 'Be', 'B', 'C', 'N', 'O', 'F', 'Ne',
                'Na', 'Mg', 'Al', 'Si', 'P', 'S', 'Cl', 'Ar', 'K', 'Ca',
                'Fe', 'Cu', 'Zn', 'Br', 'Ag', 'I', 'Au', 'Hg', 'Pb', 'U'
            ];
            
            const container = document.getElementById('compound-elements');
            container.innerHTML = `
                <div style="grid-column: 1 / -1; text-align: center; margin-bottom: 20px;">
                    <p style="color: var(--text-secondary);">دو عنصر را برای تشکیل ترکیب انتخاب کنید:</p>
                </div>
                ${elements.map(el => `
                    <button class="element-btn" onclick="selectCompoundElement('${el}')">
                        ${el}
                    </button>
                `).join('')}
            `;
        }

        let selectedElement1 = null;
        let selectedElement2 = null;

        function selectCompoundElement(element) {
            if (!selectedElement1) {
                selectedElement1 = element;
                document.getElementById('selected-element1').textContent = element;
                document.getElementById('calculate-btn').disabled = true;
            } else if (!selectedElement2 && element !== selectedElement1) {
                selectedElement2 = element;
                document.getElementById('selected-element2').textContent = element;
                document.getElementById('calculate-btn').disabled = false;
            } else {
                // اگر هر دو انتخاب شده باشند، عنصر اول را با جدید جایگزین کن
                selectedElement1 = selectedElement2;
                selectedElement2 = element;
                document.getElementById('selected-element1').textContent = selectedElement1;
                document.getElementById('selected-element2').textContent = selectedElement2;
            }
        }

        function calculateCompound() {
            if (!selectedElement1 || !selectedElement2) return;
            
            const compounds = {
                'H-O': { formula: 'H₂O', name: 'آب', type: 'مولکولی', properties: 'مایع، بی‌رنگ، دمای جوش ۱۰۰°C', uses: 'حلال عمومی، ضروری برای حیات' },
                'Na-Cl': { formula: 'NaCl', name: 'سدیم کلرید', type: 'یونی', properties: 'جامد سفید، دمای ذوب ۸۰۱°C', uses: 'نمک طعام، ماده اولیه صنایع' },
                'C-O': { formula: 'CO₂', name: 'دی‌اکسید کربن', type: 'مولکولی', properties: 'گاز بی‌رنگ، دمای تصعید -۷۸°C', uses: 'نوشابه، اطفاء حریق' },
                'Fe-O': { formula: 'Fe₂O₃', name: 'آهن(III) اکسید', type: 'یونی', properties: 'جامد قهوه‌ای مایل به قرمز', uses: 'سنگ آهن، رنگدانه' },
                'Al-O': { formula: 'Al₂O₃', name: 'آلومینیوم اکسید', type: 'یونی', properties: 'جامد سفید، دمای ذوب ۲۰۷۲°C', uses: 'ساینده، عایق' },
                'H-Cl': { formula: 'HCl', name: 'هیدروژن کلرید', type: 'مولکولی', properties: 'گاز بی‌رنگ، اسید قوی', uses: 'پاک‌کننده، تولید پلاستیک' },
                'Ca-O': { formula: 'CaO', name: 'کلسیم اکسید', type: 'یونی', properties: 'جامد سفید، جاذب رطوبت', uses: 'تهیه سیمان، تصفیه آب' },
                'N-H': { formula: 'NH₃', name: 'آمونیاک', type: 'مولکولی', properties: 'گاز بی‌رنگ با بوی تند', uses: 'کود شیمیایی، مواد پاک‌کننده' },
                'C-H': { formula: 'CH₄', name: 'متان', type: 'مولکولی آلی', properties: 'گاز بی‌رنگ، بی‌بو، قابل اشتعال', uses: 'سوخت، تولید هیدروژن' },
                'S-O': { formula: 'SO₂', name: 'دی‌اکسید گوگرد', type: 'مولکولی', properties: 'گاز بی‌رنگ با بوی خفه‌کننده', uses: 'سفیدکننده، تولید اسید سولفوریک' }
            };
            
            const key1 = `${selectedElement1}-${selectedElement2}`;
            const key2 = `${selectedElement2}-${selectedElement1}`;
            const compound = compounds[key1] || compounds[key2];
            
            if (compound) {
                document.getElementById('compound-result').textContent = compound.formula;
                document.getElementById('compound-info').innerHTML = `
                    <p><strong>نام ترکیب:</strong> ${compound.name}</p>
                    <p><strong>نوع ترکیب:</strong> ${compound.type}</p>
                    <p><strong>فرمول شیمیایی:</strong> ${compound.formula}</p>
                `;
                document.getElementById('compound-properties').innerHTML = `
                    <p><strong>خواص فیزیکی:</strong> ${compound.properties}</p>
                `;
                document.getElementById('compound-uses').innerHTML = `
                    <p><strong>کاربردها:</strong> ${compound.uses}</p>
                `;
            } else {
                document.getElementById('compound-result').textContent = `${selectedElement1}${selectedElement2}`;
                document.getElementById('compound-info').innerHTML = `
                    <p><strong>نام ترکیب:</strong> ${selectedElement1} ${selectedElement2}ید</p>
                    <p><strong>نوع ترکیب:</strong> احتمالاً یونی یا مولکولی</p>
                    <p><strong>فرمول پیشنهادی:</strong> ${selectedElement1}${selectedElement2}</p>
                `;
                document.getElementById('compound-properties').innerHTML = `
                    <p><strong>خواص فیزیکی:</strong> نیاز به اطلاعات بیشتر دارد</p>
                `;
                document.getElementById('compound-uses').innerHTML = `
                    <p><strong>کاربردها:</strong> انواع کاربردهای صنعتی و آزمایشگاهی</p>
                `;
            }
            
            document.getElementById('compound-details').style.display = 'block';
        }

        function clearCompoundSelection() {
            selectedElement1 = null;
            selectedElement2 = null;
            document.getElementById('selected-element1').textContent = '--';
            document.getElementById('selected-element2').textContent = '--';
            document.getElementById('compound-result').textContent = '--';
            document.getElementById('compound-details').style.display = 'none';
            document.getElementById('calculate-btn').disabled = true;
        }

        function loadImportantCompounds() {
            const importantCompounds = [
                { formula: 'H₂O', name: 'آب', description: 'ضروری برای حیات' },
                { formula: 'NaCl', name: 'نمک طعام', description: 'طعم‌دهنده غذا' },
                { formula: 'CO₂', name: 'دی‌اکسید کربن', description: 'گاز گلخانه‌ای' },
                { formula: 'CH₄', name: 'متان', description: 'گاز طبیعی' },
                { formula: 'NH₃', name: 'آمونیاک', description: 'تولید کود' },
                { formula: 'H₂SO₄', name: 'اسید سولفوریک', description: 'صنایع شیمیایی' },
                { formula: 'NaOH', name: 'سود سوزآور', description: 'قلیای قوی' },
                { formula: 'CaCO₃', name: 'کربنات کلسیم', description: 'سنگ آهک' },
                { formula: 'C₆H₁₂O₆', name: 'گلوکز', description: 'قند ساده' },
                { formula: 'C₂H₅OH', name: 'اتانول', description: 'الکل طبی' }
            ];
            
            const container = document.getElementById('important-compounds');
            container.innerHTML = importantCompounds.map(comp => `
                <div class="compound-item">
                    <h4 style="color: var(--accent-blue); margin-bottom: 5px;">${comp.name}</h4>
                    <div style="font-family: monospace; font-size: 1.1rem; color: var(--accent-yellow); margin-bottom: 10px;">
                        ${comp.formula}
                    </div>
                    <p style="color: var(--text-secondary); font-size: 0.9rem;">${comp.description}</p>
                </div>
            `).join('');
        }

        // =================== موازنه واکنش ===================
        function loadBalanceEquation() {
            // آماده‌سازی اولیه
        }

        const examples = [
            "N2 + H2 → NH3",
            "C3H8 + O2 → CO2 + H2O",
            "Fe + O2 → Fe2O3",
            "Al + HCl → AlCl3 + H2",
            "Na + H2O → NaOH + H2",
            "KClO3 → KCl + O2",
            "H2SO4 + NaOH → Na2SO4 + H2O",
            "CaCO3 + HCl → CaCl2 + CO2 + H2O"
        ];

        function loadExample(index) {
            document.getElementById('equation-input').value = examples[index];
        }

        function balanceEquation() {
            const input = document.getElementById('equation-input').value.trim();
            if (!input) {
                alert('لطفا یک واکنش شیمیایی وارد کنید.');
                return;
            }

            // نمونه‌های از پیش تعریف شده
            const balancedEquations = {
                "N2 + H2 → NH3": "N₂ + 3H₂ → 2NH₃",
                "C3H8 + O2 → CO2 + H2O": "C₃H₈ + 5O₂ → 3CO₂ + 4H₂O",
                "Fe + O2 → Fe2O3": "4Fe + 3O₂ → 2Fe₂O₃",
                "Al + HCl → AlCl3 + H2": "2Al + 6HCl → 2AlCl₃ + 3H₂",
                "Na + H2O → NaOH + H2": "2Na + 2H₂O → 2NaOH + H₂",
                "KClO3 → KCl + O2": "2KClO₃ → 2KCl + 3O₂",
                "H2SO4 + NaOH → Na2SO4 + H2O": "H₂SO₄ + 2NaOH → Na₂SO₄ + 2H₂O",
                "CaCO3 + HCl → CaCl2 + CO2 + H2O": "CaCO₃ + 2HCl → CaCl₂ + CO₂ + H₂O",
                "H2 + O2 → H2O": "2H₂ + O₂ → 2H₂O",
                "CH4 + O2 → CO2 + H2O": "CH₄ + 2O₂ → CO₂ + 2H₂O"
            };

            let balanced = balancedEquations[input];
            if (!balanced) {
                // تلاش برای موازنه ساده
                if (input.includes("H2 + O2 → H2O")) {
                    balanced = "2H₂ + O₂ → 2H₂O";
                } else if (input.includes("CH4 + O2 → CO2 + H2O")) {
                    balanced = "CH₄ + 2O₂ → CO₂ + 2H₂O";
                } else {
                    balanced = "موازنه این واکنش نیاز به محاسبات پیچیده‌تر دارد.";
                }
            }

            document.getElementById('balanced-equation').textContent = balanced;
            document.getElementById('balanced-result').style.display = 'block';

            // نمایش مراحل نمونه
            if (input.includes("H2 + O2 → H2O")) {
                document.getElementById('steps-content').innerHTML = `
                    <div class="step">۱. واکنش: H₂ + O₂ → H₂O</div>
                    <div class="step">۲. تعداد اتم‌های اکسیژن را برابر می‌کنیم: H₂ + O₂ → 2H₂O</div>
                    <div class="step">۳. تعداد اتم‌های هیدروژن را برابر می‌کنیم: 2H₂ + O₂ → 2H₂O</div>
                    <div class="step">۴. بررسی نهایی: 
                        H: ۴ = ۴ ✓ 
                        O: ۲ = ۲ ✓
                    </div>
                    <div class="step">۵. واکنش موازنه شده: 2H₂ + O₂ → 2H₂O</div>
                `;
                document.getElementById('balance-steps').style.display = 'block';
            } else {
                document.getElementById('balance-steps').style.display = 'none';
            }
        }

        // =================== حل استوکیومتری ===================
        function loadStoichiometrySolver() {
            // آماده‌سازی اولیه
        }

        const stoichExamples = [
            {
                equation: "CH4 + 2O2 → CO2 + 2H2O",
                mass1: 16,
                compound1: "CH4",
                target: "CO2",
                title: "سوزاندن متان"
            },
            {
                equation: "2H2O → 2H2 + O2",
                mass1: 36,
                compound1: "H2O",
                target: "H2",
                title: "تجزیه آب"
            },
            {
                equation: "N2 + 3H2 → 2NH3",
                mass1: 28,
                compound1: "N2",
                target: "NH3",
                title: "تشکیل آمونیاک"
            },
            {
                equation: "NaOH + HCl → NaCl + H2O",
                mass1: 40,
                compound1: "NaOH",
                target: "NaCl",
                title: "خنثی‌سازی اسید"
            },
            {
                equation: "Fe2O3 + 3CO → 2Fe + 3CO2",
                mass1: 160,
                compound1: "Fe2O3",
                target: "Fe",
                title: "تولید آهن"
            }
        ];

        function loadStoichExample(index) {
            const ex = stoichExamples[index];
            document.getElementById('stoich-equation').value = ex.equation;
            document.getElementById('mass-input1').value = ex.mass1;
            document.getElementById('compound1').value = ex.compound1;
            document.getElementById('target-compound').value = ex.target;
        }

        function solveStoichiometry() {
            const equation = document.getElementById('stoich-equation').value;
            const mass1 = parseFloat(document.getElementById('mass-input1').value);
            const compound1 = document.getElementById('compound1').value;
            const target = document.getElementById('target-compound').value;
            const outputType = document.querySelector('input[name="output-type"]:checked').value;

            if (!equation || isNaN(mass1)) {
                alert('لطفا مقادیر را به درستی وارد کنید.');
                return;
            }

            // جرم مولی ترکیبات
            const molarMasses = {
                'H2': 2,
                'O2': 32,
                'H2O': 18,
                'CH4': 16,
                'CO2': 44,
                'N2': 28,
                'NH3': 17,
                'NaOH': 40,
                'HCl': 36.5,
                'NaCl': 58.5,
                'Fe2O3': 160,
                'CO': 28,
                'Fe': 56
            };

            // استخراج ضرایب استوکیومتری از معادله
            const getCoefficient = (eq, compound) => {
                const regex = new RegExp(`(\\d*)\\s*${compound.replace(/\d/g, '\\d*')}`);
                const match = eq.match(regex);
                return match ? (match[1] ? parseInt(match[1]) : 1) : 0;
            };

            const coeff1 = getCoefficient(equation.split('→')[0], compound1);
            const coeffTarget = getCoefficient(equation.split('→')[1], target);

            if (coeff1 === 0 || coeffTarget === 0) {
                alert('ترکیب مورد نظر در معادله یافت نشد.');
                return;
            }

            // محاسبات
            const moles1 = mass1 / (molarMasses[compound1] || 1);
            const molesTarget = moles1 * (coeffTarget / coeff1);
            
            let result;
            let resultValue;
            
            if (outputType === 'mass') {
                resultValue = molesTarget * (molarMasses[target] || 1);
                result = `${resultValue.toFixed(2)} گرم ${target}`;
            } else {
                resultValue = molesTarget;
                result = `${resultValue.toFixed(2)} مول ${target}`;
            }

            document.getElementById('stoich-answer').innerHTML = `
                <p style="font-size: 1.2rem; color: var(--accent-green);">
                    <strong>نتیجه:</strong> ${result}
                </p>
                <p style="color: var(--text-secondary); margin-top: 10px;">
                    از ${mass1} گرم ${compound1}، ${result} تولید می‌شود.
                </p>
            `;
            
            document.getElementById('stoich-result').style.display = 'block';

            // نمایش مراحل حل
            document.getElementById('stoich-steps-content').innerHTML = `
                <div class="step">۱. محاسبه تعداد مول‌های ${compound1}:<br>
                    n = جرم / جرم مولی = ${mass1} / ${molarMasses[compound1] || 1} = ${moles1.toFixed(2)} mol
                </div>
                <div class="step">۲. نسبت استوکیومتری از معادله:<br>
                    ${coeff1} ${compound1} → ${coeffTarget} ${target}<br>
                    نسبت = ${coeffTarget} / ${coeff1} = ${(coeffTarget / coeff1).toFixed(2)}
                </div>
                <div class="step">۳. تعداد مول‌های ${target}:<br>
                    n(${target}) = n(${compound1}) × نسبت = ${moles1.toFixed(2)} × ${(coeffTarget / coeff1).toFixed(2)} = ${molesTarget.toFixed(2)} mol
                </div>
                ${outputType === 'mass' ? `
                    <div class="step">۴. محاسبه جرم ${target}:<br>
                        جرم = n × جرم مولی = ${molesTarget.toFixed(2)} × ${molarMasses[target] || 1} = ${resultValue.toFixed(2)} g
                    </div>
                ` : ''}
            `;
            
            document.getElementById('stoich-steps').style.display = 'block';
    <script>
        // =================== آزمون هوشمند ===================
        function getDefaultQuizLevels() {
            return [
                {
                    id: 1,
                    name: "سطح مبتدی",
                    description: "سوالات پایه‌ای شیمی",
                    requiredScore: 0,
                    unlocked: true,
                    questions: [
                        {
                            question: "عدد اتمی کربن چند است؟",
                            options: ["4", "6", "8", "12"],
                            correct: 1,
                            explanation: "کربن دارای ۶ پروتون است، بنابراین عدد اتمی آن ۶ است."
                        },
                        {
                            question: "جرم مولی آب چند است؟",
                            options: ["16 g/mol", "18 g/mol", "20 g/mol", "22 g/mol"],
                            correct: 1,
                            explanation: "H₂O = (۲×۱) + ۱۶ = ۱۸ گرم بر مول"
                        },
                        {
                            question: "کدام عنصر در گروه هالوژن‌ها قرار دارد؟",
                            options: ["Na", "Cl", "Ca", "Fe"],
                            correct: 1,
                            explanation: "کلر (Cl) در گروه ۱۷ (هالوژن‌ها) قرار دارد."
                        }
                    ],
                    passingScore: 70,
                    timeLimit: 10 // دقیقه
                },
                {
                    id: 2,
                    name: "سطح متوسط",
                    description: "سوالات متوسط شیمی",
                    requiredScore: 200,
                    unlocked: false,
                    questions: [
                        {
                            question: "واکنش احتراق متان چگونه است؟",
                            options: [
                                "CH₄ + O₂ → CO₂ + H₂O",
                                "CH₄ + 2O₂ → CO₂ + 2H₂O",
                                "CH₄ + 3O₂ → CO₂ + 3H₂O",
                                "2CH₄ + 3O₂ → 2CO₂ + 3H₂O"
                            ],
                            correct: 1,
                            explanation: "CH₄ + 2O₂ → CO₂ + 2H₂O (واکنش کامل احتراق)"
                        },
                        {
                            question: "pH محلول خنثی در ۲۵°C چند است؟",
                            options: ["0", "7", "14", "10"],
                            correct: 1,
                            explanation: "در دمای ۲۵ درجه سانتی‌گراد، pH محلول خنثی برابر ۷ است."
                        },
                        {
                            question: "کدام یک گاز نجیب است؟",
                            options: ["هیدروژن", "اکسیژن", "نئون", "نیتروژن"],
                            correct: 2,
                            explanation: "نئون در گروه ۱۸ جدول تناوبی قرار دارد (گازهای نجیب)."
                        }
                    ],
                    passingScore: 70,
                    timeLimit: 15
                },
                {
                    id: 3,
                    name: "سطح پیشرفته",
                    description: "سوالات پیشرفته کنکوری",
                    requiredScore: 500,
                    unlocked: false,
                    questions: [
                        {
                            question: "پیل گالوانی روی-مس چه ولتاژی دارد؟",
                            options: ["0.34 V", "0.76 V", "1.10 V", "2.34 V"],
                            correct: 2,
                            explanation: "پیل روی-مس دارای ولتاژ استاندارد ۱.۱۰ ولت است."
                        },
                        {
                            question: "حاصل‌ضرب حلالیت AgCl در ۲۵°C چقدر است؟",
                            options: ["1.8×10⁻¹⁰", "2.8×10⁻¹⁰", "3.6×10⁻¹⁰", "4.8×10⁻¹⁰"],
                            correct: 0,
                            explanation: "Ksp برای AgCl در ۲۵°C برابر ۱.۸×۱۰⁻¹⁰ است."
                        },
                        {
                            question: "ساختار الکترونی اتم آهن (Fe) چگونه است؟",
                            options: [
                                "[Ar] 4s² 3d⁶",
                                "[Ar] 4s¹ 3d⁷",
                                "[Ar] 4s² 3d⁵ 4p¹",
                                "[Ar] 4s² 3d⁴ 4p²"
                            ],
                            correct: 0,
                            explanation: "آرایش الکترونی آهن: 1s² 2s² 2p⁶ 3s² 3p⁶ 4s² 3d⁶ یا [Ar] 4s² 3d⁶"
                        }
                    ],
                    passingScore: 70,
                    timeLimit: 20
                }
            ];
        }

        let currentSmartQuizLevel = null;
        let currentSmartQuestion = 0;
        let smartQuizAnswers = [];
        let smartQuizTimer = null;
        let smartQuizTimeLeft = 0;

        function loadSmartQuiz() {
            const container = document.getElementById('quiz-levels');
            const userScore = currentUser ? currentUser.progress.score : 0;
            
            // به‌روزرسانی اطلاعات کاربر
            if (currentUser) {
                document.getElementById('quiz-user-name').textContent = currentUser.name;
                document.getElementById('total-score').textContent = userScore;
                
                // تعیین سطح کاربر
                let userLevel = "مبتدی";
                if (userScore >= 500) userLevel = "پیشرفته";
                else if (userScore >= 200) userLevel = "متوسط";
                document.getElementById('quiz-user-level').textContent = `سطح: ${userLevel}`;
            }
            
            // ایجاد کارت‌های سطوح
            container.innerHTML = smartQuizLevels.map(level => {
                const isUnlocked = userScore >= level.requiredScore || level.unlocked;
                const isCurrent = isUnlocked && (!currentSmartQuizLevel || currentSmartQuizLevel.id === level.id);
                
                return `
                    <div class="level-card ${isUnlocked ? 'unlocked' : 'locked'} ${isCurrent ? 'current' : ''}" 
                         onclick="${isUnlocked ? `startSmartQuiz(${level.id})` : ''}">
                        ${!isUnlocked ? '<div class="level-badge"><i class="fas fa-lock"></i></div>' : ''}
                        <h3 style="color: ${isUnlocked ? 'var(--accent-blue)' : 'var(--text-muted)'}; margin-bottom: 10px;">
                            ${level.name}
                        </h3>
                        <p style="color: var(--text-secondary); margin-bottom: 15px; font-size: 0.9rem;">
                            ${level.description}
                        </p>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: var(--text-muted); font-size: 0.8rem;">
                                <i class="fas fa-star"></i> نیاز به ${level.requiredScore} امتیاز
                            </span>
                            <span style="color: ${isUnlocked ? 'var(--accent-green)' : 'var(--accent-red)'}; font-size: 0.8rem;">
                                ${isUnlocked ? '<i class="fas fa-unlock"></i> باز است' : '<i class="fas fa-lock"></i> قفل'}
                            </span>
                        </div>
                        <div style="margin-top: 15px; color: var(--text-muted); font-size: 0.8rem;">
                            <i class="fas fa-clock"></i> زمان: ${level.timeLimit} دقیقه
                        </div>
                    </div>
                `;
            }).join('');
            
            document.getElementById('quiz-container').style.display = 'none';
            document.getElementById('smart-quiz-result').style.display = 'none';
        }

        function startSmartQuiz(levelId) {
            currentSmartQuizLevel = smartQuizLevels.find(l => l.id === levelId);
            if (!currentSmartQuizLevel) return;
            
            currentSmartQuestion = 0;
            smartQuizAnswers = new Array(currentSmartQuizLevel.questions.length).fill(-1);
            smartQuizTimeLeft = currentSmartQuizLevel.timeLimit * 60; // به ثانیه
            
            // مخفی کردن سطوح و نمایش آزمون
            document.getElementById('quiz-levels').style.display = 'none';
            document.getElementById('quiz-container').style.display = 'block';
            
            // شروع تایمر
            startSmartQuizTimer();
            
            // نمایش اولین سوال
            showSmartQuizQuestion();
        }

        function startSmartQuizTimer() {
            if (smartQuizTimer) clearInterval(smartQuizTimer);
            
            smartQuizTimer = setInterval(() => {
                smartQuizTimeLeft--;
                updateSmartQuizTimer();
                
                if (smartQuizTimeLeft <= 0) {
                    clearInterval(smartQuizTimer);
                    finishSmartQuiz();
                }
            }, 1000);
            
            updateSmartQuizTimer();
        }

        function updateSmartQuizTimer() {
            const minutes = Math.floor(smartQuizTimeLeft / 60);
            const seconds = smartQuizTimeLeft % 60;
            document.getElementById('quiz-container').querySelector('.timer-display').textContent = 
                `زمان باقی‌مانده: ${minutes}:${seconds.toString().padStart(2, '0')}`;
        }

        function showSmartQuizQuestion() {
            if (!currentSmartQuizLevel || currentSmartQuestion >= currentSmartQuizLevel.questions.length) {
                finishSmartQuiz();
                return;
            }
            
            const question = currentSmartQuizLevel.questions[currentSmartQuestion];
            const container = document.getElementById('quiz-container');
            
            container.innerHTML = `
                <div style="background: var(--deep-blue); padding: 30px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; padding-bottom: 15px; border-bottom: 2px solid var(--light-blue);">
                        <div>
                            <h3 id="smart-question-number" style="color: var(--accent-blue);">
                                سوال ${currentSmartQuestion + 1} از ${currentSmartQuizLevel.questions.length}
                            </h3>
                            <p class="timer-display" style="color: var(--text-muted); margin-top: 5px;">
                                زمان باقی‌مانده: --
                            </p>
                        </div>
                        <div>
                            <span style="color: var(--accent-blue); font-weight: bold; font-size: 1.1rem;">
                                سطح: ${currentSmartQuizLevel.name}
                            </span>
                        </div>
                    </div>
                    
                    <div style="background: var(--light-blue); padding: 25px; border-radius: 10px; margin-bottom: 25px;">
                        <h3 id="smart-question-text" style="color: var(--text-primary); font-size: 1.2rem;">
                            ${question.question}
                        </h3>
                    </div>
                    
                    <div class="options-container" id="smart-options-container">
                        ${question.options.map((option, index) => `
                            <div class="option ${smartQuizAnswers[currentSmartQuestion] === index ? 'selected' : ''}" 
                                 onclick="selectSmartQuizOption(${index})">
                                <span style="font-weight: bold; margin-left: 10px;">${String.fromCharCode(65 + index)}.</span>
                                <span>${option}</span>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; margin-top: 30px;">
                        <button class="btn" id="smart-prev-btn" onclick="prevSmartQuizQuestion()" 
                                ${currentSmartQuestion === 0 ? 'disabled style="opacity: 0.5;"' : ''}>
                            <i class="fas fa-backward"></i> سوال قبلی
                        </button>
                        <button class="btn" id="smart-next-btn" onclick="nextSmartQuizQuestion()}"
                                style="${currentSmartQuestion === currentSmartQuizLevel.questions.length - 1 ? 'background-color: var(--accent-green);' : ''}">
                            ${currentSmartQuestion === currentSmartQuizLevel.questions.length - 1 ? 
                              '<i class="fas fa-check"></i> پایان آزمون' : 
                              'سوال بعدی <i class="fas fa-forward"></i>'}
                        </button>
                    </div>
                </div>
            `;
            
            updateSmartQuizTimer();
        }

        function selectSmartQuizOption(optionIndex) {
            smartQuizAnswers[currentSmartQuestion] = optionIndex;
            showSmartQuizQuestion();
        }

        function nextSmartQuizQuestion() {
            if (currentSmartQuestion < currentSmartQuizLevel.questions.length - 1) {
                currentSmartQuestion++;
                showSmartQuizQuestion();
            } else {
                finishSmartQuiz();
            }
        }

        function prevSmartQuizQuestion() {
            if (currentSmartQuestion > 0) {
                currentSmartQuestion--;
                showSmartQuizQuestion();
            }
        }

        function finishSmartQuiz() {
            clearInterval(smartQuizTimer);
            
            let correctAnswers = 0;
            currentSmartQuizLevel.questions.forEach((q, index) => {
                if (smartQuizAnswers[index] === q.correct) {
                    correctAnswers++;
                }
            });
            
            const percentage = Math.round((correctAnswers / currentSmartQuizLevel.questions.length) * 100);
            const passed = percentage >= currentSmartQuizLevel.passingScore;
            const scoreEarned = passed ? currentSmartQuizLevel.id * 100 : 0;
            
            // ذخیره نتایج برای کاربر
            if (currentUser && passed) {
                currentUser.progress.completedQuizzes.push({
                    level: currentSmartQuizLevel.name,
                    date: new Date().toLocaleDateString('fa-IR'),
                    score: percentage,
                    correctAnswers: correctAnswers,
                    totalQuestions: currentSmartQuizLevel.questions.length
                });
                
                currentUser.progress.score += scoreEarned;
                currentUser.progress.correctAnswers += correctAnswers;
                currentUser.progress.totalQuestions += currentSmartQuizLevel.questions.length;
                
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                // به‌روزرسانی لیست کاربران
                const userIndex = users.findIndex(u => u.id === currentUser.id);
                if (userIndex !== -1) {
                    users[userIndex] = currentUser;
                    localStorage.setItem('chemistryUsers', JSON.stringify(users));
                }
            }
            
            // نمایش نتایج
            document.getElementById('quiz-container').style.display = 'none';
            const resultBox = document.getElementById('smart-quiz-result');
            resultBox.style.display = 'block';
            resultBox.innerHTML = `
                <h2 style="color: ${passed ? 'var(--accent-green)' : 'var(--accent-red)'}; margin-bottom: 20px;">
                    ${passed ? '🎉 آزمون با موفقیت گذرانده شد!' : '⚠️ نیاز به تلاش بیشتر!'}
                </h2>
                <div style="font-size: 4rem; color: ${passed ? 'var(--accent-green)' : 'var(--accent-orange)'}; margin: 20px 0;">
                    ${percentage}%
                </div>
                <h3 id="result-message">
                    ${passed ? 'تبریک! شما این سطح را با موفقیت پشت سر گذاشتید.' : 
                             'برای گذراندن این سطح نیاز به حداقل ۷۰٪ نمره دارید.'}
                </h3>
                <p style="color: var(--text-secondary); margin: 20px 0; font-size: 1.1rem;">
                    شما به <strong>${correctAnswers}</strong> سوال از <strong>${currentSmartQuizLevel.questions.length}</strong> سوال پاسخ صحیح دادید.
                </p>
                
                ${passed ? `
                    <div style="background: rgba(81, 207, 102, 0.2); padding: 15px; border-radius: 10px; margin: 20px 0; border-right: 3px solid var(--accent-green);">
                        <p style="color: var(--accent-green); margin: 0;">
                            <i class="fas fa-star"></i> ${scoreEarned} امتیاز به حساب شما اضافه شد!
                        </p>
                    </div>
                ` : ''}
                
                <div style="margin: 30px 0;">
                    <button class="btn" onclick="reviewSmartQuiz()" style="margin-left: 10px;">
                        <i class="fas fa-eye"></i> بررسی پاسخ‌ها
                    </button>
                    <button class="btn" onclick="loadSmartQuiz()" style="background-color: var(--accent-blue);">
                        <i class="fas fa-redo"></i> بازگشت به سطوح
                    </button>
                    ${passed && currentSmartQuizLevel.id < smartQuizLevels.length ? `
                        <button class="btn" onclick="unlockNextLevel()" style="background-color: var(--accent-purple); margin-right: 10px;">
                            <i class="fas fa-lock-open"></i> باز کردن سطح بعدی
                        </button>
                    ` : ''}
                </div>
            `;
        }

        function unlockNextLevel() {
            if (currentSmartQuizLevel && currentSmartQuizLevel.id < smartQuizLevels.length) {
                const nextLevel = smartQuizLevels.find(l => l.id === currentSmartQuizLevel.id + 1);
                if (nextLevel && !nextLevel.unlocked) {
                    nextLevel.unlocked = true;
                    localStorage.setItem('smartQuizLevels', JSON.stringify(smartQuizLevels));
                    alert(`✅ سطح ${nextLevel.name} باز شد!`);
                    loadSmartQuiz();
                }
            }
        }

        function reviewSmartQuiz() {
            let reviewText = `📝 بررسی پاسخ‌های آزمون "${currentSmartQuizLevel.name}":\n\n`;
            
            currentSmartQuizLevel.questions.forEach((q, index) => {
                reviewText += `${index + 1}. ${q.question}\n`;
                reviewText += `✅ پاسخ صحیح: ${q.options[q.correct]}\n`;
                reviewText += `📖 توضیح: ${q.explanation}\n`;
                reviewText += `✏️ پاسخ شما: ${smartQuizAnswers[index] !== -1 ? q.options[smartQuizAnswers[index]] : 'پاسخی نداده‌اید'}\n\n`;
            });
            
            alert(reviewText);
        }

        // =================== سیستم رفع اشکال پیشرفته ===================
        function initializeQuestionManagement() {
            // تنظیم دکمه مدیریت
            const adminBtn = document.getElementById('admin-panel-btn');
            adminBtn.addEventListener('click', () => {
                const password = prompt('برای دسترسی به پنل مدیریت، رمز عبور را وارد کنید:');
                if (password === 'chem123') {
                    showQuestionsPanel();
                } else {
                    alert('رمز عبور اشتباه است!');
                }
            });
            
            // بارگذاری سوالات از localStorage
            studentQuestions = JSON.parse(localStorage.getItem('chemistryQuestions')) || [];
        }

        // نمایش پنل مدیریت سوالات
        function showQuestionsPanel() {
            studentQuestions = JSON.parse(localStorage.getItem('chemistryQuestions')) || [];
            
            let questionsHTML = `
                <div style="background: var(--deep-blue); padding: 30px; border-radius: 15px; max-height: 80vh; overflow-y: auto;">
                    <h2 style="color: var(--accent-blue); text-align: center; margin-bottom: 25px;">
                        <i class="fas fa-question-circle"></i> مدیریت سوالات دانش‌آموزان
                    </h2>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                        <div>
                            <span style="color: var(--text-secondary);">
                                تعداد کل سوالات: <strong>${studentQuestions.length}</strong>
                            </span>
                        </div>
                        <div>
                            <button onclick="exportQuestions()" class="btn quick-action-btn" style="background: var(--accent-green);">
                                <i class="fas fa-file-excel"></i> خروجی Excel
                            </button>
                            <button onclick="sendBulkSMS()" class="btn quick-action-btn" style="background: #2196F3;">
                                <i class="fas fa-sms"></i> ارسال پیامک گروهی
                            </button>
                        </div>
                    </div>
            `;
            
            if (studentQuestions.length === 0) {
                questionsHTML += `
                    <div style="text-align: center; padding: 50px; color: var(--text-muted);">
                        <i class="fas fa-inbox" style="font-size: 3rem; margin-bottom: 20px;"></i>
                        <h3>هنوز سوالی ثبت نشده است</h3>
                        <p>دانش‌آموزان شما می‌توانند از بخش "رفع اشکال" سوالات خود را ارسال کنند.</p>
                    </div>
                `;
            } else {
                // گروه‌بندی سوالات بر اساس وضعیت
                const newQuestions = studentQuestions.filter(q => q.status === 'جدید');
                const answeredQuestions = studentQuestions.filter(q => q.status === 'پاسخ داده');
                const pendingQuestions = studentQuestions.filter(q => q.status === 'در حال بررسی');
                
                // آمار
                questionsHTML += `
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 25px;">
                        <div style="background: var(--light-blue); padding: 15px; border-radius: 10px; text-align: center; border-right: 4px solid var(--accent-orange);">
                            <div style="font-size: 2rem; font-weight: bold; color: var(--accent-orange);">${newQuestions.length}</div>
                            <div style="color: var(--text-secondary);">سوال جدید</div>
                        </div>
                        <div style="background: var(--light-blue); padding: 15px; border-radius: 10px; text-align: center; border-right: 4px solid var(--accent-yellow);">
                            <div style="font-size: 2rem; font-weight: bold; color: var(--accent-yellow);">${pendingQuestions.length}</div>
                            <div style="color: var(--text-secondary);">در حال بررسی</div>
                        </div>
                        <div style="background: var(--light-blue); padding: 15px; border-radius: 10px; text-align: center; border-right: 4px solid var(--accent-green);">
                            <div style="font-size: 2rem; font-weight: bold; color: var(--accent-green);">${answeredQuestions.length}</div>
                            <div style="color: var(--text-secondary);">پاسخ داده شده</div>
                        </div>
                    </div>
                `;
                
                // جدول سوالات
                questionsHTML += `
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="background: var(--light-blue);">
                                    <th style="padding: 12px; text-align: right;">کد</th>
                                    <th style="padding: 12px; text-align: right;">دانش‌آموز</th>
                                    <th style="padding: 12px; text-align: right;">موضوع</th>
                                    <th style="padding: 12px; text-align: right;">تاریخ</th>
                                    <th style="padding: 12px; text-align: right;">وضعیت</th>
                                    <th style="padding: 12px; text-align: right;">عملیات</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                // نمایش سوالات به ترتیب جدیدترین
                [...studentQuestions].reverse().forEach((question, index) => {
                    const statusColor = question.status === 'پاسخ داده' ? 'var(--accent-green)' : 
                                      question.status === 'در حال بررسی' ? 'var(--accent-yellow)' : 'var(--accent-orange)';
                    
                    questionsHTML += `
                        <tr style="background: ${index % 2 === 0 ? 'var(--deep-blue)' : 'rgba(255,255,255,0.05)'};">
                            <td style="padding: 10px; border-bottom: 1px solid var(--light-blue);">${question.id}</td>
                            <td style="padding: 10px; border-bottom: 1px solid var(--light-blue);">
                                <strong>${question.name}</strong><br>
                                <small style="color: var(--text-muted);">${question.phone}</small>
                            </td>
                            <td style="padding: 10px; border-bottom: 1px solid var(--light-blue);">${question.subject}</td>
                            <td style="padding: 10px; border-bottom: 1px solid var(--light-blue);">${question.date}</td>
                            <td style="padding: 10px; border-bottom: 1px solid var(--light-blue);">
                                <span style="display: inline-block; padding: 4px 12px; border-radius: 15px; background: ${statusColor}; color: white; font-size: 0.8rem;">
                                    ${question.status}
                                </span>
                            </td>
                            <td style="padding: 10px; border-bottom: 1px solid var(--light-blue);">
                                <div style="display: flex; gap: 5px;">
                                    <button onclick="viewQuestionDetail(${question.id})" class="quick-action-btn" style="background: var(--accent-blue);">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button onclick="answerViaWhatsApp(${question.id})" class="quick-action-btn whatsapp-btn">
                                        <i class="fab fa-whatsapp"></i>
                                    </button>
                                    <button onclick="sendSMS(${question.id})" class="quick-action-btn sms-btn">
                                        <i class="fas fa-sms"></i>
                                    </button>
                                    <button onclick="deleteQuestion(${question.id})" class="quick-action-btn" style="background: var(--accent-red);">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                questionsHTML += `
                            </tbody>
                        </table>
                    </div>
                `;
            }
            
            questionsHTML += `
                    <div style="margin-top: 25px; text-align: center;">
                        <button onclick="closeModal()" class="btn" style="background: var(--accent-red);">
                            <i class="fas fa-times"></i> بستن پنل
                        </button>
                    </div>
                </div>
            `;
            
            // نمایش در مدال
            document.getElementById('modal-content').innerHTML = questionsHTML;
            document.getElementById('element-modal').style.display = 'flex';
        }

        // مشاهده جزئیات سوال و پاسخگویی
        function viewQuestionDetail(questionId) {
            const question = studentQuestions.find(q => q.id === questionId);
            if (!question) return;
            
            let detailHTML = `
                <div style="background: var(--deep-blue); padding: 25px; border-radius: 10px;">
                    <h3 style="color: var(--accent-blue); margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-question-circle"></i> جزئیات سوال
                    </h3>
                    
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 25px;">
                        <div style="background: var(--light-blue); padding: 15px; border-radius: 8px;">
                            <div style="color: var(--text-muted); font-size: 0.9rem;">کد سوال</div>
                            <div style="font-weight: bold; color: var(--accent-blue);">${question.id}</div>
                        </div>
                        <div style="background: var(--light-blue); padding: 15px; border-radius: 8px;">
                            <div style="color: var(--text-muted); font-size: 0.9rem;">وضعیت</div>
                            <div style="font-weight: bold; color: ${question.status === 'پاسخ داده' ? 'var(--accent-green)' : 'var(--accent-orange)'};">${question.status}</div>
                        </div>
                        <div style="background: var(--light-blue); padding: 15px; border-radius: 8px;">
                            <div style="color: var(--text-muted); font-size: 0.9rem;">نام دانش‌آموز</div>
                            <div style="font-weight: bold;">${question.name}</div>
                        </div>
                        <div style="background: var(--light-blue); padding: 15px; border-radius: 8px;">
                            <div style="color: var(--text-muted); font-size: 0.9rem;">شماره تماس</div>
                            <div style="font-weight: bold;">${question.phone}</div>
                        </div>
                    </div>
                    
                    <div style="background: var(--light-blue); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                        <div style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 10px;">موضوع</div>
                        <div style="font-weight: bold; color: var(--accent-blue);">${question.subject}</div>
                    </div>
                    
                    <div style="background: var(--light-blue); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                        <div style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 10px;">متن سوال</div>
                        <div style="white-space: pre-wrap; line-height: 1.6;">${question.question}</div>
                    </div>
            `;
            
            if (question.answer) {
                detailHTML += `
                    <div style="background: rgba(100, 255, 218, 0.1); padding: 20px; border-radius: 8px; margin-bottom: 20px; border-right: 3px solid var(--accent-blue);">
                        <div style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 10px;">پاسخ شما</div>
                        <div style="white-space: pre-wrap; line-height: 1.6;">${question.answer}</div>
                        <div style="color: var(--text-muted); font-size: 0.8rem; margin-top: 10px; text-align: left;">
                            <i class="fas fa-calendar"></i> ${question.answerDate || ''}
                        </div>
                    </div>
                `;
            }
            
            // فرم پاسخگویی
            detailHTML += `
                    <div style="margin-top: 25px;">
                        <h4 style="color: var(--accent-blue); margin-bottom: 15px;">📝 ثبت پاسخ</h4>
                        <textarea id="answerInput-${question.id}" 
                                  placeholder="پاسخ خود را اینجا بنویسید..." 
                                  style="width: 100%; height: 150px; padding: 15px; background: var(--light-blue); color: var(--text-primary); border: none; border-radius: 8px; margin-bottom: 15px;">${question.answer || ''}</textarea>
                        
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <button onclick="saveAnswer(${question.id})" class="btn" style="background: var(--accent-green); flex: 1;">
                                <i class="fas fa-save"></i> ذخیره پاسخ
                            </button>
                            <button onclick="answerViaWhatsApp(${question.id}, true)" class="btn whatsapp-btn" style="flex: 1;">
                                <i class="fab fa-whatsapp"></i> ارسال از طریق واتساپ
                            </button>
                            <button onclick="sendSMS(${question.id}, true)" class="btn sms-btn" style="flex: 1;">
                                <i class="fas fa-sms"></i> ارسال پیامک
                            </button>
                        </div>
                        
                        <div style="margin-top: 15px;">
                            <label style="color: var(--text-secondary); display: block; margin-bottom: 10px;">
                                <input type="checkbox" id="markAsAnswered-${question.id}" ${question.status === 'پاسخ داده' ? 'checked' : ''} onchange="toggleQuestionStatus(${question.id})">
                                علامت گذاری به عنوان پاسخ داده شده
                            </label>
                        </div>
                    </div>
                    
                    <div style="margin-top: 25px; text-align: center;">
                        <button onclick="showQuestionsPanel()" class="btn" style="background: var(--accent-purple);">
                            <i class="fas fa-arrow-right"></i> بازگشت به لیست
                        </button>
                    </div>
                </div>
            `;
            
            document.getElementById('modal-content').innerHTML = detailHTML;
        }

        // =================== توابع مدیریت سوالات ===================
        function saveAnswer(questionId) {
            const answer = document.getElementById(`answerInput-${questionId}`)?.value;
            if (!answer) {
                alert('لطفا پاسخ را وارد کنید.');
                return;
            }
            
            const questionIndex = studentQuestions.findIndex(q => q.id === questionId);
            if (questionIndex !== -1) {
                studentQuestions[questionIndex].answer = answer;
                studentQuestions[questionIndex].answerDate = new Date().toLocaleString('fa-IR');
                studentQuestions[questionIndex].answeredBy = currentUser?.name || 'مدرس';
                localStorage.setItem('chemistryQuestions', JSON.stringify(studentQuestions));
                
                alert('✅ پاسخ با موفقیت ذخیره شد!');
                viewQuestionDetail(questionId);
            }
        }

        function answerViaWhatsApp(questionId, fromDetail = false) {
            const question = studentQuestions.find(q => q.id === questionId);
            if (!question) return;
            
            const phone = question.phone.replace(/^0/, '98');
            const message = `سلام ${question.name} عزیز،\nپاسخ سوال شما:\n\nسوال: ${question.question}\n\nپاسخ: ${question.answer || 'در حال بررسی'}\n\nبا احترام، دکتر احمدی`;
            const url = `https://wa.me/${phone}?text=${encodeURIComponent(message)}`;
            window.open(url, '_blank');
            
            if (fromDetail) {
                alert('✅ پیام واتساپ آماده ارسال شد!');
            }
        }

        function sendSMS(questionId, fromDetail = false) {
            const question = studentQuestions.find(q => q.id === questionId);
            if (!question) return;
            
            // در واقعیت اینجا باید به API پیامک متصل شود
            const smsMessage = `سلام ${question.name} عزیز، پاسخ سوال شما در سایت بارگذاری شد. کد پیگیری: ${question.id}`;
            
            alert(`📱 پیامک برای ${question.name} (${question.phone}) آماده ارسال:\n\n"${smsMessage}"\n\nتوجه: این قابلیت نیاز به اتصال به سرویس پیامک دارد.`);
            
            if (fromDetail) {
                const questionIndex = studentQuestions.findIndex(q => q.id === questionId);
                if (questionIndex !== -1) {
                    studentQuestions[questionIndex].status = 'پاسخ داده';
                    localStorage.setItem('chemistryQuestions', JSON.stringify(studentQuestions));
                }
            }
        }

        function toggleQuestionStatus(questionId) {
            const questionIndex = studentQuestions.findIndex(q => q.id === questionId);
            if (questionIndex !== -1) {
                studentQuestions[questionIndex].status = 
                    studentQuestions[questionIndex].status === 'پاسخ داده' ? 'در حال بررسی' : 'پاسخ داده';
                localStorage.setItem('chemistryQuestions', JSON.stringify(studentQuestions));
            }
        }

        function exportQuestions() {
            const csvContent = "data:text/csv;charset=utf-8," 
                + "کد,نام,شماره,موضوع,تاریخ,وضعیت,سوال\n"
                + studentQuestions.map(q => 
                    `${q.id},${q.name},${q.phone},${q.subject},${q.date},${q.status},"${q.question}"`
                ).join("\n");
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "سوالات_دانش_آموزان.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            alert('📊 فایل اکسل سوالات دانلود شد!');
        }

        function sendBulkSMS() {
            const pendingQuestions = studentQuestions.filter(q => q.status !== 'پاسخ داده');
            if (pendingQuestions.length === 0) {
                alert('⚠️ هیچ سوالی برای ارسال پیامک وجود ندارد.');
                return;
            }
            
            const message = `سلام عزیزان،\nبه اطلاع می‌رسانم پاسخ سوالات شما در سایت بارگذاری شده است.\n\nبا تشکر، دکتر احمدی`;
            
            // در واقعیت اینجا باید برای هر شماره پیامک ارسال شود
            alert(`📢 پیامک گروهی برای ${pendingQuestions.length} دانش‌آموز آماده ارسال:\n\n"${message}"\n\nتعداد: ${pendingQuestions.length} نفر`);
        }

        function deleteQuestion(questionId) {
            if (confirm('آیا از حذف این سوال اطمینان دارید؟')) {
                studentQuestions = studentQuestions.filter(q => q.id !== questionId);
                localStorage.setItem('chemistryQuestions', JSON.stringify(studentQuestions));
                showQuestionsPanel();
                alert('✅ سوال با موفقیت حذف شد!');
            }
        }

        // =================== سیستم ثبت نام و ورود (به‌روزرسانی شده) ===================
        function showAuthForm(formType) {
            document.querySelectorAll('.auth-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.auth-form').forEach(form => {
                form.classList.remove('active');
            });
            
            if (formType === 'login') {
                document.querySelector('.auth-tab:nth-child(1)').classList.add('active');
                document.getElementById('login-form').classList.add('active');
            } else {
                document.querySelector('.auth-tab:nth-child(2)').classList.add('active');
                document.getElementById('register-form').classList.add('active');
            }
        }

        // ثبت نام کاربر جدید
        document.getElementById('registerForm')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const userData = {
                id: Date.now(),
                username: document.getElementById('register-username').value,
                phone: document.getElementById('register-phone').value,
                password: document.getElementById('register-password').value,
                grade: document.getElementById('register-grade').value,
                role: 'student',
                joinDate: new Date().toLocaleDateString('fa-IR'),
                lastLogin: new Date().toLocaleDateString('fa-IR'),
                progress: {
                    watchedVideos: [],
                    completedQuizzes: [],
                    score: 0,
                    correctAnswers: 0,
                    totalQuestions: 0,
                    smartQuizLevels: [1] // سطح 1 ابتدا باز است
                }
            };
            
            // بررسی تکراری نبودن نام کاربری
            if (users.some(u => u.username === userData.username)) {
                showAuthMessage('این نام کاربری قبلاً انتخاب شده است', 'error');
                return;
            }
            
            // بررسی شماره موبایل
            if (!validatePhone(userData.phone)) {
                showAuthMessage('شماره موبایل معتبر نیست', 'error');
                return;
            }
            
            // بررسی طول رمز عبور
            if (userData.password.length < 8) {
                showAuthMessage('رمز عبور باید حداقل ۸ کاراکتر باشد', 'error');
                return;
            }
            
            users.push(userData);
            localStorage.setItem('chemistryUsers', JSON.stringify(users));
            localStorage.setItem('currentUser', JSON.stringify(userData));
            
            showAuthMessage('✅ حساب کاربری با موفقیت ایجاد شد!', 'success');
            document.getElementById('registerForm').reset();
            
            setTimeout(() => {
                showPage('dashboard');
                updateNavForUser();
                updateDashboard();
                showWelcomeMessage(userData.username);
            }, 1500);
        });

        // ورود کاربر
        document.getElementById('loginForm')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('login-username').value;
            const password = document.getElementById('login-password').value;
            
            const user = users.find(u => u.username === username && u.password === password);
            
            if (user) {
                user.lastLogin = new Date().toLocaleDateString('fa-IR');
                localStorage.setItem('currentUser', JSON.stringify(user));
                localStorage.setItem('chemistryUsers', JSON.stringify(users));
                
                showAuthMessage('✅ ورود موفقیت‌آمیز بود!', 'success');
                document.getElementById('loginForm').reset();
                
                setTimeout(() => {
                    showPage('dashboard');
                    updateNavForUser();
                    updateDashboard();
                    showWelcomeMessage(user.username);
                }, 1000);
            } else {
                showAuthMessage('❌ نام کاربری یا رمز عبور اشتباه است', 'error');
            }
        });

        function validatePhone(phone) {
            const re = /^09\d{9}$/;
            return re.test(phone);
        }

        // =================== پنل کاربری ===================
        function updateDashboard() {
            if (currentUser) {
                document.getElementById('dashboard-name').textContent = currentUser.username;
                document.getElementById('dashboard-grade').textContent = 
                    `پایه ${getGradeName(currentUser.grade)} | دانش‌آموز`;
                document.getElementById('dashboard-date').innerHTML = 
                    `<i class="fas fa-calendar"></i> آخرین بازدید: ${currentUser.lastLogin || 'امروز'}`;
                
                // آمارها
                const watchedVideos = currentUser.progress?.watchedVideos?.length || 0;
                const completedQuizzes = currentUser.progress?.completedQuizzes?.length || 0;
                const totalScore = currentUser.progress?.score || 0;
                const averagePercentage = calculateAverageScore();
                
                document.getElementById('stat-videos').textContent = watchedVideos;
                document.getElementById('stat-quizzes').textContent = completedQuizzes;
                document.getElementById('stat-score').textContent = totalScore;
                document.getElementById('stat-percentage').textContent = `${averagePercentage}%`;
                
                // نمایش دکمه خروج
                document.getElementById('dashboard-login-btn').style.display = 'none';
                document.getElementById('dashboard-logout-btn').style.display = 'inline-block';
            } else {
                // ریست کردن اطلاعات برای کاربر مهمان
                document.getElementById('dashboard-name').textContent = 'دانش‌آموز عزیز';
                document.getElementById('dashboard-grade').textContent = 'لطفاً وارد حساب کاربری خود شوید';
                document.getElementById('dashboard-date').innerHTML = '<i class="fas fa-calendar"></i> آخرین بازدید: -';
                
                document.getElementById('stat-videos').textContent = '0';
                document.getElementById('stat-quizzes').textContent = '0';
                document.getElementById('stat-score').textContent = '0';
                document.getElementById('stat-percentage').textContent = '0%';
                
                // نمایش دکمه ورود
                document.getElementById('dashboard-login-btn').style.display = 'inline-block';
                document.getElementById('dashboard-logout-btn').style.display = 'none';
            }
        }

        // =================== توابع کمکی ===================
        function getGradeName(grade) {
            const grades = {
                '10': 'دهم',
                '11': 'یازدهم',
                '12': 'دوازدهم',
                '13': 'فارغ‌التحصیل'
            };
            return grades[grade] || 'نامشخص';
        }

        function calculateAverageScore() {
            if (!currentUser || !currentUser.progress || currentUser.progress.totalQuestions === 0) {
                return 0;
            }
            return Math.round((currentUser.progress.correctAnswers / currentUser.progress.totalQuestions) * 100);
        }

        function showWelcomeMessage(name) {
            const welcomeMsg = document.createElement('div');
            welcomeMsg.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-blue) 100%);
                color: var(--midnight-blue);
                padding: 15px 25px;
                border-radius: 10px;
                z-index: 1001;
                box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                animation: slideIn 0.5s ease;
            `;
            
            welcomeMsg.innerHTML = `
                <strong>👋 خوش آمدید ${name}!</strong>
                <p style="margin: 5px 0 0 0; font-size: 0.9rem;">به سیستم آموزشی شیمی خوش آمدید</p>
            `;
            
            document.body.appendChild(welcomeMsg);
            
            setTimeout(() => {
                welcomeMsg.style.animation = 'slideOut 0.5s ease';
                setTimeout(() => welcomeMsg.remove(), 500);
            }, 3000);
        }

        function logout() {
            localStorage.removeItem('currentUser');
            alert('با موفقیت خارج شدید.');
            updateNavForUser();
            showPage('home');
            updateDashboard();
        }

        function closeModal() {
            document.getElementById('element-modal').style.display = 'none';
        }

        // راه‌اندازی اولیه
        document.addEventListener('DOMContentLoaded', function() {
            // بارگذاری داده‌ها
            if (!localStorage.getItem('electrochemicalReactions')) {
                localStorage.setItem('electrochemicalReactions', JSON.stringify(getDefaultElectrochemicalReactions()));
            }
            if (!localStorage.getItem('precipitations')) {
                localStorage.setItem('precipitations', JSON.stringify(getDefaultPrecipitations()));
            }
            if (!localStorage.getItem('lewisStructures')) {
                localStorage.setItem('lewisStructures', JSON.stringify(getDefaultLewisStructures()));
            }
            if (!localStorage.getItem('smartQuizLevels')) {
                localStorage.setItem('smartQuizLevels', JSON.stringify(getDefaultQuizLevels()));
            }
            
            updateNavForUser();
            initializeQuestionManagement();
            updateDashboard();
            
            // نمایش صفحه اصلی
            showPage('home');
            
            // نمایش پیام خوش‌آمدگویی
            if (currentUser) {
                setTimeout(() => {
                    showWelcomeMessage(currentUser.username);
                }, 1000);
            }
        });

        // بستن مدال با کلیک خارج
        document.getElementById('element-modal')?.addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        // بستن مدال با دکمه
        document.getElementById('close-modal')?.addEventListener('click', closeModal);

        // انیمیشن‌های CSS
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from {
                    transform: translateX(100%);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            
            @keyframes slideOut {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(100%);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);
    </script>
        // =================== سیستم ویدیو آزمایش‌ها ===================
        function loadExperimentVideos() {
            const experimentVideos = JSON.parse(localStorage.getItem('experimentVideos')) || getDefaultExperimentVideos();
            
            const container = document.querySelector('#experiment-videos .video-player-container');
            if (!container) return;
            
            container.innerHTML = `
                <h3 style="color: var(--accent-blue); margin-bottom: 20px;" id="experiment-video-title">ویدیوهای آزمایش‌های مهم</h3>
                <div class="video-player">
                    <video id="experiment-video" controls poster="https://via.placeholder.com/800x450/112240/64ffda?text=Chemistry+Experiment">
                        <source src="" type="video/mp4">
                        مرورگر شما از پخش ویدیو پشتیبانی نمی‌کند.
                    </video>
                </div>
                
                <div class="video-controls">
                    <button class="btn" onclick="prevExperimentVideo()">
                        <i class="fas fa-backward"></i> قبلی
                    </button>
                    <button class="btn" onclick="nextExperimentVideo()">
                        بعدی <i class="fas fa-forward"></i>
                    </button>
                </div>
                
                <div class="video-playlist">
                    <h4 style="color: var(--accent-blue); margin-bottom: 15px;">لیست آزمایش‌ها</h4>
                    <div id="experiment-playlist">
                        ${experimentVideos.map((video, index) => `
                            <div class="playlist-item ${index === 0 ? 'active' : ''}" onclick="playExperimentVideo(${index})">
                                <i class="fas fa-flask" style="margin-left: 15px; color: var(--accent-blue);"></i>
                                <div style="flex: 1;">
                                    <div>${video.title}</div>
                                    <div style="color: var(--text-muted); font-size: 0.9rem;">
                                        <span><i class="fas fa-clock"></i> ${video.duration}</span>
                                        <span style="margin-right: 15px;"><i class="fas fa-tag"></i> ${video.category}</span>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            // پخش اولین ویدیو
            if (experimentVideos.length > 0) {
                playExperimentVideo(0);
            }
        }

        function getDefaultExperimentVideos() {
            return [
                {
                    id: 1,
                    title: 'الکترولیز آب',
                    description: 'تجزیه آب به هیدروژن و اکسیژن با استفاده از جریان برق',
                    category: 'الکتروشیمی',
                    duration: '8:45',
                    materials: 'آب مقطر، اسید سولفوریک رقیق، الکترودهای پلاتین، باطری، لوله آزمایش',
                    safety: 'استفاده از عینک ایمنی، هیدروژن گازی قابل اشتعال است',
                    url: 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4'
                },
                {
                    id: 2,
                    title: 'تشکیل رسوب یدید نقره',
                    description: 'واکنش نیترات نقره با یدید پتاسیم برای تشکیل رسوب زرد رنگ',
                    category: 'رسوبات',
                    duration: '5:20',
                    materials: 'نیترات نقره ۰.۱ مولار، یدید پتاسیم ۰.۱ مولار، بشر، همزن',
                    safety: 'نیترات نقره لکه‌دارکننده است، از دستکش استفاده شود',
                    url: 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4'
                },
                {
                    id: 3,
                    title: 'واکنش خنثی‌سازی اسید و باز',
                    description: 'واکنش هیدروکلریک اسید با سدیم هیدروکسید و اندازه‌گیری pH',
                    category: 'اسید و باز',
                    duration: '10:15',
                    materials: 'HCl 0.1M, NaOH 0.1M, شناساگر فنول‌فتالئین، بورت، ارلن',
                    safety: 'استفاده از عینک و دستکش، اسید و باز قوی هستند',
                    url: 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4'
                }
            ];
        }

        let currentExperimentVideoIndex = 0;
        let experimentVideos = [];

        function playExperimentVideo(index) {
            experimentVideos = JSON.parse(localStorage.getItem('experimentVideos')) || getDefaultExperimentVideos();
            
            if (index < 0 || index >= experimentVideos.length) return;
            
            currentExperimentVideoIndex = index;
            const video = experimentVideos[index];
            
            document.getElementById('experiment-video-title').textContent = video.title;
            const videoElement = document.getElementById('experiment-video');
            videoElement.querySelector('source').src = video.url;
            videoElement.load();
            videoElement.play();
            
            // به‌روزرسانی پلی‌لیست
            document.querySelectorAll('#experiment-playlist .playlist-item').forEach((item, i) => {
                item.classList.toggle('active', i === index);
            });
            
            // نمایش جزئیات آزمایش
            showExperimentDetails(video);
        }

        function showExperimentDetails(video) {
            const detailsHTML = `
                <div style="background: var(--light-blue); padding: 20px; border-radius: 10px; margin-top: 20px;">
                    <h4 style="color: var(--accent-blue); margin-bottom: 15px;">🔬 جزئیات آزمایش</h4>
                    <p style="color: var(--text-primary); margin-bottom: 10px;">${video.description}</p>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-top: 20px;">
                        <div>
                            <h5 style="color: var(--accent-green); margin-bottom: 10px;">مواد مورد نیاز:</h5>
                            <p style="color: var(--text-secondary); font-size: 0.9rem;">${video.materials}</p>
                        </div>
                        <div>
                            <h5 style="color: var(--accent-red); margin-bottom: 10px;">نکات ایمنی:</h5>
                            <p style="color: var(--text-secondary); font-size: 0.9rem;">${video.safety}</p>
                        </div>
                    </div>
                </div>
            `;
            
            // اضافه کردن جزئیات به زیر ویدیو
            const existingDetails = document.querySelector('.experiment-details');
            if (existingDetails) {
                existingDetails.innerHTML = detailsHTML;
            } else {
                const detailsDiv = document.createElement('div');
                detailsDiv.className = 'experiment-details';
                detailsDiv.innerHTML = detailsHTML;
                document.querySelector('#experiment-videos .video-player-container').appendChild(detailsDiv);
            }
        }

        function prevExperimentVideo() {
            if (currentExperimentVideoIndex > 0) {
                playExperimentVideo(currentExperimentVideoIndex - 1);
            } else {
                playExperimentVideo(experimentVideos.length - 1);
            }
        }

        function nextExperimentVideo() {
            if (currentExperimentVideoIndex < experimentVideos.length - 1) {
                playExperimentVideo(currentExperimentVideoIndex + 1);
            } else {
                playExperimentVideo(0);
            }
        }

        // فرم آپلود ویدیوی آزمایش
        document.getElementById('experiment-upload-form')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (!currentUser || currentUser.role !== 'teacher') {
                alert('فقط مدرسین می‌توانند ویدیو آپلود کنند.');
                return;
            }
            
            const title = document.getElementById('experiment-title').value;
            const description = document.getElementById('experiment-description').value;
            const category = document.getElementById('experiment-category').value;
            
            if (!title || !category) {
                alert('لطفا عنوان و دسته‌بندی را وارد کنید.');
                return;
            }
            
            const newVideo = {
                id: Date.now(),
                title: title,
                description: description,
                category: category,
                duration: '00:00',
                materials: 'توضیح داده نشده',
                safety: 'رعایت نکات ایمنی عمومی',
                url: '#',
                uploadedBy: currentUser.username,
                uploadDate: new Date().toLocaleDateString('fa-IR')
            };
            
            const videos = JSON.parse(localStorage.getItem('experimentVideos')) || getDefaultExperimentVideos();
            videos.push(newVideo);
            localStorage.setItem('experimentVideos', JSON.stringify(videos));
            
            alert(`✅ ویدیوی آزمایش "${title}" با موفقیت ثبت شد!`);
            document.getElementById('experiment-upload-form').reset();
            loadExperimentVideos();
        });

        // =================== جدول تناوبی کامل (118 عنصر) ===================
        const periodicTableElements = [
            // دوره 1
            {number: 1, symbol: "H", name: "هیدروژن", mass: 1.008, group: "nonmetal", period: 1, groupNumber: 1},
            {number: 2, symbol: "He", name: "هلیوم", mass: 4.003, group: "noble-gas", period: 1, groupNumber: 18},
            
            // دوره 2
            {number: 3, symbol: "Li", name: "لیتیم", mass: 6.941, group: "alkali-metal", period: 2, groupNumber: 1},
            {number: 4, symbol: "Be", name: "بریلیم", mass: 9.012, group: "alkaline-earth", period: 2, groupNumber: 2},
            {number: 5, symbol: "B", name: "بور", mass: 10.81, group: "metalloid", period: 2, groupNumber: 13},
            {number: 6, symbol: "C", name: "کربن", mass: 12.01, group: "nonmetal", period: 2, groupNumber: 14},
            {number: 7, symbol: "N", name: "نیتروژن", mass: 14.01, group: "nonmetal", period: 2, groupNumber: 15},
            {number: 8, symbol: "O", name: "اکسیژن", mass: 16.00, group: "nonmetal", period: 2, groupNumber: 16},
            {number: 9, symbol: "F", name: "فلوئور", mass: 19.00, group: "halogen", period: 2, groupNumber: 17},
            {number: 10, symbol: "Ne", name: "نئون", mass: 20.18, group: "noble-gas", period: 2, groupNumber: 18},
            
            // دوره 3
            {number: 11, symbol: "Na", name: "سدیم", mass: 22.99, group: "alkali-metal", period: 3, groupNumber: 1},
            {number: 12, symbol: "Mg", name: "منیزیم", mass: 24.31, group: "alkaline-earth", period: 3, groupNumber: 2},
            {number: 13, symbol: "Al", name: "آلومینیوم", mass: 26.98, group: "basic-metal", period: 3, groupNumber: 13},
            {number: 14, symbol: "Si", name: "سیلیسیم", mass: 28.09, group: "metalloid", period: 3, groupNumber: 14},
            {number: 15, symbol: "P", name: "فسفر", mass: 30.97, group: "nonmetal", period: 3, groupNumber: 15},
            {number: 16, symbol: "S", name: "گوگرد", mass: 32.07, group: "nonmetal", period: 3, groupNumber: 16},
            {number: 17, symbol: "Cl", name: "کلر", mass: 35.45, group: "halogen", period: 3, groupNumber: 17},
            {number: 18, symbol: "Ar", name: "آرگون", mass: 39.95, group: "noble-gas", period: 3, groupNumber: 18},
            
            // دوره 4
            {number: 19, symbol: "K", name: "پتاسیم", mass: 39.10, group: "alkali-metal", period: 4, groupNumber: 1},
            {number: 20, symbol: "Ca", name: "کلسیم", mass: 40.08, group: "alkaline-earth", period: 4, groupNumber: 2},
            {number: 21, symbol: "Sc", name: "اسکاندیم", mass: 44.96, group: "transition-metal", period: 4, groupNumber: 3},
            {number: 22, symbol: "Ti", name: "تیتانیم", mass: 47.87, group: "transition-metal", period: 4, groupNumber: 4},
            {number: 23, symbol: "V", name: "وانادیم", mass: 50.94, group: "transition-metal", period: 4, groupNumber: 5},
            {number: 24, symbol: "Cr", name: "کروم", mass: 52.00, group: "transition-metal", period: 4, groupNumber: 6},
            {number: 25, symbol: "Mn", name: "منگنز", mass: 54.94, group: "transition-metal", period: 4, groupNumber: 7},
            {number: 26, symbol: "Fe", name: "آهن", mass: 55.85, group: "transition-metal", period: 4, groupNumber: 8},
            {number: 27, symbol: "Co", name: "کبالت", mass: 58.93, group: "transition-metal", period: 4, groupNumber: 9},
            {number: 28, symbol: "Ni", name: "نیکل", mass: 58.69, group: "transition-metal", period: 4, groupNumber: 10},
            {number: 29, symbol: "Cu", name: "مس", mass: 63.55, group: "transition-metal", period: 4, groupNumber: 11},
            {number: 30, symbol: "Zn", name: "روی", mass: 65.38, group: "transition-metal", period: 4, groupNumber: 12},
            {number: 31, symbol: "Ga", name: "گالیم", mass: 69.72, group: "basic-metal", period: 4, groupNumber: 13},
            {number: 32, symbol: "Ge", name: "ژرمانیم", mass: 72.63, group: "metalloid", period: 4, groupNumber: 14},
            {number: 33, symbol: "As", name: "آرسنیک", mass: 74.92, group: "metalloid", period: 4, groupNumber: 15},
            {number: 34, symbol: "Se", name: "سلنیوم", mass: 78.97, group: "nonmetal", period: 4, groupNumber: 16},
            {number: 35, symbol: "Br", name: "برم", mass: 79.90, group: "halogen", period: 4, groupNumber: 17},
            {number: 36, symbol: "Kr", name: "کریپتون", mass: 83.80, group: "noble-gas", period: 4, groupNumber: 18},
            
            // ادامه عناصر مهم...
            {number: 47, symbol: "Ag", name: "نقره", mass: 107.87, group: "transition-metal", period: 5, groupNumber: 11},
            {number: 53, symbol: "I", name: "ید", mass: 126.90, group: "halogen", period: 5, groupNumber: 17},
            {number: 79, symbol: "Au", name: "طلا", mass: 197.00, group: "transition-metal", period: 6, groupNumber: 11},
            {number: 80, symbol: "Hg", name: "جیوه", mass: 200.59, group: "transition-metal", period: 6, groupNumber: 12},
            {number: 82, symbol: "Pb", name: "سرب", mass: 207.20, group: "basic-metal", period: 6, groupNumber: 14},
            {number: 92, symbol: "U", name: "اورانیم", mass: 238.03, group: "actinide", period: 7, groupNumber: 3}
        ];

        function loadPeriodicTable() {
            const container = document.getElementById('periodic-table-container');
            if (!container) return;
            
            // ایجاد ساختار جدول
            let tableHTML = '';
            
            // ردیف اول (دوره 1)
            tableHTML += createPeriodicTableRow(1, 1, 2);
            
            // ردیف دوم (دوره 2)
            tableHTML += createPeriodicTableRow(2, 3, 10);
            
            // ردیف سوم (دوره 3)
            tableHTML += createPeriodicTableRow(3, 11, 18);
            
            // ردیف چهارم (دوره 4)
            tableHTML += createPeriodicTableRow(4, 19, 36);
            
            // ردیف پنجم (دوره 5) - ساده شده
            tableHTML += `
                <div style="grid-column: 1 / -1; height: 10px;"></div>
                <div class="periodic-element lanthanide" style="grid-column: 3 / span 15; text-align: center; padding: 15px;">
                    <div style="font-weight: bold; color: white;">لانتانیدها (عناصر ۵۷-۷۱)</div>
                    <div style="font-size: 0.8rem; color: rgba(255,255,255,0.8);">La Ce Pr Nd Pm Sm Eu Gd Tb Dy Ho Er Tm Yb Lu</div>
                </div>
                <div style="grid-column: 1 / -1; height: 10px;"></div>
                <div class="periodic-element actinide" style="grid-column: 3 / span 15; text-align: center; padding: 15px;">
                    <div style="font-weight: bold; color: white;">آکتینیدها (عناصر ۸۹-۱۰۳)</div>
                    <div style="font-size: 0.8rem; color: rgba(255,255,255,0.8);">Ac Th Pa U Np Pu Am Cm Bk Cf Es Fm Md No Lr</div>
                </div>
            `;
            
            container.innerHTML = tableHTML;
            
            // اضافه کردن رویداد کلیک
            document.querySelectorAll('.periodic-element').forEach(element => {
                const number = element.getAttribute('data-number');
                if (number) {
                    const elementData = periodicTableElements.find(el => el.number == number);
                    if (elementData) {
                        element.addEventListener('click', () => showElementModal(elementData));
                    }
                }
            });
            
            // اضافه کردن اطلاعات گروه‌ها
            addGroupInformation();
        }

        function createPeriodicTableRow(period, start, end) {
            let rowHTML = '';
            
            for (let i = start; i <= end; i++) {
                const element = periodicTableElements.find(el => el.number === i);
                if (element) {
                    rowHTML += `
                        <div class="periodic-element ${element.group}" data-number="${element.number}">
                            <div style="font-weight: bold; font-size: 0.9rem; margin-bottom: 3px;">${element.symbol}</div>
                            <div style="font-size: 0.7rem;">${element.number}</div>
                            <div style="font-size: 0.6rem; margin-top: 3px;">${element.name}</div>
                        </div>
                    `;
                } else {
                    // خانه خالی
                    rowHTML += `<div></div>`;
                }
            }
            
            return rowHTML;
        }

        function addGroupInformation() {
            const infoHTML = `
                <div class="periodic-table-note">
                    <h4 style="color: var(--accent-yellow); margin-bottom: 10px;">📚 اطلاعات گروه‌های جدول تناوبی:</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                        <div>
                            <h5 style="color: var(--accent-red); margin-bottom: 5px;">گروه ۱ - فلزات قلیایی:</h5>
                            <p style="color: var(--text-secondary); font-size: 0.9rem;">
                                Li, Na, K, Rb, Cs, Fr<br>
                                خواص: بسیار واکنش‌پذیر، نرم، چگالی کم، نقره‌ای رنگ
                            </p>
                        </div>
                        <div>
                            <h5 style="color: var(--accent-orange); margin-bottom: 5px;">گروه ۲ - فلزات قلیایی خاکی:</h5>
                            <p style="color: var(--text-secondary); font-size: 0.9rem;">
                                Be, Mg, Ca, Sr, Ba, Ra<br>
                                خواص: سخت، چگالی بیشتر از گروه ۱، نقره‌ای رنگ
                            </p>
                        </div>
                        <div>
                            <h5 style="color: #42a5f5; margin-bottom: 5px;">گروه ۱۷ - هالوژن‌ها:</h5>
                            <p style="color: var(--text-secondary); font-size: 0.9rem;">
                                F, Cl, Br, I, At<br>
                                خواص: نافلز، الکترونگاتیو، تشکیل نمک با فلزات
                            </p>
                        </div>
                        <div>
                            <h5 style="color: #26c6da; margin-bottom: 5px;">گروه ۱۸ - گازهای نجیب:</h5>
                            <p style="color: var(--text-secondary); font-size: 0.9rem;">
                                He, Ne, Ar, Kr, Xe, Rn<br>
                                خواص: بی‌بو، بی‌رنگ، واکنش‌ناپذیر، آرایش الکترونی پایدار
                            </p>
                        </div>
                    </div>
                </div>
            `;
            
            const container = document.querySelector('.full-periodic-table');
            if (container) {
                const existingInfo = container.querySelector('.group-info');
                if (existingInfo) {
                    existingInfo.innerHTML = infoHTML;
                } else {
                    const infoDiv = document.createElement('div');
                    infoDiv.className = 'group-info';
                    infoDiv.innerHTML = infoHTML;
                    container.appendChild(infoDiv);
                }
            }
        }

        // =================== بانک واکنش‌های کنکوری ===================
        const allChemicalReactions = {
            'ساختار اتم': [
                {equation: "₁H¹ + ₀n¹ → ₁H²", name: "تشکیل دوتریوم", importance: "کنکور ۱۳۹۸, ۱۴۰۰"},
                {equation: "₉₂U²³⁵ + ₀n¹ → ₅₆Ba¹⁴¹ + ₃₆Kr⁹² + 3₀n¹", name: "شکافت هسته‌ای", importance: "کنکور ۱۳۹۹"}
            ],
            'پیوندهای شیمیایی': [
                {equation: "Na + Cl → Na⁺ + Cl⁻", name: "تشکیل پیوند یونی", importance: "کنکور ۱۳۹۷, ۱۳۹۹, ۱۴۰۱"},
                {equation: "H• + H• → H:H", name: "تشکیل پیوند کووالانسی", importance: "کنکور ۱۴۰۰"}
            ],
            'استوکیومتری': [
                {equation: "N₂ + 3H₂ → 2NH₃", name: "فرآیند هابر", importance: "کنکور ۱۳۹۸, ۱۴۰۰, ۱۴۰۲"},
                {equation: "2KClO₃ → 2KCl + 3O₂", name: "تجزیه کلرات پتاسیم", importance: "کنکور ۱۳۹۷, ۱۳۹۹"}
            ],
            'ترمودینامیک': [
                {equation: "C + O₂ → CO₂ ΔH = -393.5 kJ/mol", name: "احتراق کربن", importance: "کنکور ۱۴۰۰, ۱۴۰۱"},
                {equation: "H₂ + ½O₂ → H₂O ΔH = -285.8 kJ/mol", name: "تشکیل آب", importance: "کنکور ۱۳۹۹, ۱۴۰۲"}
            ],
            'سینتیک': [
                {equation: "2H₂O₂ → 2H₂O + O₂", name: "تجزیه پراکسید هیدروژن", importance: "کنکور ۱۴۰۰, ۱۴۰۱"},
                {equation: "CH₃COOC₂H₅ + OH⁻ → CH₃COO⁻ + C₂H₅OH", name: "هیدرولیز استر", importance: "کنکور ۱۳۹۹"}
            ],
            'تعادل شیمیایی': [
                {equation: "N₂ + 3H₂ ⇌ 2NH₃", name: "تشکیل آمونیاک", importance: "کنکور ۱۳۹۷, ۱۳۹۹, ۱۴۰۰, ۱۴۰۱, ۱۴۰۲"},
                {equation: "CO + H₂O ⇌ CO₂ + H₂", name: "واکنش گاز آب", importance: "کنکور ۱۴۰۰"}
            ],
            'اسید و باز': [
                {equation: "HCl + NaOH → NaCl + H₂O", name: "خنثی‌سازی", importance: "کنکور ۱۳۹۷, ۱۳۹۹, ۱۴۰۰, ۱۴۰۲"},
                {equation: "CH₃COOH + H₂O ⇌ CH₃COO⁻ + H₃O⁺", name: "یونش اسید استیک", importance: "کنکور ۱۴۰۰, ۱۴۰۱"}
            ],
            'الکتروشیمی': [
                {equation: "Zn + Cu²⁺ → Zn²⁺ + Cu", name: "پیل روی-مس", importance: "کنکور ۱۳۹۸, ۱۴۰۰, ۱۴۰۲"},
                {equation: "2H₂O → 2H₂ + O₂", name: "الکترولیز آب", importance: "کنکور ۱۳۹۹, ۱۴۰۱"}
            ],
            'شیمی آلی': [
                {equation: "CH₄ + 2O₂ → CO₂ + 2H₂O", name: "احتراق متان", importance: "کنکور ۱۳۹۷, ۱۳۹۹, ۱۴۰۰"},
                {equation: "C₂H₄ + H₂ → C₂H₆", name: "هیدروژن‌دار کردن اتیلن", importance: "کنکور ۱۴۰۰"},
                {equation: "C₆H₁₂O₆ → 2C₂H₅OH + 2CO₂", name: "تخمیر گلوکز", importance: "کنکور ۱۴۰۱"}
            ]
        };

        function loadReactions() {
            const container = document.getElementById('reactions-container');
            const filtersContainer = document.getElementById('reaction-filters');
            
            if (!container || !filtersContainer) return;
            
            // ایجاد فیلترها
            filtersContainer.innerHTML = `
                <button class="chapter-btn active" onclick="filterAllReactions('همه')">همه واکنش‌ها</button>
                ${Object.keys(allChemicalReactions).map(chapter => `
                    <button class="chapter-btn" onclick="filterAllReactions('${chapter}')">${chapter}</button>
                `).join('')}
            `;
            
            // بارگذاری همه واکنش‌ها
            filterAllReactions('همه');
        }

        function filterAllReactions(chapter) {
            const container = document.getElementById('reactions-container');
            const buttons = document.querySelectorAll('#reaction-filters .chapter-btn');
            
            // به‌روزرسانی کلاس active
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            container.innerHTML = '';
            
            if (chapter === 'همه') {
                // نمایش همه واکنش‌ها
                Object.entries(allChemicalReactions).forEach(([chapterName, reactions]) => {
                    reactions.forEach(reaction => {
                        addReactionCard(reaction, chapterName);
                    });
                });
            } else {
                // نمایش واکنش‌های یک فصل خاص
                allChemicalReactions[chapter]?.forEach(reaction => {
                    addReactionCard(reaction, chapter);
                });
            }
        }

        function addReactionCard(reaction, chapter) {
            const container = document.getElementById('reactions-container');
            
            const reactionCard = document.createElement('div');
            reactionCard.className = 'reaction-card';
            
            reactionCard.innerHTML = `
                <div class="reaction-header">
                    <h3 style="color: var(--accent-blue);">${reaction.name}</h3>
                    <span class="reaction-category" style="background: var(--accent-purple); color: white;">
                        ${chapter}
                    </span>
                </div>
                <div class="reaction-equation">${reaction.equation}</div>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 20px;">
                    <span style="color: var(--accent-green); font-size: 0.9rem;">
                        <i class="fas fa-graduation-cap"></i> ${reaction.importance}
                    </span>
                    <button class="btn quick-action-btn" onclick="saveReaction('${reaction.equation}')" 
                            style="background: var(--accent-blue); padding: 8px 15px; font-size: 0.8rem;">
                        <i class="fas fa-save"></i> ذخیره
                    </button>
                </div>
            `;
            
            container.appendChild(reactionCard);
        }

        function saveReaction(equation) {
            if (!currentUser) {
                alert('لطفاً ابتدا وارد حساب کاربری خود شوید.');
                showPage('auth');
                return;
            }
            
            const savedReactions = JSON.parse(localStorage.getItem('savedReactions')) || [];
            if (!savedReactions.includes(equation)) {
                savedReactions.push(equation);
                localStorage.setItem('savedReactions', JSON.stringify(savedReactions));
                alert('✅ واکنش با موفقیت ذخیره شد!');
            } else {
                alert('این واکنش قبلاً ذخیره شده است.');
            }
        }

        // =================== سیستم رفع اشکال به‌روزرسانی شده ===================
        function loadHelpSection() {
            const form = document.getElementById('question-form');
            if (!form) return;
            
            form.innerHTML = `
                <div class="form-group">
                    <label for="name">نام و نام خانوادگی:</label>
                    <input type="text" id="name" class="form-control" placeholder="نام خود را وارد کنید" required value="${currentUser ? currentUser.username : ''}">
                </div>
                
                <div class="form-group">
                    <label for="phone">شماره تماس:</label>
                    <input type="tel" id="phone" class="form-control" placeholder="۰۹۱۲XXXXXXX" required value="${currentUser ? currentUser.phone : ''}">
                </div>
                
                <div class="form-group">
                    <label for="subject">موضوع سوال:</label>
                    <select id="subject" class="form-control" required>
                        <option value="">موضوع را انتخاب کنید</option>
                        <option value="ساختار اتم">ساختار اتم</option>
                        <option value="جدول تناوبی">جدول تناوبی</option>
                        <option value="پیوندهای شیمیایی">پیوندهای شیمیایی</option>
                        <option value="استوکیومتری">استوکیومتری</option>
                        <option value="ترمودینامیک">ترمودینامیک</option>
                        <option value="سینتیک">سینتیک</option>
                        <option value="تعادل شیمیایی">تعادل شیمیایی</option>
                        <option value="اسید و باز">اسید و باز</option>
                        <option value="الکتروشیمی">الکتروشیمی</option>
                        <option value="شیمی آلی">شیمی آلی</option>
                        <option value="سایر">سایر</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="question">سوال خود را بنویسید:</label>
                    <textarea id="question" class="form-control" placeholder="سوال شیمی خود را به طور کامل شرح دهید..." required></textarea>
                </div>
                
                <button type="submit" class="submit-btn">
                    <i class="fas fa-paper-plane"></i> ارسال سوال
                </button>
            `;
            
            // اضافه کردن دکمه مشاهده سوالات برای مدرس
            if (currentUser && currentUser.role === 'teacher') {
                const helpSection = document.querySelector('.help-section');
                const existingBtn = helpSection.querySelector('.view-questions-btn');
                if (!existingBtn) {
                    const viewQuestionsBtn = document.createElement('button');
                    viewQuestionsBtn.className = 'btn view-questions-btn';
                    viewQuestionsBtn.style.cssText = 'margin-top: 20px; width: 100%; background-color: var(--accent-orange);';
                    viewQuestionsBtn.innerHTML = '<i class="fas fa-question-circle"></i> مشاهده سوالات دانش‌آموزان';
                    viewQuestionsBtn.onclick = showQuestionsPanel;
                    helpSection.appendChild(viewQuestionsBtn);
                }
            }
        }

        document.getElementById('question-form')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (!currentUser) {
                alert('لطفاً ابتدا وارد حساب کاربری خود شوید.');
                showPage('auth');
                return;
            }
            
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const subject = document.getElementById('subject').value;
            const question = document.getElementById('question').value;
            
            if (!name || !phone || !subject || !question) {
                alert('لطفا تمام فیلدها را پر کنید.');
                return;
            }
            
            const newQuestion = {
                id: Date.now(),
                name: name,
                phone: phone,
                subject: subject,
                question: question,
                date: new Date().toLocaleString('fa-IR'),
                status: 'جدید',
                answer: '',
                answerDate: '',
                answeredBy: ''
            };
            
            studentQuestions.push(newQuestion);
            localStorage.setItem('chemistryQuestions', JSON.stringify(studentQuestions));
            
            // نمایش پیام موفقیت
            alert(`✅ سوال شما با موفقیت ثبت شد!\n\n📋 کد پیگیری: ${newQuestion.id}\n\nپاسخ شما حداکثر طی ۲۴ ساعت ارسال خواهد شد.\n\nپس از پاسخگویی، از طریق واتساپ و پیامک مطلع خواهید شد.`);
            
            document.getElementById('question-form').reset();
            
            // ارسال پیامک خودکار (شبیه‌سازی)
            simulateAutoSMS(phone, name, newQuestion.id);
        });

        function simulateAutoSMS(phone, name, questionId) {
            // در واقعیت اینجا باید به API پیامک متصل شود
            console.log(`📱 پیامک خودکار برای ${name} (${phone}):`);
            console.log(`سلام ${name} عزیز، سوال شما با کد ${questionId} ثبت شد. پاسخ حداکثر طی ۲۴ ساعت ارسال می‌شود.`);
            
            // نمایش شبیه‌سازی در کنسول
            setTimeout(() => {
                console.log(`📲 پیامک اطلاع‌رسانی ارسال شد.`);
            }, 1000);
        }

        // =================== توابع باقی‌مانده ===================
        function loadMolarMassElements() {
            const container = document.getElementById('all-elements-grid');
            if (!container) return;
            
            container.innerHTML = periodicTableElements.map(element => `
                <div class="element-item" onclick="showElementModal(${JSON.stringify(element).replace(/"/g, '&quot;')})">
                    <div class="element-symbol">${element.symbol}</div>
                    <div style="font-size: 0.9rem; color: var(--text-secondary);">
                        <strong>${element.name}</strong><br>
                        عدد اتمی: ${element.number}<br>
                        جرم مولی: ${element.mass} g/mol<br>
                        گروه: ${getGroupName(element.group)}
                    </div>
                </div>
            `).join('');
        }

        function showElementModal(element) {
            const modalContent = document.getElementById('modal-content');
            modalContent.innerHTML = `
                <div style="display: flex; align-items: center; margin-bottom: 25px; padding-bottom: 15px; border-bottom: 2px solid var(--accent-blue);">
                    <div class="periodic-element ${element.group}" style="width: 80px; height: 80px; font-size: 2rem; margin-left: 20px; display: flex; align-items: center; justify-content: center;">
                        ${element.symbol}
                    </div>
                    <div>
                        <h2 style="color: var(--accent-blue); margin-bottom: 5px;">${element.name} (${element.symbol})</h2>
                        <p style="color: var(--text-secondary);">عدد اتمی: ${element.number} | جرم اتمی: ${element.mass}</p>
                        <p style="color: var(--text-secondary);">گروه: ${getGroupName(element.group)} | دوره: ${element.period}</p>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
                    <div style="background-color: var(--light-blue); padding: 20px; border-radius: 10px;">
                        <h4 style="color: var(--accent-blue); margin-bottom: 15px; font-size: 1.2rem;">اطلاعات کلی</h4>
                        <p><strong>عدد اتمی:</strong> ${element.number}</p>
                        <p><strong>جرم اتمی:</strong> ${element.mass} g/mol</p>
                        <p><strong>نماد:</strong> ${element.symbol}</p>
                        <p><strong>نام:</strong> ${element.name}</p>
                    </div>
                    
                    <div style="background-color: var(--light-blue); padding: 20px; border-radius: 10px;">
                        <h4 style="color: var(--accent-blue); margin-bottom: 15px; font-size: 1.2rem;">موقعیت در جدول</h4>
                        <p><strong>گروه:</strong> ${element.groupNumber || '--'}</p>
                        <p><strong>دوره:</strong> ${element.period}</p>
                        <p><strong>نوع عنصر:</strong> ${getGroupName(element.group)}</p>
                        <p><strong>بلوک:</strong> ${getElementBlock(element)}</p>
                    </div>
                </div>
                
                <div style="background-color: rgba(100, 255, 218, 0.1); padding: 20px; border-radius: 10px; border-right: 3px solid var(--accent-blue);">
                    <h4 style="color: var(--accent-blue); margin-bottom: 10px;">نکات کنکوری ${element.name}:</h4>
                    <p style="color: var(--text-secondary);">${getElementTips(element)}</p>
                </div>
            `;
            
            document.getElementById('element-modal').style.display = 'flex';
        }

        function getElementBlock(element) {
            if (element.groupNumber <= 2) return 's';
            if (element.groupNumber <= 12) return 'd';
            if (element.groupNumber <= 18) return 'p';
            if (element.group === 'lanthanide' || element.group === 'actinide') return 'f';
            return '--';
        }

        function getElementTips(element) {
            const tips = {
                "H": "• سبک‌ترین عنصر • فراوان‌ترین عنصر جهان • نافلز • در ترکیب آب",
                "He": "• سبک‌ترین گاز نجیب • نقطه جوش بسیار پایین • در بالون‌ها",
                "Li": "• سبک‌ترین فلز • در باتری‌های لیتیومی • واکنش‌پذیر با آب",
                "C": "• چهارظرفیتی • پایه شیمی آلی • آلوتروپ‌های الماس و گرافیت",
                "O": "• فراوان‌ترین عنصر پوسته زمین • برای تنفس ضروری • اکسیدکننده",
                "Na": "• در نمک طعام • نور زرد در تست شعله • واکنش شدید با آب",
                "Cl": "• گاز زرد مایل به سبز • در ضدعفونی آب • تشکیل نمک",
                "Fe": "• چهارمین عنصر فراوان • در هموگلوبین • مغناطیسی",
                "Cu": "• رسانای عالی برق • رنگ قرمز متمایز • در سیم‌های برق",
                "Au": "• فلز نجیب • در جواهرات • رسانای عالی • ضدزنگ"
            };
            
            return tips[element.symbol] || 
                `• عنصر ${getGroupName(element.group)} • عدد اتمی: ${element.number} • جرم مولی: ${element.mass} g/mol`;
        }

        function getGroupName(groupClass) {
            const groups = {
                'alkali-metal': 'فلز قلیایی',
                'alkaline-earth': 'فلز قلیایی خاکی',
                'transition-metal': 'فلز واسطه',
                'basic-metal': 'فلز اصلی',
                'metalloid': 'شبه فلز',
                'nonmetal': 'نافلز',
                'halogen': 'هالوژن',
                'noble-gas': 'گاز نجیب',
                'lanthanide': 'لانتانید',
                'actinide': 'آکتینید'
            };
            return groups[groupClass] || groupClass;
        }

        // =================== توابع باقی‌مانده برای صفحات موجود ===================
        function loadHandouts() {
            const handouts = [
                {title: "جزوه ساختار اتم", description: "کامل‌ترین جزوه ساختار اتم و مدل‌های اتمی", chapter: "ساختار اتم", pages: 45},
                {title: "جزوه جدول تناوبی", description: "جدول تناوبی کامل با نکات کنکوری", chapter: "جدول تناوبی", pages: 60},
                {title: "جزوه استوکیومتری", description: "حل مسائل استوکیومتری با روش‌های سریع", chapter: "استوکیومتری", pages: 55},
                {title: "جزوه ترمودینامیک", description: "قوانین ترمودینامیک و مسائل آن", chapter: "ترمودینامیک", pages: 50},
                {title: "جزوه شیمی آلی", description: "ترکیبات آلی و واکنش‌های آن‌ها", chapter: "شیمی آلی", pages: 70}
            ];
            
            const container = document.getElementById('handouts-container');
            if (container) {
                container.innerHTML = handouts.map(handout => `
                    <div class="handout-card">
                        <div class="handout-header">
                            <i class="fas fa-book-open"></i>
                        </div>
                        <div class="card-content">
                            <h3>${handout.title}</h3>
                            <p>${handout.description}</p>
                            <div class="handout-meta">
                                <span><i class="fas fa-tag"></i> ${handout.chapter}</span>
                                <span><i class="fas fa-file"></i> ${handout.pages} صفحه</span>
                            </div>
                            <button class="btn" style="margin-top: 15px;">
                                <i class="fas fa-download"></i> دانلود جزوه
                            </button>
                        </div>
                    </div>
                `).join('');
            }
        }

        function loadQuestions() {
            const questions = [
                {title: "سوالات کنکور ۱۴۰۲", count: 35, time: 45, difficulty: "سخت"},
                {title: "سوالات کنکور ۱۴۰۱", count: 35, time: 45, difficulty: "متوسط"},
                {title: "سوالات کنکور ۱۴۰۰", count: 35, time: 45, difficulty: "متوسط"},
                {title: "سوالات کنکور ۱۳۹۹", count: 35, time: 45, difficulty: "آسان"},
                {title: "سوالات آزمون‌های آزمایشی", count: 50, time: 60, difficulty: "سخت"}
            ];
            
            const container = document.getElementById('questions-container');
            if (container) {
                container.innerHTML = questions.map(q => `
                    <div class="question-card">
                        <div class="question-header">
                            <h3>${q.title}</h3>
                            <span style="background: var(--accent-blue); color: white; padding: 5px 10px; border-radius: 15px; font-size: 0.8rem;">
                                ${q.difficulty}
                            </span>
                        </div>
                        <p style="color: var(--text-secondary); margin-bottom: 20px;">
                            مجموعه‌ای کامل از سوالات شیمی
                        </p>
                        <div style="display: flex; justify-content: space-between; color: var(--text-muted); font-size: 0.9rem; margin-bottom: 20px;">
                            <span><i class="fas fa-question-circle"></i> ${q.count} سوال</span>
                            <span><i class="fas fa-clock"></i> ${q.time} دقیقه</span>
                        </div>
                        <button class="btn" style="width: 100%;">
                            <i class="fas fa-play-circle"></i> شروع آزمون
                        </button>
                    </div>
                `).join('');
            }
        }

        function loadGallery() {
            const galleryItems = [
                {title: "کلاس حضوری تهران", description: "اردیبهشت ۱۴۰۲ - آموزشگاه فرهیختگان", icon: "fas fa-chalkboard-teacher", color: "var(--accent-blue)"},
                {title: "کارگاه حل تمرین", description: "شهریور ۱۴۰۲ - دانش‌آموزان رتبه برتر", icon: "fas fa-users", color: "var(--accent-green)"},
                {title: "جشن فارغ‌التحصیلی", description: "تیر ۱۴۰۲ - دوره آنلاین تابستانه", icon: "fas fa-graduation-cap", color: "var(--accent-yellow)"},
                {title: "آزمون آزمایشی", description: "دی ۱۴۰۲ - آزمون جامع نیمسال اول", icon: "fas fa-clipboard-check", color: "var(--accent-purple)"},
                {title: "کارگاه عملی شیمی", description: "آبان ۱۴۰۲ - آزمایشگاه شیمی", icon: "fas fa-vial", color: "var(--accent-red)"},
                {title: "جلسه مشاوره", description: "اسفند ۱۴۰۲ - برنامه‌ریزی کنکور", icon: "fas fa-comments", color: "var(--accent-orange)"}
            ];
            
            const container = document.getElementById('gallery-container');
            if (container) {
                container.innerHTML = galleryItems.map(item => `
                    <div class="gallery-item">
                        <div class="gallery-image" style="color: ${item.color};">
                            <i class="${item.icon}"></i>
                        </div>
                        <div class="gallery-caption" style="padding: 20px; text-align: center;">
                            <h3>${item.title}</h3>
                            <p style="color: var(--text-secondary);">${item.description}</p>
                        </div>
                    </div>
                `).join('');
            }
        }

        function loadVideoAnalysis() {
            // پخش خودکار ویدیوی تحلیل
            const analysisVideo = document.getElementById('analysis-video');
            if (analysisVideo) {
                analysisVideo.load();
            }
        }

        // =================== راه‌اندازی نهایی ===================
        // اضافه کردن استایل‌های انیمیشن
        const animationStyles = document.createElement('style');
        animationStyles.textContent = `
            @keyframes fadeIn {
                from { opacity: 0; transform: translateY(20px); }
                to { opacity: 1; transform: translateY(0); }
            }
            
            @keyframes pulse {
                0% { transform: scale(1); }
                50% { transform: scale(1.05); }
                100% { transform: scale(1); }
            }
            
            .page {
                animation: fadeIn 0.5s ease;
            }
            
            .card:hover {
                animation: pulse 0.5s ease;
            }
            
            .element-btn:hover {
                animation: pulse 0.3s ease;
            }
        `;
        document.head.appendChild(animationStyles);

        // تنظیم رویدادهای کلیک برای منوی موبایل
        document.querySelectorAll('.nav-links a').forEach(link => {
            link.addEventListener('click', () => {
                navLinks.classList.remove('active');
                mobileMenuBtn.innerHTML = '<i class="fas fa-bars"></i>';
            });
        });

        // بستن منوی موبایل با کلیک خارج
        document.addEventListener('click', (e) => {
            if (!navLinks.contains(e.target) && !mobileMenuBtn.contains(e.target)) {
                navLinks.classList.remove('active');
                mobileMenuBtn.innerHTML = '<i class="fas fa-bars"></i>';
            }
        });

        // راه‌اندازی اولیه سیستم
        window.onload = function() {
            // بارگذاری داده‌ها
            if (!localStorage.getItem('chemistryUsers')) {
                // ایجاد کاربر نمونه برای تست
                const sampleUser = {
                    id: 1,
                    username: 'test',
                    phone: '09123456789',
                    password: 'test1234',
                    grade: '12',
                    role: 'student',
                    joinDate: '1402/01/01',
                    lastLogin: '1402/12/15',
                    progress: {
                        watchedVideos: [1, 2],
                        completedQuizzes: [1],
                        score: 150,
                        correctAnswers: 8,
                        totalQuestions: 10,
                        smartQuizLevels: [1, 2]
                    }
                };
                localStorage.setItem('chemistryUsers', JSON.stringify([sampleUser]));
            }
            
            // بارگذاری همه داده‌های پیش‌فرض
            const defaultData = {
                'electrochemicalReactions': getDefaultElectrochemicalReactions(),
                'precipitations': getDefaultPrecipitations(),
                'lewisStructures': getDefaultLewisStructures(),
                'smartQuizLevels': getDefaultQuizLevels(),
                'experimentVideos': getDefaultExperimentVideos()
            };
            
            Object.entries(defaultData).forEach(([key, data]) => {
                if (!localStorage.getItem(key)) {
                    localStorage.setItem(key, JSON.stringify(data));
                }
            });
            
            updateNavForUser();
            initializeQuestionManagement();
            updateDashboard();
            
            // نمایش صفحه اصلی
            showPage('home');
            
            // نمایش پیام خوش‌آمدگویی
            if (currentUser) {
                setTimeout(() => {
                    showWelcomeMessage(currentUser.username);
                }, 1000);
            }
            
            console.log('✅ سیستم آموزشی شیمی با موفقیت راه‌اندازی شد!');
            console.log('📊 صفحات موجود:');
            console.log('1. خانه - معرفی کامل سایت');
            console.log('2. پنل کاربری - آمار و دسترسی سریع');
            console.log('3. الکتروشیمی - انتخاب عناصر و مشاهده واکنش');
            console.log('4. رسوبات - لیست کامل رسوبات شیمیایی');
            console.log('5. ساختار لوویس - ترکیبات یونی و مولکولی');
            console.log('6. نامگذاری - قواعد نامگذاری ترکیبات');
            console.log('7. ترکیب‌ساز - تشکیل ترکیب از دو عنصر');
            console.log('8. موازنه - موازنه واکنش‌های شیمیایی');
            console.log('9. استوکیومتری - حل مسائل استوکیومتری');
            console.log('10. آزمون هوشمند - آزمون سطح‌بندی شده');
            console.log('11. آزمایش‌ها - ویدیوهای آزمایش‌های مهم');
            console.log('12. جدول تناوبی - 118 عنصر کامل');
            console.log('13. واکنش‌ها - بانک واکنش‌های کنکوری');
            console.log('14. رفع اشکال - سیستم پاسخگویی پیشرفته');
        };

        // توابع عمومی
        function updateNavForUser() {
            const nav = document.querySelector('.nav-links');
            if (!nav) return;
            
            let navHTML = `
                <li><a href="#" onclick="showPage('home')">خانه</a></li>
                <li><a href="#" onclick="showPage('auth')">ثبت نام / ورود</a></li>
                <li><a href="#" onclick="showPage('dashboard')">پنل کاربری</a></li>
                <li><a href="#" onclick="showPage('elements')">جدول تناوبی</a></li>
                <li><a href="#" onclick="showPage('molar-mass')">جرم مولی</a></li>
                <li><a href="#" onclick="showPage('reactions')">واکنش‌ها</a></li>
                <li><a href="#" onclick="showPage('electrochemistry')">الکتروشیمی</a></li>
                <li><a href="#" onclick="showPage('precipitations')">رسوبات</a></li>
                <li><a href="#" onclick="showPage('lewis-structures')">ساختار لوویس</a></li>
                <li><a href="#" onclick="showPage('naming-compounds')">نامگذاری</a></li>
                <li><a href="#" onclick="showPage('compound-builder')">ترکیب‌ساز</a></li>
                <li><a href="#" onclick="showPage('balance-equation')">موازنه</a></li>
                <li><a href="#" onclick="showPage('stoichiometry-solver')">استوکیومتری</a></li>
                <li><a href="#" onclick="showPage('smart-quiz')">آزمون هوشمند</a></li>
                <li><a href="#" onclick="showPage('handouts')">جزوات</a></li>
                <li><a href="#" onclick="showPage('questions')">نمونه سوالات</a></li>
                <li><a href="#" onclick="showPage('videos')">ویدیوها</a></li>
                <li><a href="#" onclick="showPage('experiment-videos')">آزمایش‌ها</a></li>
                <li><a href="#" onclick="showPage('gallery')">عکس کلاس‌ها</a></li>
                <li><a href="#" onclick="showPage('help')">رفع اشکال</a></li>
                <li><a href="#" onclick="showPage('video-analysis')">تحلیل آزمون</a></li>
            `;
            
            if (currentUser) {
                navHTML += `
                    ${currentUser.role === 'teacher' ? '<li><a href="#" onclick="showUploadSection()"><i class="fas fa-upload"></i> آپلود</a></li>' : ''}
                    <li><a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> خروج</a></li>
                `;
            }
            
            nav.innerHTML = navHTML;
        }

        // اطمینان از تعریف همه توابع ضروری
        if (typeof showPage !== 'function') {
            window.showPage = showPage;
        }
        if (typeof showAuthForm !== 'function') {
            window.showAuthForm = showAuthForm;
        }
        if (typeof logout !== 'function') {
            window.logout = logout;
        }
        if (typeof closeModal !== 'function') {
            window.closeModal = closeModal;
        }
    </script>
</body>
        </html>
